(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{"3GUV":function(e,t,a){"use strict";var n=a("ERkP"),r=a("rHpw"),s=a("MWbm");class i extends n.Component{shouldComponentUpdate(){return!1}render(){return n.createElement(s.a,{style:o.root})}}const o=r.a.create((e=>({root:{height:5*e.lineHeightsPx.body}})));t.a=i},"5UID":function(e,t,a){"use strict";var n=a("ERkP"),r=a("3XMw"),s=a.n(r),i=a("rHpw"),o=a("+/1j"),l=a("MWbm");const c=s.a.e5b0063d;let d=0;class h extends n.Component{constructor(){super(),this._listDomId=`accessible-list-${d}`,d+=1}render(){const{children:e,title:t}=this.props,a=c({title:t});return n.createElement(l.a,{accessibilityRole:"region","aria-labelledby":this._listDomId},n.createElement(o.a,{accessibilityRole:"heading","aria-level":1,nativeID:this._listDomId,style:i.a.visuallyHidden},t),n.createElement(l.a,{accessibilityLabel:a},e))}}t.a=h},Avzu:function(e,t,a){"use strict";var n=a("ERkP"),r=a("Lsrn"),s=a("k/Ka");const i=(e={})=>Object(s.a)("svg",{...e,style:[r.a.root,e.style],viewBox:"0 0 24 24"},n.createElement("g",null,n.createElement("path",{d:"M23.25 3.25h-2.425V.825c0-.414-.336-.75-.75-.75s-.75.336-.75.75V3.25H16.9c-.414 0-.75.336-.75.75s.336.75.75.75h2.425v2.425c0 .414.336.75.75.75s.75-.336.75-.75V4.75h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-3.175 6.876c-.414 0-.75.336-.75.75v8.078c0 .414-.337.75-.75.75H4.095c-.412 0-.75-.336-.75-.75V8.298l6.778 4.518c.368.246.79.37 1.213.37.422 0 .844-.124 1.212-.37l4.53-3.013c.336-.223.428-.676.204-1.012-.223-.332-.675-.425-1.012-.2l-4.53 3.014c-.246.162-.563.163-.808 0l-7.586-5.06V5.5c0-.414.337-.75.75-.75h9.094c.414 0 .75-.336.75-.75s-.336-.75-.75-.75H4.096c-1.24 0-2.25 1.01-2.25 2.25v13.455c0 1.24 1.01 2.25 2.25 2.25h14.48c1.24 0 2.25-1.01 2.25-2.25v-8.078c0-.415-.337-.75-.75-.75z"})));i.metadata={width:24,height:24},t.a=i},BUB3:function(e,t,a){"use strict";var n=a("ERkP"),r=a("sNn6"),s=a("rHpw"),i=a("MWbm");const o=s.a.create((e=>({activeRoot:{backgroundColor:e.colors.gray0},overlay:{...s.a.absoluteFillObject,borderRightStyle:"solid",borderRightWidth:e.borderWidths.medium,borderRightColor:e.colors.primary,zIndex:1}})));t.a=({children:e,...t})=>n.createElement(r.a,t,(t=>n.createElement(i.a,{style:[t&&o.activeRoot]},"function"==typeof e?e(t):e,t?n.createElement(i.a,{pointerEvents:"none",style:o.overlay}):null)))},TEoO:function(e,t,a){"use strict";var n=a("ERkP"),r=a("5UID"),s=a("3GUV"),i=a("iBK2");const o=n.createElement(s.a,null),l=({accessibilityTitle:e,...t})=>{const a=n.createElement(i.b,t);return e?n.createElement(r.a,{title:e},a):a};l.defaultProps={footer:o},t.a=l},fuhe:function(e,t,a){"use strict";a.r(t),a.d(t,"DMDrawer",(function(){return Qe}));var n=a("97Jx"),r=a.n(n),s=a("KEM+"),i=a.n(s),o=(a("kYxP"),a("ERkP")),l=a("ZUOq"),c=a("MMRb"),d=a("rxPX"),h=a("0KEI"),m=a("RqPI");var u=Object(d.a)().propsFromState((()=>({conversations:c.selectConversations,drawerExperimentEnabled:c.selectDrawerExperimentEnabled,perspective:m.h,poppedOutConversationId:c.selectPoppedOutConversationId,visibility:c.selectDrawerVisibility}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(h.d)("DIRECT_MESSAGES_CONVERSATION"),fetchInboxIfNeeded:c.fetchInboxIfNeeded,loadDrawerExperimentFromPersistence:c.loadDrawerExperimentFromPersistence,loadDrawerVisibilityFromPersistence:c.loadDrawerVisibilityFromPersistence,setDrawerVisibility:c.setDrawerVisibility}))),p=a("V/6K"),b=a("VnFT"),g=a("1YZw"),E=a("hqKg"),_=a("Myq3"),v=a("AQOc"),y=a("UhuB"),f=a("l0YN"),I=a("G6rE"),C=a("P1r1");const x=(e,t)=>t.conversationId,w=Object(E.createSelector)(((e,t)=>c.selectEntriesForConversation(e,x(0,t))),m.h,((e,t)=>t?((e,t)=>{const a=Object(_.a)(e,(e=>!!e.message_data&&e.message_data&&e.message_data.recipient_id===t));return a&&a.message_data&&a.message_data.quick_reply&&a.message_data.quick_reply&&"options"===a.message_data.quick_reply.type?a.message_data.quick_reply:void 0})(e,t):void 0)),M=e=>t=>b.c(e,t),D=e=>(t,a)=>b.a(e,t,a),S={conversation:(e,t)=>c.selectConversation(e,x(0,t)),entries:c.selectEntries,perspective:m.h,users:I.e.selectAll,dataSaverMode:C.j,dtabBarInfo:C.m,quickReplyOptions:w,visibility:c.selectDrawerVisibility,inboxUnreadCount:f.a,isUnread:(e,t)=>!c.selectConversationIsRead(e,x(0,t)),isDmReceiptSettingEnabled:y.l},O={draftText:(e,t)=>b.m(e,x(0,t)),gifMetadata:(e,t)=>b.h(e,x(0,t)),isUploading:(e,t)=>b.j(e,x(0,t)),media:(e,t)=>b.i(e,x(0,t)),mediaMetadata:(e,t)=>b.k(e,x(0,t)),mediaUploadProgress:(e,t)=>b.l(e,x(0,t))};var T=Object(d.a)().propsFromState((()=>({...S,...O}))).adjustStateProps((({conversation:e,entries:t,perspective:a,users:n,dataSaverMode:r,draftText:s,dtabBarInfo:i,gifMetadata:o,inboxUnreadCount:l,isDmReceiptSettingEnabled:c,isUploading:d,isUnread:h,media:m,mediaMetadata:u,mediaUploadProgress:p,quickReplyOptions:b,visibility:g})=>{const E=null==e?void 0:e.data;return{conversation:E&&Object(v.a)(E,t,n),perspective:a,dataSaverMode:r,draftText:s,dtabBarInfo:i,gifMetadata:o,inboxUnreadCount:l,isDmReceiptSettingEnabled:c,isUploading:d,isUnread:h,media:m,mediaMetadata:u,mediaUploadProgress:p,quickReplyOptions:b,visibility:g}})).propsFromActions((({conversationId:e})=>({addMedia:D(e),addToast:g.b,createLocalApiErrorHandler:Object(h.d)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:c.fetchConversationHistory,removeMedia:M(e),saveText:b.f,sendMessage:b.n,updateConversationReadState:c.updateConversationReadState,updateTyping:c.updateTyping,fetchUpdatesIfNeeded:c.fetchUpdatesIfNeeded}))).withAnalytics({page:"messages",section:"thread_drawer"}),H=a("aWyx"),k=a("qz2E"),N=(a("uB9N"),a("Oi4X")),R=a("OhSZ"),U=a("v6aA"),P=Object(d.a)().propsFromState((()=>({visibility:c.selectDrawerVisibility}))).propsFromActions((()=>({popOutConversation:c.popOutConversation,setDrawerVisibility:c.setDrawerVisibility}))).withAnalytics(),L=a("xPna"),A=a("3XMw"),F=a.n(A),j=a("OrGc"),B=a("hACr"),V=a("MWbm"),$=a("/yvb"),W=a("Znyr"),G=a("t62R"),q=a("xKuM"),z=a("rHpw"),K=a("95Se"),X=a("Avzu"),Q=a("Lsrn"),Y=a("k/Ka");const Z=(e={})=>Object(Y.a)("svg",{...e,style:[Q.a.root,e.style],viewBox:"0 0 24 24"},o.createElement("g",null,o.createElement("path",{d:"M12 19.344l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 19.344z"}),o.createElement("path",{d:"M12 11.535l-8.72-8.72c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l9.25 9.25c.292.294.767.294 1.06 0l9.25-9.25c.146-.145.22-.337.22-.53s-.073-.383-.22-.53c-.293-.292-.768-.292-1.06 0L12 11.535z"})));Z.metadata={width:24,height:24};var J=Z;const ee=(e={})=>Object(Y.a)("svg",{...e,style:[Q.a.root,e.style],viewBox:"0 0 24 24"},o.createElement("g",null,o.createElement("path",{d:"M12 4.656l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0L12 4.656z"}),o.createElement("path",{d:"M12 12.465l8.72 8.72c.293.293.768.293 1.06 0s.294-.768 0-1.06l-9.25-9.25c-.292-.294-.767-.294-1.06 0l-9.25 9.25c-.146.145-.22.337-.22.53s.073.383.22.53c.293.292.768.292 1.06 0l8.72-8.72z"})));ee.metadata={width:24,height:24};var te=ee,ae=a("hOZg"),ne=a("x0mb");const re=F.a.a2f8105f,se=F.a.e839db39,ie=F.a.d227d19e,oe=F.a.c64c1883,le=F.a.j7d0e835,ce=F.a.b08821f3,de=F.a.e736990a,he=F.a.cdcebd22;class me extends o.Component{constructor(...e){super(...e),i()(this,"_headerBar",o.createRef()),i()(this,"_showDMQuickAccessWithClose",this.context.featureSwitches.isTrue("responsive_web_dm_quick_access_with_close_enabled")),i()(this,"_navVisualRefreshEnabled",this.context.featureSwitches.isTrue("responsive_web_nav_visual_refresh_enabled")),i()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===L.a.EXPANDED})),i()(this,"_renderLeftControl",(()=>{const{inboxUnreadCount:e}=this.props;return o.createElement(V.a,null,o.createElement($.a,{accessibilityLabel:ce,icon:o.createElement(K.a,null),onPress:this._handleUnpopConvo,type:this._getButtonType()}),e&&e>0?o.createElement(W.a,{pip:!0,style:ue.newMessagePip,truncatedCountFormatter:()=>"",unreadCountLabel:()=>""}):null)})),i()(this,"_getButtonType",(()=>{let e;const{isHighlighted:t,hasNewMessages:a}=this.props;return e=this._navVisualRefreshEnabled?t&&a?"invertedText":"experimentalText":t&&a?"invertedText":"text",e})),i()(this,"_renderRightControl",(()=>{const{conversationTitle:e}=this.props,t=this._isExpanded(),a=this._getButtonType();return o.createElement(V.a,{style:ue.rightControls},e?null:o.createElement($.a,{accessibilityLabel:oe,hoverLabel:{label:he},icon:o.createElement(X.a,null),onPress:this._handleNewMessage,type:a}),t?o.createElement($.a,{accessibilityLabel:ie,hoverLabel:{label:ie},icon:o.createElement(J,null),onPress:this._handleToggleVisibility,type:a}):o.createElement($.a,{accessibilityLabel:le,hoverLabel:{label:le},icon:o.createElement(te,null),onPress:this._handleToggleVisibility,type:a}),this._showDMQuickAccessWithClose?o.createElement($.a,{accessibilityLabel:se,icon:o.createElement(ae.a,null),onPress:this._handleClose,type:a}):null)})),i()(this,"_handleUnpopConvo",(()=>{const{popOutConversation:e}=this.props;e(null)})),i()(this,"_handleToggleVisibility",(()=>{const{analytics:e,setDrawerVisibility:t,onDrawerOpen:a}=this.props,n=this._isExpanded()?L.a.COLLAPSED:L.a.EXPANDED;n===L.a.COLLAPSED?e.scribe({action:"collapse"}):n===L.a.EXPANDED&&(e.scribe({action:"expand"}),a&&a()),t(n)})),i()(this,"_handleToggleVisibilityKeyboard",(()=>{this._handleToggleVisibility(),this._headerBar&&this._headerBar.current&&this._headerBar.current.focus()})),i()(this,"_handleClose",(()=>{const{analytics:e,setDrawerVisibility:t}=this.props;e.scribe({action:"close"}),t(L.a.CLOSED)})),i()(this,"_handleNewMessage",(()=>{const{analytics:e,history:t}=this.props;e.scribe({section:"compose_drawer",component:"dm",action:"show"}),t.push({pathname:"/messages/compose",state:{source:"drawer"}})})),i()(this,"_renderTitle",(()=>{const{conversationTitle:e,hasNewMessages:t,isHighlighted:a}=this.props,n=e||o.createElement(G.c,null,re);return o.createElement(V.a,{style:ue.titleContainer},o.createElement(V.a,{style:[ue.titleTextRoot,a&&t?ue.titleTextHighlighted:null]},n),t?o.createElement(V.a,{style:ue.newMessageDotContainer},o.createElement(ne.a,{accessibilityLabel:de,style:[ue.newMessageDotRoot,a?ue.newMessageDotHighlighted:ue.newMessageDotRegular]})):null)}))}componentDidUpdate(e){const{hasNewMessages:t,isHighlighted:a,triggerHighlight:n}=this.props;e.isHighlighted||a||e.hasNewMessages||!t||n&&n()}render(){const{conversationTitle:e,conversationSubtitle:t,hasNewMessages:a,isHighlighted:n}=this.props,r=a?n?[ue.headerHighlighted]:[ue.headerActive]:[],s=this._isExpanded();return o.createElement(B.a,{enabled:!0,handlers:{[j.d.toggleDMDrawer]:this._handleToggleVisibilityKeyboard}},o.createElement(V.a,{ref:this._headerBar,style:[ue.headerRoot,!s&&ue.headerBorderClosed,...r,ue.cursor,{zIndex:1}]},o.createElement(q.a,{leftControl:e&&this._isExpanded()?this._renderLeftControl():null,onMiddleControlClick:this._handleToggleVisibility,rightControl:this._renderRightControl(),subtitle:t,title:this._renderTitle(),withBackground:!1})))}}i()(me,"contextType",U.a);const ue=z.a.create((e=>({root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderColor:e.colors.borderColor,borderWidth:e.borderWidths.small,marginRight:e.spaces.space20,width:l.a.columnWidths.secondary.normal},cursor:{cursor:"pointer"},expanded:{height:l.a.columnWidths.secondary.normal},headerRoot:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderColor:e.colors.borderColor,borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,transition:"all 0.3s ease"},headerBorderClosed:{borderColor:e.colors.navigationBackground},headerActive:{backgroundColor:e.colors.unreadCellBackground},headerHighlighted:{borderColor:e.colors.primary,backgroundColor:e.colors.primary},titleContainer:{alignItems:"center",display:"flex",flexDirection:"row",flexGrow:1},titleTextRoot:{flexGrow:1,flexShrink:1},titleTextHighlighted:{color:e.colors.white},newMessageDotContainer:{flexGrow:1},newMessageDotRoot:{width:e.spaces.space12,height:e.spaces.space12,marginLeft:e.spaces.space4},newMessageDotRegular:{color:e.colors.primary},newMessageDotHighlighted:{color:e.colors.white},newMessagePip:{right:e.spaces.space4,top:e.spaces.space4},rightControls:{flexDirection:"row"}})));var pe=P(me),be=a("aWzz"),ge=a("XnpN"),Ee=a("zb92"),_e=Object(Ee.a)({loader:()=>Promise.all([a.e(8),a.e(180)]).then(a.bind(null,"Z+oW"))}),ve=a("GSsg"),ye=a("aITJ"),fe=a("yrzJ");class Ie extends o.Component{constructor(e){super(e),i()(this,"_composer",o.createRef()),i()(this,"_renderConversation",((e,t)=>{const{conversationId:a,history:n,location:r}=this.props;return o.createElement(N.a,{conversationId:a,history:n,isWide:!1,location:r,richTextInputContext:e,typeaheadWrapper:t})})),i()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===L.a.EXPANDED})),i()(this,"_fetchUpdatesIfNeeded",(()=>{const{conversationId:e,createLocalApiErrorHandler:t,fetchUpdatesIfNeeded:a,isDmReceiptSettingEnabled:n}=this.props;a(n?{active_conversation_id:e,dm_users:!0}:{}).catch(t())})),Object(k.a)()}componentDidMount(){this._updatePolling()}componentDidUpdate(e){e.visibility!==this.props.visibility&&this._updatePolling()}render(){const{conversation:e,perspective:t,history:a,isUnread:n,inboxUnreadCount:r,isHeaderHighlighted:s,onDrawerOpen:i,triggerHeaderHighlight:l}=this.props,c=this._isExpanded(),d=s?"white":"normal",h=s?"white":"gray600",m=e&&e.type===H.a.ONE_TO_ONE&&t&&Object(ge.a)(e,t).map((({user:e})=>e.screen_name)),u=m?o.createElement(fe.a,{color:h,screenName:m[0]}):void 0;return o.createElement(o.Fragment,null,o.createElement(pe,{conversationSubtitle:u,conversationTitle:o.createElement(R.b,{conversation:e,perspective:t,textColor:d,withScreenName:!1}),hasNewMessages:n,history:a,inboxUnreadCount:r,isHighlighted:s,onDrawerOpen:i,triggerHighlight:l}),c?ye.b.isDesktopOS()?o.createElement(_e,null,(({richTextInputContext:e,typeaheadWrapper:t})=>this._renderConversation(e,t))):this._renderConversation():null)}_updatePolling(){this._pollingTimer&&this._pollingTimer.stop(),this.props.visibility===L.a.COLLAPSED&&(this._pollingTimer=new ve.a(this._fetchUpdatesIfNeeded,{interval:3e3}),this._pollingTimer.start())}getChildContext(){return{getCustomLocation:null}}}i()(Ie,"childContextTypes",{getCustomLocation:be.func});var Ce=T(Ie),xe=a("4q8G"),we=a("kGix"),Me=a("tn7R");var De=Object(d.a)().propsFromState((()=>({fetchStatus:c.selectFetchStatus,conversations:c.selectConversations,isLoadingTop:c.selectIsLoadingTop,settings:C.f,unreadCount:f.a,untrustedConversationCount:c.selectUntrustedConversationCount,untrustedUnreadCount:c.selectUntrustedUnreadCount,visibility:c.selectDrawerVisibility}))).adjustStateProps((({fetchStatus:e,conversations:t,isLoadingTop:a,settings:n,unreadCount:r,untrustedConversationCount:s,untrustedUnreadCount:i,visibility:o})=>{const l=!!Object.values(t).length,c=Object(Me.a)(t).filter((e=>{var t;return!e.isDeleted&&(null==(t=e.data)?void 0:t.trusted)})).map((e=>e.data)).sort(xe.a),d=r>0;return{allowUntrustedInbox:"all"===n.allow_dms_from||s>0,conversationIds:c.map((e=>e.conversation_id)),fetchStatus:l?we.a.LOADED:e,isRefreshing:l&&a,isUnread:d,untrustedUnreadCount:i,visibility:o}})).propsFromActions((()=>({createLocalApiErrorHandler:Object(h.d)("DIRECT_MESSAGES_INBOX"),fetchInbox:c.fetchInbox,fetchInboxHistory:c.fetchTrustedInboxHistory,fetchInboxIfNeeded:c.fetchInboxIfNeeded,fetchUpdates:c.fetchUpdatesIfNeeded,updateLastSeenEventId:c.updateTrustedLastSeenEventId,popOutConversation:c.popOutConversation}))).withAnalytics({page:"messages",section:"inbox_drawer"}),Se=a("qS4/"),Oe=a("yw4N"),Te=a("FIs5"),He=a("csss");const ke=F.a.a2f8105f,Ne=F.a.b8aa3744,Re=F.a.j06309e1,Ue=F.a.gee5150a,Pe=F.a.cf2d1047,Le=F.a.da2f9224,Ae=F.a.h6beb5fa;class Fe extends o.Component{constructor(...e){super(...e),i()(this,"_renderExpandedInbox",(()=>{const{analytics:e,conversationIds:t,createLocalApiErrorHandler:a,fetchInbox:n,fetchInboxHistory:r,fetchInboxIfNeeded:s,fetchStatus:i,fetchUpdates:l,isRefreshing:c,updateLastSeenEventId:d}=this.props;return o.createElement(V.a,{style:je.fill},o.createElement(Oe.a,{style:je.viewportView},o.createElement(Se.a,{accessibilityTitle:ke,analytics:e,conversationIds:t,conversationPathPrefix:"/messages",createLocalApiErrorHandler:a,customCellClick:this._dmDrawerOnClick,fetchInbox:n,fetchInboxHistory:r,fetchInboxIfNeeded:s,fetchStatus:i,fetchUpdates:l,isRefreshing:c,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderPivot,updateLastSeenEventId:d,virtualScrollerCacheKey:"dmDrawerInbox"})))})),i()(this,"_renderEmptyDMInbox",(()=>o.createElement(Te.a,{buttonLink:"/messages/compose",buttonText:Ue,header:Ne,message:Re,onImpression:this._handleEmptyDMInboxImpression}))),i()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===L.a.EXPANDED})),i()(this,"_dmDrawerOnClick",((e,t)=>{const{popOutConversation:a}=this.props;a(t),e.preventDefault()})),i()(this,"_handleEmptyDMInboxImpression",(()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})})),i()(this,"_handleRequestsPivotClick",(()=>{const{analytics:e}=this.props;e.scribe({element:"requests_pivot",action:"click"})})),i()(this,"_renderPivot",(()=>{const{allowUntrustedInbox:e}=this.props;return e?o.createElement(V.a,{style:je.requestPivotContainer},o.createElement(He.a,{label:Pe,link:"/messages/requests",onPress:this._handleRequestsPivotClick,renderRightContent:this._renderPivotBadge,withBottomBorder:!1})):null})),i()(this,"_renderPivotBadge",(()=>{const{untrustedUnreadCount:e}=this.props;return e>0?o.createElement(W.a,{count:e,standalone:!0,truncatedCountFormatter:Ae,unreadCountLabel:Le}):null}))}componentDidUpdate(){this._isExpanded()&&Object(k.a)()}render(){const{history:e,isUnread:t,isHeaderHighlighted:a,onDrawerOpen:n,triggerHeaderHighlight:r}=this.props,s=this._isExpanded();return o.createElement(o.Fragment,null,o.createElement(pe,{hasNewMessages:t,history:e,isHighlighted:a,onDrawerOpen:n,triggerHighlight:r}),s&&this._renderExpandedInbox())}}const je=z.a.create((e=>({fill:{flex:1,alignSelf:"stretch"},requestPivotContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:2},viewportView:{...z.a.absoluteFillObject,overflowY:"auto"}})));var Be=De(Fe),Ve=a("YeIG"),$e=a("A69o"),We="DMDrawer",Ge=a("TnY3"),qe=a("0FVZ"),ze=a("Oe3h");const Ke={isGlobal:!0,isSticky:!0},Xe={isGlobal:!0,isSticky:!1};class Qe extends o.PureComponent{constructor(...e){super(...e),i()(this,"state",{isHeaderHighlighted:!1,hasStartedInitialFetch:!1,unexpandedHeight:void 0}),i()(this,"_handleLayout",(e=>{const{nativeEvent:{layout:{height:t}}}=e,{unexpandedHeight:a}=this.state;this._isExpanded()||void 0!==a||this.setState({unexpandedHeight:t})})),i()(this,"_showDMDrawer",(()=>{const{conversations:e,visibility:t}=this.props,a=t===L.a.CLOSED;return!this._isHideDMDrawerPath()&&!Object(Ve.a)(e)&&!a})),i()(this,"_isExpanded",(()=>{const{visibility:e}=this.props;return e===L.a.EXPANDED})),i()(this,"_triggerHeaderHighlight",(()=>{const{isHeaderHighlighted:e}=this.state;this._isExpanded()||e||this._headerHighlightTimeoutId||(this.setState({isHeaderHighlighted:!0}),this._headerHighlightTimeoutId=setTimeout((()=>{this.setState({isHeaderHighlighted:!1}),this._headerHighlightTimeoutId=void 0}),3e3))})),i()(this,"_handleDrawerOpen",(()=>{const{isHeaderHighlighted:e}=this.state;e&&(this.setState({isHeaderHighlighted:!1}),clearTimeout(this._headerHighlightTimeoutId),this._headerHighlightTimeoutId=void 0)})),i()(this,"_isOnOcfFlow",(()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/flow")})),i()(this,"_isOnBirdwatchPage",(()=>{const{location:e}=this.props;return e.pathname.startsWith("/i/birdwatch")})),i()(this,"_isHideDMDrawerPath",(()=>this._isOnOcfFlow()||this._isOnBirdwatchPage()))}componentWillUnmount(){clearTimeout(this._headerHighlightTimeoutId)}componentDidUpdate(){this._loadInboxDataIfNeeded()}componentDidMount(){this._loadInboxDataIfNeeded()}render(){const{history:e,location:t,perspective:a,poppedOutConversationId:n,width:s}=this.props,{isHeaderHighlighted:i,unexpandedHeight:l}=this.state,c=this._isExpanded();return this._showDMDrawer()?o.createElement(qe.a.Drawer,null,o.createElement(ze.a,{id:"DMDrawer"},((d,h)=>o.createElement(p.a.Provider,{value:{isDrawer:!0}},o.createElement(V.a,r()({ref:d()},h({style:[Ye.root,{width:s}],testID:We})),o.createElement(V.a,{onLayout:l?void 0:this._handleLayout,style:[Ye.expandable,{height:l,maxHeight:l},c&&Ye.expanded]},n?o.createElement($e.a.Provider,{value:Xe},o.createElement(Ce,{conversationId:n,history:e,isHeaderHighlighted:i,location:t,onDrawerOpen:this._handleDrawerOpen,perspective:a,triggerHeaderHighlight:this._triggerHeaderHighlight})):o.createElement($e.a.Provider,{value:Ke},o.createElement(Be,{history:e,isHeaderHighlighted:i,onDrawerOpen:this._handleDrawerOpen,triggerHeaderHighlight:this._triggerHeaderHighlight})))))))):null}_loadInboxDataIfNeeded(){const{fetchInboxIfNeeded:e,createLocalApiErrorHandler:t,loadDrawerExperimentFromPersistence:a,loadDrawerVisibilityFromPersistence:n}=this.props,{hasStartedInitialFetch:r}=this.state;this._isHideDMDrawerPath()||r||(n(),a(),e().catch(t()),this.setState({hasStartedInitialFetch:!0}))}}i()(Qe,"defaultProps",{width:l.a.dmDrawerWidth.max});const Ye=z.a.create((e=>({root:{alignSelf:"flex-end",backgroundColor:e.colors.navigationBackground,borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,boxShadow:e.boxShadows.medium,marginRight:e.spaces.space20,minWidth:l.a.dmDrawerWidth.min,maxWidth:l.a.dmDrawerWidth.max},expandable:{transition:"all 0.3s ease"},expanded:{maxHeight:l.a.dmDrawerHeight.expanded,height:"80vh"}}))),Ze=u(Qe);t.default=Object(Ge.a)(Ze)},"qS4/":function(e,t,a){"use strict";var n=a("KEM+"),r=a.n(n),s=(a("kYxP"),a("ERkP")),i=a("BUB3"),o=a("v6aA"),l=a("s14A"),c=(a("MvUL"),a("EbOo")),d=a("MMRb"),h=a("1YZw"),m=a("0KEI"),u=a("hqKg"),p=a("AQOc"),b=a("G6rE"),g=a("oEGd");const E=(e,t)=>t.conversationId,_=Object(u.createSelector)(E,((e,t)=>d.selectConversation(e,E(0,t))),d.selectEntries,b.e.selectAll,((e,t)=>!d.selectConversationIsRead(e,E(0,t))),((e,t,a,n,r)=>({conversation:t&&Object(p.a)(t.data,a,n),conversationId:e,unread:r}))),v={addToast:h.b,block:b.e.block,createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_INBOX_ITEM"),leaveConversation:d.leaveConversation,muteDMUser:d.muteDMUser,unmuteDMUser:d.unmuteDMUser,unblock:b.e.unblock};var y=Object(g.g)(_,v),f=a("aA19"),I=a("OhSZ"),C=a("t62R"),x=a("g54k");const w=Object(u.createSelector)(b.e.selectAll,((e,t)=>t.entry),x.b);var M=Object(g.c)(w),D=a("zQEV");var S=M((({entry:e,entryType:t,perspective:a,users:n})=>{const r=Object(D.a)(e,t,a,n);return s.createElement(C.c,{color:"gray600"},r)}));const O=Object(u.createSelector)(((e,t)=>b.e.select(e,t.senderId)),((e,t)=>t.recipientId?b.e.select(e,t.recipientId):void 0),((e,t)=>({user:e,recipient:t})));var T=Object(g.c)(O),H=a("X/yg"),k=a("cTG8"),N=a("3XMw"),R=a.n(N);const U=e=>s.createElement(R.a.I18NFormatMessage,{$i18n:"b3a2b11c"},s.createElement(C.c,null,e)),P=R.a.dedfd265;const L=R.a.a876e58b,A=R.a.bf584cd1,F=R.a.a9cc8cfd,j=R.a.e20b65b0,B=R.a.e5bfe07d,V=R.a.b1a614fe;var $=T((({entry:e,perspective:t,isGroupDM:a,user:n={},recipient:r={}})=>{const{featureSwitches:i}=s.useContext(o.a),l=e&&e.message_data;if(!l)return null;const{attachment:c}=l,d=c&&!!(c.video||c.photo||c.animated_gif||c.tweet||c.fleet||c.sticker||c.card),h=t===n.id_str,m=!(!d||!h)||!(!a||h),u=n.name,p=r.name;let b=[m&&s.createElement(C.c,{key:"senderName"},U(u)," "),l&&l.text&&s.createElement(k.a,{displayTextRange:[0,l.text.length],entities:l.entities,key:"message",text:l.text,withMediaLinks:!0})];return c&&(c.tweet?b=m?((e,t)=>e?s.createElement(C.c,null,R.a.d5b762c8):s.createElement(R.a.I18NFormatMessage,{$i18n:"dfd2b3b9"},s.createElement(C.c,null,t)))(h,u):V:c.fleet?b=((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"i005f1fd"},s.createElement(C.c,null,t),s.createElement(C.c,null,a||"")):s.createElement(R.a.I18NFormatMessage,{$i18n:"b35cee40"},s.createElement(C.c,null,a||"")))(h,p,l.text):c.video?b=Object(H.e)(c,i)?m?function(e,t){return e?s.createElement(C.c,null,R.a.h7033cac):s.createElement(R.a.I18NFormatMessage,{$i18n:"be5a9616"},s.createElement(C.c,null,t))}(h,u):P:m?((e,t)=>e?s.createElement(C.c,null,R.a.j7d81019):s.createElement(R.a.I18NFormatMessage,{$i18n:"eee2f120"},s.createElement(C.c,null,t)))(h,u):L:c.photo?b=m?((e,t)=>e?s.createElement(C.c,null,R.a.f80629ba):s.createElement(R.a.I18NFormatMessage,{$i18n:"c1e1f848"},s.createElement(C.c,null,t)))(h,u):A:c.animated_gif?b=m?((e,t)=>e?s.createElement(C.c,null,R.a.eb3d722e):s.createElement(R.a.I18NFormatMessage,{$i18n:"dc4b75a1"},s.createElement(C.c,null,t)))(h,u):F:c.sticker?b=m?((e,t)=>e?s.createElement(C.c,null,R.a.d30c2d4f):s.createElement(R.a.I18NFormatMessage,{$i18n:"c7e2464e"},s.createElement(C.c,null,t)))(h,u):j:c.card&&(b=m?((e,t)=>e?s.createElement(C.c,null,R.a.db53c017):s.createElement(R.a.I18NFormatMessage,{$i18n:"hcbbbb34"},s.createElement(C.c,null,t)))(h,u):B)),s.createElement(C.c,{color:"gray600",numberOfLines:1},b)})),W=a("uKEd");const G=(e,t)=>t.senderId?b.e.select(e,t.senderId):void 0,q=(e,t)=>Object(W.n)(e,t.reactionEntry.message_id),z=(e,t)=>{const a=q(e,t);return a&&a.message_data&&b.e.select(e,a.message_data.sender_id)};var K=Object(g.e)((()=>Object(u.createSelector)(G,q,z,((e,t,a)=>({reactedMessageEntry:t,reactingUser:e,messageUser:a})))),{}),X=a("33Kz");var Q=K((({isGroupDM:e,messageUser:t,perspective:a,reactionEntry:n,reactedMessageEntry:r,reactingUser:i})=>{const{featureSwitches:l}=s.useContext(o.a),c=r&&r.message_data,d=c&&c.attachment,h=c&&c.text,m=t&&t.screen_name,u=a===(i&&i.id_str),p=i&&i.name,b=Object(X.b)(n.reaction_key||"",l);let g;return g=d&&d.tweet?e?((e,t,a,n)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"c4202784"},s.createElement(C.c,null,a),s.createElement(C.c,null,n)):s.createElement(R.a.I18NFormatMessage,{$i18n:"b493a890"},s.createElement(C.c,null,t),s.createElement(C.c,null,a),s.createElement(C.c,null,n)))(u,p,m,b):((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"ca684bf5"},s.createElement(C.c,null,a)):s.createElement(R.a.I18NFormatMessage,{$i18n:"h5797be5"},s.createElement(C.c,null,t),s.createElement(C.c,null,a)))(u,p,b):d&&d.video?e?((e,t,a,n)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"d1f8bdd9"},s.createElement(C.c,null,a),s.createElement(C.c,null,n)):s.createElement(R.a.I18NFormatMessage,{$i18n:"d764af97"},s.createElement(C.c,null,t),s.createElement(C.c,null,a),s.createElement(C.c,null,n)))(u,p,m,b):((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"ab1cdfe2"},s.createElement(C.c,null,a)):s.createElement(R.a.I18NFormatMessage,{$i18n:"f0cf1699"},s.createElement(C.c,null,t),s.createElement(C.c,null,a)))(u,p,b):d&&d.photo?e?((e,t,a,n)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"hec0fd4d"},s.createElement(C.c,null,a),s.createElement(C.c,null,n)):s.createElement(R.a.I18NFormatMessage,{$i18n:"j55320de"},s.createElement(C.c,null,t),s.createElement(C.c,null,a),s.createElement(C.c,null,n)))(u,p,m,b):((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"jf27606a"},s.createElement(C.c,null,a)):s.createElement(R.a.I18NFormatMessage,{$i18n:"cd110359"},s.createElement(C.c,null,t),s.createElement(C.c,null,a)))(u,p,b):d&&d.animated_gif?e?((e,t,a,n)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"e70dcc35"},s.createElement(C.c,null,a),s.createElement(C.c,null,n)):s.createElement(R.a.I18NFormatMessage,{$i18n:"g1bf440b"},s.createElement(C.c,null,t),s.createElement(C.c,null,a),s.createElement(C.c,null,n)))(u,p,m,b):((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"b2da1bf8"},s.createElement(C.c,null,a)):s.createElement(R.a.I18NFormatMessage,{$i18n:"g84c0421"},s.createElement(C.c,null,t),s.createElement(C.c,null,a)))(u,p,b):d&&d.card?e?((e,t,a,n)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"cd2e7c18"},s.createElement(C.c,null,a),s.createElement(C.c,null,n)):s.createElement(R.a.I18NFormatMessage,{$i18n:"aee9e7fa"},s.createElement(C.c,null,t),s.createElement(C.c,null,a),s.createElement(C.c,null,n)))(u,p,m,b):((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"f9fb1cf6"},s.createElement(C.c,null,a)):s.createElement(R.a.I18NFormatMessage,{$i18n:"f2bf910e"},s.createElement(C.c,null,t),s.createElement(C.c,null,a)))(u,p,b):h?e?((e,t,a,n,r)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"i6cec545"},s.createElement(C.c,null,n),s.createElement(C.c,null,a),s.createElement(C.c,null,r)):s.createElement(R.a.I18NFormatMessage,{$i18n:"d6998baa"},s.createElement(C.c,null,t),s.createElement(C.c,null,n),s.createElement(C.c,null,a),s.createElement(C.c,null,r)))(u,p,b,m,h):((e,t,a,n)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"cec676f3"},s.createElement(C.c,null,a),s.createElement(C.c,null,n)):s.createElement(R.a.I18NFormatMessage,{$i18n:"a2706f9a"},s.createElement(C.c,null,t),s.createElement(C.c,null,a),s.createElement(C.c,null,n)))(u,p,b,h):((e,t,a)=>e?s.createElement(R.a.I18NFormatMessage,{$i18n:"d6b15bbf"},s.createElement(C.c,null,a)):s.createElement(R.a.I18NFormatMessage,{$i18n:"ac0d4bc7"},s.createElement(C.c,null,t),s.createElement(C.c,null,a)))(u,p,b),s.createElement(C.c,{color:"gray600",numberOfLines:1},g)})),Y=a("H4nC"),Z=a("b9JY");const J=R.a.fb3ccb55;var ee=({conversationType:e,entry:t,perspective:a})=>{if(t.marked_as_spam)return s.createElement(C.c,{color:"gray600",numberOfLines:1},J);if(Object(Z.b)(t)){const{message_data:{sender_id:n,recipient_id:r}={}}=t;return s.createElement($,{entry:t,isGroupDM:e===d.CONVERSATION_TYPE.GROUP,perspective:a,recipientId:r,senderId:n})}return Object(Z.c)(t)?s.createElement(Q,{isGroupDM:e===d.CONVERSATION_TYPE.GROUP,perspective:a,reactionEntry:t,senderId:t.sender_id}):Object(Z.a)(t)?s.createElement(S,{entry:t,entryType:t.type,perspective:a}):Object(Z.d)(t)?s.createElement(Y.a,{entry:t,isCompact:!0}):null},te=a("Myq3"),ae=a("3wZR"),ne=a("b2lu"),re="conversation",se=a("u0B7"),ie=a("MWbm"),oe=a("Irs7"),le=a("0PHd"),ce=a("/yvb"),de=a("eb3s"),he=a("lHOd"),me=a("efqG"),ue=a("GBcw"),pe=a("htQn"),be=a("5mJL"),ge=a("rHpw"),Ee=a("vMjK"),_e=a("aWyx"),ve=a("hiGS"),ye=a("5oT/"),fe=a("Lsrn"),Ie=a("k/Ka");const Ce=(e={})=>Object(Ie.a)("svg",{...e,style:[fe.a.root,e.style],viewBox:"0 0 24 24"},s.createElement("g",null,s.createElement("path",{d:"M22.238 2.257c-.293-.293-.768-.293-1.06 0L2.52 20.917c-.293.292-.293.767 0 1.06.146.146.338.22.53.22s.384-.073.53-.22l18.658-18.66c.293-.293.293-.767 0-1.06zM2.986 17.82c.155 0 .312-.048.446-.148.112-.083 2.752-2.104 2.708-7.248-.02-2.16.643-3.98 1.913-5.266 1.093-1.107 2.577-1.72 4.18-1.727 1.325.006 2.562.42 3.578 1.195.137.104.297.153.455.153.227 0 .45-.102.598-.295.25-.33.188-.8-.142-1.052-1.278-.975-2.828-1.493-4.483-1.5h-.003c-2.008.008-3.87.78-5.248 2.173-1.536 1.551-2.368 3.8-2.348 6.332.037 4.33-2.02 5.967-2.103 6.03-.332.247-.4.718-.154 1.05.147.2.374.303.603.303zm16.844-7.382c.002-.246-.003-.487-.017-.723-.024-.414-.387-.74-.792-.706-.413.023-.728.378-.705.79.012.205.017.413.015.624-.024 2.868.785 4.765 1.526 5.896h-8.314c-.414 0-.75.336-.75.75s.336.75.75.75h3.522c-.1 1.48-1.323 2.66-2.828 2.66-1.003 0-1.913-.514-2.436-1.372-.214-.354-.675-.467-1.03-.25-.354.214-.467.675-.25 1.03.795 1.31 2.185 2.09 3.716 2.09 2.332 0 4.227-1.85 4.328-4.158h4.922c.32 0 .604-.206.707-.51.104-.305 0-.643-.255-.84-.087-.066-2.145-1.7-2.108-6.032z"})));Ce.metadata={width:24,height:24};var xe=Ce;const we=R.a.gde6b424,Me=R.a.e308019b,De=R.a.gf5e9ea6,Se=R.a.gdf4b79f,Oe=R.a.bbf83d83,Te=R.a.d96cf7cd,He=R.a.d88d0790,ke={component:"low_quality_timeline"},Ne=({children:e})=>s.createElement(ie.a,{style:Ue.socialProofContainer},e);class Re extends s.Component{constructor(...e){super(...e),r()(this,"state",{showConfirmation:!1}),r()(this,"_renderConvoLabel",(({convo_label:e})=>{if(null==e||!e.text)return null;const t=Object(ae.b)(e.icon);return s.createElement(C.c,{color:"gray600",size:"small"},t?s.createElement(t,{style:Ue.convoLabelIcon}):null,e.text)})),r()(this,"_renderSocialProof",(({social_proof:e})=>{if(!e||0===e.length)return null;const t=e[0];switch(t.proof_type){case _e.d.MUTUAL_FRIENDS:{if(0===t.total)return null;const e=t.users.map((({profile_image_url_https:e})=>e)),a=t.users.map((({name:e})=>e));return s.createElement(Ne,null,s.createElement(le.a,{displayFacepileInline:!0,knownFollowersAvatarUrls:e,knownFollowersCount:t.total,knownFollowersNames:a}))}default:return null}})),r()(this,"_renderTrashcan",(()=>{const{conversationId:e}=this.props;return s.createElement(s.Fragment,null,s.createElement(ce.a,{accessibilityLabel:Te,borderColor:"transparent",icon:s.createElement(ve.a,{style:Ue.trashcanIcon}),onPress:this._handleShowConfirmation,type:"destructiveText"}),this.state.showConfirmation?s.createElement(de.a,{confirmButtonLabel:Te,confirmButtonType:"destructive",headline:Se,onCancel:this._handleHideConfirmation,onConfirm:this._deleteConversation(e),text:Oe}):null)})),r()(this,"_renderX",(()=>{const{conversation:e,conversationId:t}=this.props,{loggedInUserId:a}=this.context,n=this.context.featureSwitches.isTrue("dm_conversations_muting_enabled"),r=Object(H.c)(e,a),i=(null==e?void 0:e.type)===d.CONVERSATION_TYPE.GROUP;return s.createElement(he.a.Consumer,null,(a=>s.createElement(me.a,{renderContent:(o,l)=>s.createElement(ne.a,{dismiss:o,flatBorders:"sheet"===l,isGroup:i,isMuted:!(null==e||!e.muted),onBlockClick:this._blockUser(r.idStr),onDeleteClick:this._deleteConversation(t),onMuteDMUserClick:this._handleMuteDMUserClick(a),onReportClick:this._handleReportMenuItemClick(a),onUnmuteDMUserClick:this._handleUnmuteDMUserClick(a),requestorScreenName:r.screenName,showBlock:!i,showCancel:"sheet"===l,showDelete:!0,showMute:n&&!i})},s.createElement(ce.a,{accessibilityLabel:He,borderColor:"transparent",icon:s.createElement(ye.a,{style:Ue.xIcon}),style:Ue.xButton,type:"text"}))))})),r()(this,"_handleReportMenuItemClick",(e=>()=>{const{analytics:t,conversationId:a}=this.props;if(a){t.scribeAction("report");const n=Object(H.b)(a,window.location.pathname,t.contextualScribeNamespace);e.push(n)}})),r()(this,"_handleMuteDMUserClick",(e=>()=>{const{addToast:t,analytics:a,conversation:n,conversationId:r,createLocalApiErrorHandler:s,muteDMUser:i}=this.props,{loggedInUserId:o}=this.context,{idStr:l,name:c}=Object(H.c)(n,o);i(l,r).then((()=>{t({action:{label:De,onAction:this._handleUnmuteDMUserClick(e)},text:we({name:c})}),e.location.pathname.match("additional")||e.replace("/messages/requests")}),s()),a.scribeAction("mute_user")})),r()(this,"_handleUnmuteDMUserClick",(e=>()=>{const{addToast:t,analytics:a,conversation:n,conversationId:r,createLocalApiErrorHandler:s,unmuteDMUser:i}=this.props,{loggedInUserId:o}=this.context,{idStr:l,name:c}=Object(H.c)(n,o);r&&(i(l,r).then((()=>{t({action:{label:De,onAction:this._handleMuteDMUserClick(e)},text:Me({name:c})}),e.replace(`/messages/requests/${r}`)}),s()),a.scribeAction("unmute_user"))})),r()(this,"_renderTimestamp",(()=>{const{conversation:e}=this.props;return s.createElement(s.Fragment,null,s.createElement(ie.a,null,e?s.createElement(ue.a,{timestamp:Number(e.sort_timestamp)}):null,null!=e&&e.notifications_disabled?s.createElement(xe,{style:Ue.notificationsDisabledIcon}):null))})),r()(this,"_deleteConversation",(e=>()=>{const{analytics:t,conversation:a,createLocalApiErrorHandler:n,leaveConversation:r}=this.props,{history:s}=this.context,i=a&&a.type===d.CONVERSATION_TYPE.GROUP?"leave_group":"delete_thread";this._handleHideConfirmation(),t.scribe({element:"thread",action:i}),r({conversationId:e}).catch(n({showToast:!0})),s.location.pathname.match("additional")?s.replace("/messages/requests/additional"):s.replace("/messages/requests")})),r()(this,"_blockUser",(e=>()=>{const{analytics:t,addToast:a,block:n,createLocalApiErrorHandler:r}=this.props;n(e).then((()=>{a({action:{label:Ee.c,onAction:this._createUnblockUserHandler(e)},text:Ee.a})}),r(c.a)),t.scribeAction("block")})),r()(this,"_createUnblockUserHandler",(e=>()=>{const{analytics:t,createLocalApiErrorHandler:a,unblock:n}=this.props;n(e).catch(a(se.a)),t.scribeAction("unblock")})),r()(this,"_handleHideConfirmation",(()=>{this.setState({showConfirmation:!1})})),r()(this,"_handleOnClick",(e=>{const{conversationId:t,onClick:a,conversation:n}=this.props;a(e,t,!(null==n||!n.muted))})),r()(this,"_handleShowConfirmation",(e=>{const{analytics:t}=this.props;e.stopPropagation(),t.scribe({...ke,element:"accessory_trashcan",action:"click"}),this.setState({showConfirmation:!0})}))}shouldComponentUpdate(e,t){const a=this.props.conversation,n=null==a?void 0:a.conversation_id,r=null==a?void 0:a.last_read_event_id,s=null==a?void 0:a.sort_event_id,i=null==a?void 0:a.max_entry_id,o=null==a?void 0:a.convo_label,l=e.conversation,c=null==l?void 0:l.conversation_id,d=null==l?void 0:l.last_read_event_id,h=null==l?void 0:l.sort_event_id,m=null==l?void 0:l.max_entry_id,u=null==l?void 0:l.convo_label,{filter:p,isActive:b}=this.props,{filter:g,isActive:E}=e,{showConfirmation:_}=this.state,{showConfirmation:v}=t;return n!==c||r!==d||s!==h||i!==m||b!==E||_!==v||p!==g||o!==u}render(){const{conversation:e,filter:t,isActive:a,isSecondaryInbox:n,isTertiaryInbox:r,perspective:i,unread:o,link:l}=this.props,c=(null==e?void 0:e.entries)||[],d=Object(te.a)(c,(e=>![_e.b.MESSAGE_DELETE,_e.b.REACTION_DELETE,_e.b.MESSAGE_MARK_AS_SPAM,_e.b.MESSAGE_MARK_AS_NOT_SPAM,_e.b.CONVO_METADATA_UPDATE].includes(e.type))),h=[Ue.root,Ue.bottomBorder,o&&Ue.unread];if(!e||!t(e))return null;const m=!!e.convo_label,u=!e.trusted&&!m,p=this.context.featureSwitches.isTrue("dm_conversations_requests_inbox_actions_button_enabled");return s.createElement(pe.a,{accessibilityRole:"tab",accessibilityState:{selected:a},link:{pathname:l,anchorless:!0},onPress:this._handleOnClick,style:h,testID:re},s.createElement(be.a,{avatarCell:s.createElement(f.a,{conversation:e,perspective:i})},s.createElement(ie.a,{style:Ue.bodyColumn},s.createElement(ie.a,{style:Ue.titleContainer},s.createElement(I.b,{conversation:e,perspective:i}),s.createElement(ie.a,{style:Ue.snippet},d?s.createElement(ee,{conversationType:e.type,entry:d,perspective:i}):null),m?this._renderConvoLabel(e):null,u?this._renderSocialProof(e):null),p&&(n||r)?this._renderX():r?this._renderTrashcan():this._renderTimestamp())))}}r()(Re,"contextType",o.a),r()(Re,"defaultProps",{isActive:!1,isSecondaryInbox:!1,isTertiaryInbox:!1,filter:e=>!0,unread:!1});const Ue=ge.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16,width:"100%"},bottomBorder:{borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor},bodyColumn:{flexDirection:"row"},titleContainer:{flex:1},notificationsDisabledIcon:{alignSelf:"flex-end",color:e.colors.gray600,paddingTop:e.spaces.space4},xButton:{alignSelf:"center",marginRight:`calc(-1 * ${e.spaces.space4})`},xIcon:{color:e.colors.red500},trashcanIcon:{color:e.colors.gray600},snippet:{maxHeight:e.spaces.space40,overflow:"hidden"},unread:{backgroundColor:e.colors.unreadCellBackground},socialProofContainer:{marginTop:e.spaces.space4},convoLabelIcon:{marginRight:e.spaces.space4}})));var Pe=Object(oe.a)(y(Re),{page:"messages",section:"inbox"}),Le=a("dwig"),Ae=a("v//M"),Fe=a("QB0K"),je=a("Avzu"),Be=a("FRNI");const Ve=R.a.dabdea6b,$e=R.a.f325afc3;class We extends s.PureComponent{render(){return s.createElement(Fe.a,{accessibilityLabel:Ve,href:"/messages/compose",icon:s.createElement(je.a,null),label:Ve,scribeComponent:"floating_dm_button",shortLabel:$e,testID:Be.a.message})}}var Ge=We,qe=a("VwDm"),ze=a("VPAj");var Ke={...a("IRWI").a,initialScrollHeadroom:Object(ze.a)(0),scrollHeadroom:Object(ze.a)(0),pinToTopWhenAtTop:!0},Xe=a("tI3i"),Qe=a.n(Xe),Ye=a("TEoO"),Ze=a("883S"),Je=a("yoO3"),et=a("IG4P"),tt=a("GSsg"),at=a("2g+p"),nt=a("6OUF"),rt=a("mw9i"),st=a("VY6S"),it=a("+d3d");const ot=e=>e,lt=R.a.a66ac766,ct=R.a.fe61929d;class dt extends s.Component{constructor(e,t){super(e,t),r()(this,"state",{filterQuery:""}),r()(this,"_render",(()=>{const{accessibilityTitle:e,conversationIds:t,footer:a,isRefreshing:n,renderEmptyDMInbox:r,renderStickyContent:i,virtualScrollerCacheKey:o}=this.props;return s.createElement(s.Fragment,null,i?i():null,this._enableSearchInbox?s.createElement(ie.a,{style:ht.searchInput},s.createElement(nt.a,{Icon:qe.a,onChange:this._handleSearchChange,onClear:this._handleSearchClear,onFocus:this._handleSearchFocus,placeholder:ct,withClearButton:!0})):null,s.createElement(l.a,null,s.createElement(et.a,{isRefreshing:n,onRefresh:this._handlePullToRefresh},o&&t?s.createElement(Ye.a,{accessibilityRole:"tablist",accessibilityTitle:e,anchoring:Ke,assumedItemHeight:100,cacheKey:o,footer:a,identityFunction:ot,items:t,noItemsRenderer:r,onNearEnd:this._handleNearEnd,renderer:this._renderInboxItem(this.state.filterQuery)}):null)))})),r()(this,"_handleNearEnd",(()=>{this.state.filterQuery||this._handleHistoryRequest()})),r()(this,"_handleSearchChangeInner",(e=>{const{analytics:t}=this.props;this.setState({filterQuery:e.toLowerCase()}),t.scribe({element:"thread",action:"search",data:{event_value:this.state.filterQuery.length}})})),r()(this,"_handleSearchChangeDebounced",Object(st.a)(this._handleSearchChangeInner,200)),r()(this,"_handleSearchChange",(({currentTarget:{value:e}})=>this._handleSearchChangeDebounced(e))),r()(this,"_handleSearchClear",(()=>this._handleSearchChangeInner(""))),r()(this,"_handleSearchFocus",(()=>{this.props.conversationIds&&this.props.conversationIds.length<30&&this._handleHistoryRequest()})),r()(this,"_renderInboxItem",(e=>t=>{const{loggedInUserId:a}=this.context,{conversationPathPrefix:n,isSecondaryInbox:r,isTertiaryInbox:o}=this.props,l=this._filterConversation(e),c=`${n}/${t}`;return Qe()(!!a,"loggedInUserId must be defined"),s.createElement(i.a,{exact:!1,path:c},(e=>s.createElement(Pe,{conversationId:t,filter:l,isActive:e,isSecondaryInbox:!!r,isTertiaryInbox:!!o,key:t,link:c,onClick:this._handleConversationClick,perspective:a})))})),r()(this,"_filterConversation",(e=>e=>{const{filterQuery:t}=this.state;if(!t)return!0;const{loggedInUserId:a}=this.context,n=Object.keys(e.participants),r="GROUP_DM"===e.type&&e.name&&e.name.toLowerCase().indexOf(t)>-1,s=n.some((r=>{const s=e.participants[r],i=a===r,o=1===n.length&&i,l=s&&s.user&&!i;return!(!o&&!l)&&this._userMatchesQuery(s.user.screen_name,s.user.name,t)}));return!(!r&&!s)})),r()(this,"_handleFetchInitialWrapper",(()=>{this._handleFetchInitial()})),r()(this,"_handleFetchInitial",(()=>{const{createLocalApiErrorHandler:e,fetchInboxIfNeeded:t,fetchUpdates:a}=this.props;return t().then(this._updateLastSeenEventId,e()).then((()=>{this._updatePolling.start()})).then((()=>a().catch(e())))})),r()(this,"_handleConversationClick",((e,t,a)=>{const{customCellClick:n,analytics:r}=this.props;r.scribe({element:a?"muted_conversation":"thread",action:"click",data:{event_value:this.state.filterQuery.length}}),n&&n(e,t)})),r()(this,"_handleEmptyDMInboxImpression",(()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})})),r()(this,"_handlePullToRefresh",(()=>{const{createLocalApiErrorHandler:e,fetchInbox:t}=this.props;t().then(this._updateLastSeenEventId,e())})),r()(this,"_updateLastSeenEventIdIfActive",(()=>{if("background"!==at.a.currentState)return this._updateLastSeenEventId()})),r()(this,"_updateLastSeenEventId",(()=>{const{createLocalApiErrorHandler:e,updateLastSeenEventId:t}=this.props;return t().catch(e())})),this._fab=s.createElement(Ge,null),this._enableSearchInbox=!!e.withDmSearch&&this.context.featureSwitches.isTrue("responsive_web_search_dms_enabled")}componentDidMount(){const{createLocalApiErrorHandler:e,fetchInboxHistory:t,fetchUpdates:a}=this.props;return this._updatePolling=new tt.a((()=>{a().then(this._updateLastSeenEventIdIfActive,e(Ze.a))}),{interval:8e3}),this._handleHistoryRequest=Object(it.a)(((...a)=>{t(...a).catch(e())}),1e3),this._handleFetchInitial()}componentWillUnmount(){this._updatePolling.stop()}render(){return s.createElement(Je.a,null,s.createElement(Le.a,{component:rt.a,fab:this._fab,style:ht.root},s.createElement(Ae.a,{accessibilityLabel:lt,fetchStatus:this.props.fetchStatus,onRequestRetry:this._handleFetchInitialWrapper,render:this._render})))}_userMatchesQuery(e,t,a){return e&&e.toLowerCase().indexOf(a)>-1||t&&t.toLowerCase().indexOf(a)>-1}}r()(dt,"contextType",o.a),r()(dt,"defaultProps",{conversationIds:[],isSecondaryInbox:!1,isTertiaryInbox:!1,withDmSearch:!1});const ht=ge.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,flexGrow:1},searchInput:{backgroundColor:e.colors.cellBackground,borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:"1px",padding:e.spaces.space12,zIndex:1}})));t.a=dt}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.DMDrawer.342236b5.js.map