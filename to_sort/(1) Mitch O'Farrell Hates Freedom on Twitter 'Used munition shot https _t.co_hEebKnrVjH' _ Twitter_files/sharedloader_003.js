(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+0pD":function(e,t){var i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function s(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function n(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=i?s:n).supported=s,t.unsupported=n},"06eB":function(e,t,i){var s=Array.prototype.slice,n=i("kgfz"),r=i("+0pD"),a=e.exports=function(e,t,i){return i||(i={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?i.strict?e===t:e==t:function(e,t,i){var l,d;if(o(e)||o(t))return!1;if(e.prototype!==t.prototype)return!1;if(r(e))return!!r(t)&&(e=s.call(e),t=s.call(t),a(e,t,i));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(l=0;l<e.length;l++)if(e[l]!==t[l])return!1;return!0}try{var h=n(e),p=n(t)}catch(e){return!1}if(h.length!=p.length)return!1;for(h.sort(),p.sort(),l=h.length-1;l>=0;l--)if(h[l]!=p[l])return!1;for(l=h.length-1;l>=0;l--)if(d=h[l],!a(e[d],t[d],i))return!1;return typeof e==typeof t}(e,t,i))};function o(e){return null==e}function c(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}},"180P":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));const s=e=>{const t=(JSON.stringify(e)||"").split("");t.sort();const i=t.join("");return n(i,0).toString()},n=(e,t)=>{const i="string"==typeof e?e:String(e);let s=t;for(let e=0;e<i.length;e++){s=(s<<5)-s+i.charCodeAt(e),s&=s}return s}},"33Kz":function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));i("kYxP");const s=e=>e.getArrayValue("dm_reactions_config_active_reactions"),n=e=>{const t=e.getArrayValue("dm_reactions_config_inactive_reactions");return[...s(e),...t]},r=(e,t)=>{const i=n(t).find((t=>t.endsWith(e)));if(i)return i.split(":")[0]},a=(e,t={includeInactive:!1})=>t.includeInactive?n(e).map((e=>e.split(":")[1])):s(e).map((e=>e.split(":")[1]))},"64vW":function(e,t,i){"use strict";var s=i("ERkP");const n=s.createContext({heightsReady:!0});t.a=n},"883S":function(e,t,i){"use strict";i.d(t,"a",(function(){return v})),i.d(t,"b",(function(){return y}));var s=i("k49u"),n=i("3XMw"),r=i.n(n),a=i("fs1G");const o=r.a.c3752568,c=r.a.f9690dc0,l=r.a.i859a9d3,d=r.a.b1d35407,h=r.a.g539cca6,p=r.a.bbac0019,u=r.a.a1d2a68d,m=r.a.d4f2d9d8,f=r.a.hf383be4,g=r.a.b25c5b2a,b=r.a.c4fdbd16,_=r.a.hf3e7e38,v={[s.a.DirectMessageConversationNotFound]:{customAction:()=>!1}},y={defaultToast:{text:o},[s.a.CurrentUserSuspended]:{toast:{text:h,action:{label:l,link:"https://support.twitter.com/articles/15790"}}},[s.a.DirectMessageCannotDmOtherUser]:{toast:{text:c}},[s.a.DirectMessageDuplicate]:{toast:{text:g}},[s.a.DirectMessageOtherUserNotFollowing]:{toast:{text:u,action:{label:l,link:"https://support.twitter.com/articles/14606"}}},[s.a.DirectMessagesSenderBlocksRecipient]:{toast:{text:b}},[s.a.DirectMessageTooLongError]:{toast:{text:p}},[s.a.DirectMessageTweetNotFound]:{toast:{text:m}},[s.a.GenericBadRequest]:{customAction:a.a},[s.a.MessageSendError]:{toast:{text:_}},[s.a.OverStatusUpdateLimit]:{toast:{action:{label:l,link:"https://support.twitter.com/articles/15364"},text:d}},[s.a.TargetUserNotFound]:{toast:{text:f}},showToast:!0}},"8Clt":function(e,t){},A9rn:function(e,t,i){"use strict";const s={...i("IRWI").a,pinToTopWhenAtTop:!0};t.a=s},AQOc:function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d}));i("kYxP");var s=i("lnti"),n=i("aWyx");const r={entries:{},entryIdsByConversationId:{},reactionsByMessageId:{}},a=(e=[],t={})=>e.map((e=>{if(e.proof_type===n.d.MUTUAL_FRIENDS){const{users:i,...n}=e;return{...n,users:Object(s.a)(i.map((e=>t[e])))}}return e})),o=(e=[],t={})=>e.reduce(((e,i)=>{const s=i.user_id,n=t[s]||{id_str:s};return e[s]={...i,user:n},e}),{}),c=(e,{entries:t,entryIdsByConversationId:i})=>(i[e]||[]).map((e=>t[e]&&t[e].data)).filter(Boolean),l=(e,t=r,i)=>{const{conversation_id:s,participants:n,...a}=e;return{conversation_id:s,...a,entries:t.entryIdsByConversationId[s]||[],participants:o(n,i)}},d=(e,t,i)=>{const{conversation_id:s,participants:n,social_proof:r,...l}=e;return{conversation_id:s,...l,entries:c(s,t),participants:o(n,i),...r?{social_proof:a(r,i)}:{}}}},GSsg:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("B5iK");class n{constructor(e,t=Object.freeze({})){const{interval:i=6e4,burstInterval:n=3e3,burstDuration:r=3e5}=t;this.pollTimer=new s.b(i).interval(e),this.burstTimer=new s.a(this.pollTimer,n,r)}start(e){return this.pollTimer.start(),e&&this.burstTimer.requestBurst(),this}stop(){return this.burstTimer.stopBurst(),this.pollTimer.stop(),this}restart(){return this.stop(),this.start(),this}}},H4nC:function(e,t,i){"use strict";var s=i("ERkP"),n=i("3XMw"),r=i.n(n),a=i("MWbm"),o=i("rHpw"),c=i("t62R");const l=o.a.create((e=>({root:{paddingBottom:e.spaces.space20}}))),d=r.a.d84b485d,h=r.a.be0c83d7;t.a=({entry:e,isCompact:t})=>{const i="follow"===e.reason?d:h;return t?s.createElement(c.c,{color:"gray600"},i):s.createElement(a.a,{style:l.root},s.createElement(c.c,{align:"center",color:"gray600",size:"small"},i))}},"I2k/":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i("k49u"),n=i("lRnM"),r=i("LVU8");const a=e=>({[s.a.ClientNotPermitted]:{customAction:()=>(Object(r.d)("/messages",{statusCode:401}),Object(n.t)(e))}})},J2UM:function(e,t,i){"use strict";var s=i("0JOx");t.a=()=>Object(s.h)().then((({inputDetect:e})=>e))},LKEN:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return d}));i("kYxP");var s=i("3XMw"),n=i.n(s);function r(e,t){for(let i=0;i<t.sizes.length;i++){const s=t.sizes[i];if(s.size_type===e)return s}const[i]=t.sizes;return i}const a=n.a.b5f47214,o=n.a.e860eb38,c=n.a.bb881af8,l=n.a.f3b17c72;function d(e,t){const i=null==e?void 0:e.actions.some((e=>null==e?void 0:e.is_pivot));if(e){const t=e.actions.find((e=>"view"===e.type)),s=e.actions.find((e=>"url"===e.type));return{buttonLabel:(null==t?void 0:t.message)||l,mainCopy:e.text,pivotCopy:null==s?void 0:s.message,pivotLink:null==s?void 0:s.url,withAdditionalPivotStyling:i}}return{buttonLabel:l,mainCopy:t?c:o,pivotCopy:a,pivotLink:"https://twitter.com/settings/content_you_see",withAdditionalPivotStyling:i}}},Lqdf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));i("Resy");var s=Object.freeze({MOVEMENT:"movement",LIST_UPDATE:"list_update",INITIAL_POSITION:"initial_position"});const n={nearTop:e=>(t,i)=>i.getTop()-t.getTop()<=e,nearBottom:e=>(t,i)=>t.getBottom()-i.getBottom()<=e,nearTopRatio:e=>(t,i)=>{const s=i.getHeight()*e;return i.getTop()-t.getTop()<=s},nearBottomRatio:e=>(t,i)=>{const s=i.getHeight()*e;return t.getBottom()-i.getBottom()<=s}},r=Object.freeze({INSIDE:"inside",OUTSIDE:"outside"}),a=(e,t,i,n)=>((e,t)=>!e&&t===r.INSIDE)(e,i)?s.INITIAL_POSITION:((e,t)=>e===r.OUTSIDE&&t===r.INSIDE)(e,i)?s.MOVEMENT:((e,t)=>e===r.INSIDE&&t===r.INSIDE)(e,i)&&n!==t?s.LIST_UPDATE:null;class o{constructor(e){this._handlers=e.map((e=>({zone:e,state:{}})))}handlePositioningUpdate(e){this._handlers.forEach((({zone:t,state:i})=>{const{condition:s,callback:n}=t,{proximity:o,listLength:c}=i,l=((e,t)=>e(t.getForList(),t.getForViewport())?r.INSIDE:r.OUTSIDE)(s,e),d=e.getListLength(),h=a(o,c,l,d);i.proximity=l,i.listLength=d,h&&n({triggerCause:h})}))}}},MMRb:function(e,t,i){"use strict";i.r(t);var s=i("9OUN"),n=i("lRnM"),r=i("uKEd"),a=i("AQ79");i.d(t,"GLOBAL_STATE_KEY",(function(){return a.a}));var o=i("xPna"),c=i("Ssj5"),l=i("xCUF"),d=i("aWyx");i.d(t,"CONVERSATION_TYPE",(function(){return d.a})),i.d(t,"ENTRY_TYPE",(function(){return d.b})),i.d(t,"PAGINATION_STATUS",(function(){return d.c})),i.d(t,"addParticipants",(function(){return n.d})),i.d(t,"selectConversation",(function(){return n.u})),i.d(t,"selectConversationAvatarMediaId",(function(){return n.v})),i.d(t,"selectConversationFetchStatus",(function(){return n.y})),i.d(t,"selectConversationIsLoaded",(function(){return n.z})),i.d(t,"selectConversationIsRead",(function(){return n.A})),i.d(t,"selectConversationAvatarMediaIsUploading",(function(){return n.w})),i.d(t,"selectConversationAvatarMediaUploadProgress",(function(){return n.x})),i.d(t,"selectConversations",(function(){return n.C})),i.d(t,"selectHasConversations",(function(){return n.D})),i.d(t,"selectEntries",(function(){return r.l})),i.d(t,"selectEntriesForConversation",(function(){return r.m})),i.d(t,"selectEntry",(function(){return r.n})),i.d(t,"selectConversationIdsByInbox",(function(){return o.n})),i.d(t,"selectFetchStatus",(function(){return o.q})),i.d(t,"selectInboxIsLoaded",(function(){return o.r})),i.d(t,"selectIsLoadingTop",(function(){return o.s})),i.d(t,"selectUnreadCount",(function(){return o.u})),i.d(t,"selectUntrustedCursor",(function(){return o.w})),i.d(t,"selectUntrustedUnreadCount",(function(){return o.z})),i.d(t,"selectUntrustedConversationCount",(function(){return o.v})),i.d(t,"selectUntrustedLowQualityCursor",(function(){return o.y})),i.d(t,"selectUntrustedLowQualityConversationCount",(function(){return o.x})),i.d(t,"selectPoppedOutConversationId",(function(){return o.t})),i.d(t,"selectDrawerVisibility",(function(){return o.p})),i.d(t,"selectDrawerExperimentEnabled",(function(){return o.o})),i.d(t,"selectUpdates",(function(){return l.e})),i.d(t,"acceptConversation",(function(){return n.a})),i.d(t,"addAvatarMedia",(function(){return n.b})),i.d(t,"addWelcomeMessageToConversation",(function(){return n.e})),i.d(t,"disableMentionNotifications",(function(){return n.g})),i.d(t,"disableNotifications",(function(){return n.h})),i.d(t,"enableMentionNotifications",(function(){return n.i})),i.d(t,"enableNotifications",(function(){return n.j})),i.d(t,"fetchConversation",(function(){return n.k})),i.d(t,"fetchConversationFromParticipants",(function(){return n.l})),i.d(t,"fetchConversationIfNeeded",(function(){return n.n})),i.d(t,"fetchConversationHistory",(function(){return n.m})),i.d(t,"leaveConversation",(function(){return n.o})),i.d(t,"markAllAsRead",(function(){return n.p})),i.d(t,"markConversationRead",(function(){return n.q})),i.d(t,"muteDMUser",(function(){return n.r})),i.d(t,"unmuteDMUser",(function(){return n.G})),i.d(t,"removeAvatarMedia",(function(){return n.s})),i.d(t,"removeConversation",(function(){return n.t})),i.d(t,"setConversationAvatar",(function(){return n.E})),i.d(t,"toggleNotifications",(function(){return n.F})),i.d(t,"updateConversationReadState",(function(){return n.L})),i.d(t,"updateConversationAvatar",(function(){return n.H})),i.d(t,"updateConversationName",(function(){return n.J})),i.d(t,"updateTyping",(function(){return n.M})),i.d(t,"fetchInbox",(function(){return o.e})),i.d(t,"fetchInboxIfNeeded",(function(){return o.f})),i.d(t,"fetchTrustedInboxHistory",(function(){return o.g})),i.d(t,"fetchUntrustedInboxHistory",(function(){return o.h})),i.d(t,"fetchUntrustedLowQualityInboxHistory",(function(){return o.i})),i.d(t,"updateLastSeenEventId",(function(){return o.C})),i.d(t,"updateTrustedLastSeenEventId",(function(){return o.D})),i.d(t,"updateUntrustedLastSeenEventId",(function(){return o.E})),i.d(t,"popOutConversation",(function(){return o.m})),i.d(t,"setDrawerVisibility",(function(){return o.B})),i.d(t,"loadDrawerVisibilityFromPersistence",(function(){return o.l})),i.d(t,"setDrawerExperimentEnabled",(function(){return o.A})),i.d(t,"loadDrawerExperimentFromPersistence",(function(){return o.k})),i.d(t,"deleteEntry",(function(){return r.f})),i.d(t,"markSpamStatus",(function(){return r.h})),i.d(t,"removeEntry",(function(){return r.j})),i.d(t,"fetchUpdates",(function(){return l.b})),i.d(t,"fetchUpdatesIfNeeded",(function(){return l.d}));const h=Object(s.c)({conversations:n.f,entries:r.e,inbox:o.d,updates:l.a});c.a.register({[a.a]:h}),t.default=h},OhSZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));i("kYxP");var s=i("ERkP"),n=i("aWyx"),r=i("XnpN"),a=i("jV+4"),o=i("t62R"),c=i("p9G8");const l=(e=[])=>e.map((({data:e})=>e)),d=({conversation:e,newConversationParticipants:t,perspective:i})=>{if(e){if(e.type===n.a.ONE_TO_ONE){const[t]=Object(r.a)(e,i).map((({user:e})=>e));return t.name}return Object(c.a)(e,i)}{const e=l(t);return Object(c.b)(e,i)}};t.b=({conversation:e,newConversationParticipants:t,perspective:i,titleWeight:d="bold",textColor:h="normal",withScreenName:p=!0})=>{if(e){if(e.type===n.a.ONE_TO_ONE){const[t]=Object(r.a)(e,i).map((({user:e})=>e));return s.createElement(a.a,{color:h,isProtected:t.protected,isVerified:t.verified,name:t.name,screenName:t.screen_name,weight:d,withLink:!1,withScreenName:p})}return s.createElement(o.c,{color:h,numberOfLines:1,weight:d},Object(c.a)(e,i))}{const e=l(t);return s.createElement(o.c,{color:h,numberOfLines:1,weight:d},Object(c.b)(e,i))}}},Oi4X:function(e,t,i){"use strict";var s=i("KEM+"),n=i.n(s),r=(i("Qavd"),i("MvUL"),i("kYxP"),i("ERkP")),a=i("0JOx"),o=i("v6aA"),c=i("zh9S"),l=i("MMRb"),d=i("VnFT"),h=i("RqPI"),p=i("1YZw"),u=i("oEGd"),m=i("0KEI"),f=i("hqKg"),g=i("kGix"),b=i("Myq3"),_=i("AQOc"),v=i("UhuB"),y=i("pNZL"),E=i("G6rE"),S=i("P1r1"),C=i("X/yg");const R=(e,t)=>t.conversationId,w=Object(f.createSelector)(l.selectFetchStatus,((e,t)=>l.selectConversationFetchStatus(e,R(0,t))),((e,t)=>e===g.a.LOADED?t:e)),A=Object(f.createSelector)(((e,t)=>l.selectEntriesForConversation(e,R(0,t))),h.h,((e,t)=>t?((e,t)=>{const i=Object(b.a)(e,(e=>!!e.message_data&&e.message_data&&e.message_data.recipient_id===t));return i&&i.message_data&&i.message_data.quick_reply&&i.message_data.quick_reply&&"options"===i.message_data.quick_reply.type?i.message_data.quick_reply:void 0})(e,t):void 0)),x=Object(f.createSelector)(((e,t)=>l.selectConversation(e,R(0,t))),l.selectEntries,C.f,h.h,C.g,C.h,E.e.selectAll,w,((e,t)=>l.selectConversationIsLoaded(e,R(0,t))),((e,t)=>d.g(e,R(0,t))),((e,t)=>d.j(e,R(0,t))),((e,t)=>d.i(e,R(0,t))),((e,t)=>d.k(e,R(0,t))),((e,t)=>d.l(e,R(0,t))),((e,t)=>d.h(e,R(0,t))),((e,t)=>d.m(e,R(0,t))),S.j,v.l,A,S.m,((e,t,i,s,n,r,a,o,c,l,d,h,p,u,m,f,g,b,v,y)=>{const E=e&&e.data;return{conversation:E&&Object(_.a)(E,t,a),dataSaverMode:g,draftText:f,dtabBarInfo:y,fetchStatus:o,gifMetadata:m,isDmReceiptSettingEnabled:b,isLoaded:c,cardUrl:l,isNewGroupConversation:i,isUploading:d,media:h,mediaMetadata:p,mediaUploadProgress:u,newConversationParticipants:n,perspective:s,quickReplyOptions:v,tweetAttachment:r}})),I=e=>()=>d.b(e),T=e=>t=>d.c(e,t);var M=Object(u.d)(x,(e=>{return{acceptConversation:l.acceptConversation,addMedia:(t=e.conversationId,(e,i)=>d.a(t,e,i)),saveText:d.f,addToast:p.b,addWelcomeMessageToConversation:l.addWelcomeMessageToConversation,cancelUpload:I(e.conversationId),createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:l.fetchConversationHistory,fetchConversationIfNeeded:l.fetchConversationIfNeeded,fetchInboxIfNeeded:l.fetchInboxIfNeeded,fetchUpdatesIfNeeded:l.fetchUpdatesIfNeeded,googleAnalyticsPageView:c.a,leaveConversation:l.leaveConversation,removeMedia:T(e.conversationId),removeText:d.d,scribeAction:c.c,scribePageImpression:c.d,sendMessage:d.n,updateConversationReadState:l.updateConversationReadState,updateTweetDetailNav:y.b,updateTyping:l.updateTyping,removeConversation:l.removeConversation,popOutConversation:l.popOutConversation};var t})),O=i("7JQg"),k=i("I2k/"),L=i("n+Zb"),D=i("6/0d"),P=i("IRWI"),F=i("VPAj");const B=(e,t)=>e.getForItem(t).doesIntersectWith(e.getForViewport()),N=e=>e.getForList().getBottom()-e.getForViewport().getBottom();var U=({isOwnMessage:e,typingIndicatorId:t})=>{const i=e=>Object(b.a)(e.getList(),(e=>e.id!==t));return{...P.a,initialScrollHeadroom:Object(F.a)(0),scrollHeadroom:Object(F.a)(0),offsetCorrection:(s,n)=>{const r=s.getForViewport().getBottom(),a=s.getForList().getBottom(),o=r>=a||Math.abs(r-a)<=2,c=i(s),l=i(n),d=N(s),h=N(n),p=l&&(!c||c.id!==l.id),u=l&&e(l.data.data),m=c&&B(s,c.id),f=!p&&h>d;return p&&(u||m)||m&&((e,i)=>{const s=e.getForItem(t),n=i.getForItem(t);return!s||n&&n.getHeight()>s.getHeight()})(s,n)||o&&f?Math.max(0,N(n)):P.a.offsetCorrection(s,n)}}},j=i("aWyx");const H=(e,t)=>({entry:{id:t,time:"",type:e},isActive:!1,isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1,type:e}),W=H(j.b.CONVERSATION_PROFILE_INFO_HEADER,"conversationProfileInfoHeader"),z="typingIndicator",V=H(j.b.TYPING_INDICATOR,z),q=H(j.b.READ_ONLY_INDICATOR,"readOnlyIndicator");var G=i("b9JY");var Q=(e,t)=>{if(e&&e.message_data&&t&&t.message_data&&Object(G.b)(e)&&Object(G.b)(t)){const{sender_id:i,time:s}=e.message_data,{sender_id:n,time:r}=t.message_data,a=parseInt(r,10)-parseInt(s,10);return i===n&&a>=0&&a<=6e4}return!1},K=i("jat/"),$=i("XnpN"),Y=i("LhSm"),X=i("I4+6"),J=i("rHpw"),Z=i("PbQQ"),ee=i("cm6r"),te=i("jV+4"),ie=i("pBrB"),se=i("wCd/");const ne=(e,t)=>{const i=Object($.a)(e,t).map((({user:e})=>e)),s=i&&i[0];return{userDescription:s.description,userEntities:s.entities,userWithheldDescription:s.withheld_description,userWithheldEntities:s.withheld_entities,userFollowerCount:s&&s.followers_count,userFriendsCount:s&&s.friends_count,userIdStr:s&&s.id_str,userJoinDate:s&&s.created_at,userName:s&&s.name,userScreenName:s&&s.screen_name,userIsVerified:s&&s.verified}},re=J.a.create((e=>({root:{flexDirection:"column",alignItems:"center",marginBottom:e.spaces.space16,paddingVertical:e.spaces.space20,paddingHorizontal:e.spaces.space16,borderRadius:e.borderRadii.xSmall},profileInfoItemMargin:{marginBottom:e.spaces.space4},borderBottom:{borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid"},description:{width:"100%",textAlign:"center"}})));var ae=({conversation:e,withBottomBorder:t=!0})=>{const{loggedInUserId:i}=r.useContext(o.a);if(!e)return null;const{userDescription:s,userWithheldDescription:n,userEntities:a,userWithheldEntities:c,userFollowerCount:l,userFriendsCount:d,userIdStr:h,userJoinDate:p,userName:u,userScreenName:m,userIsVerified:f}=ne(e,i||""),g=!!(u&&m&&(l&&d||p)),b=X.a.generate({color:J.a.theme.colors.text,backgroundColor:J.a.theme.colors.transparent,customFocusBackgroundColor:J.a.theme.colors.gray0,customHoverBackgroundColor:J.a.theme.colors.gray0,customPressedBackgroundColor:J.a.theme.colors.activeFaintGray});return r.createElement(Z.b.Consumer,null,(e=>r.createElement(ee.a,{interactiveStyles:b,link:e.withAnchorless(`https://twitter.com/${m||""}`),style:[re.root,t&&g&&re.borderBottom]},r.createElement(te.a,{isVerified:f,name:u,screenName:m,style:re.profileInfoItemMargin,weight:"bold",withHoverCard:!0,withLink:!0}),s&&a&&h?r.createElement(ie.a,{description:s,entities:a,style:[re.profileInfoItemMargin,re.description],userId:h,withheldDescription:n,withheldEntities:c}):null,l&&d?r.createElement(se.a,{followersCount:l,friendsCount:d,screenName:m||"",style:re.profileInfoItemMargin,withLink:!1}):null,p?r.createElement(Y.a,{joinDate:p}):null)))},oe=i("g54k"),ce=i("aA19"),le=i("mN6z"),de=i("MWbm"),he=i("t62R"),pe=i("oSwX"),ue=i("MAI/"),me=i("zQEV");const fe=({children:e,link:t,style:i})=>r.createElement(he.c,{align:"center",color:"gray600",link:t,size:"small",style:i},e);class ge extends r.Component{constructor(...e){super(...e),n()(this,"_renderContents",(()=>{const{conversation:e,entry:t,entryType:i,perspective:s,users:n}=this.props,a=Object(me.a)(t,i,s,n);switch(i){case j.b.CONVERSATION_AVATAR_UPDATE:return r.createElement(r.Fragment,null,this._isValidImageSource(t.conversation_avatar_image_https)?r.createElement(de.a,{style:be.conversationAvatarContainer},r.createElement(ce.a,{conversation:e,perspective:s})):null,r.createElement(fe,null,a));case j.b.JOIN_CONVERSATION:{const e=this._getAddedYouMessageWithProfileInfo(a),t=this._getParticipantsFromEntry(),i=r.createElement(he.c,{align:"center",color:"gray600",size:"small"},this._getParticipantsFromEntryText(t)),s=this._getJoinConversationDetailsWithFacepile(t,i);return r.createElement(r.Fragment,null,e,s)}default:return r.createElement(fe,null,a)}})),n()(this,"_getAddedYouMessageWithProfileInfo",(e=>{const{entry:t,users:i}=this.props,s=t.sender_id?i[t.sender_id]:void 0,n=s?{pathname:`https://twitter.com/${s.screen_name}`}:void 0;return r.createElement(ee.a,{interactiveStyles:null,link:n,style:be.userAddedYouContainer},s?r.createElement(pe.default,{accessibilityLabel:s.screen_name,screenName:s.screen_name,size:"medium",uri:s.profile_image_url_https,withHoverCard:!0,withLink:!0}):null,r.createElement(fe,{link:n,style:be.userAddedYouText},e))})),n()(this,"_getJoinConversationDetailsWithFacepile",((e,t)=>{const{conversation:i}=this.props,s=e.slice(0,20).map((({profile_image_url_https:e})=>e));return r.createElement(ee.a,{interactiveStyles:null,link:{pathname:`/messages/${i.conversation_id}/participants`},style:be.joinConversationDetails},t,r.createElement(ue.a,{style:be.userAvatarFacepile,userAvatarSize:"xLarge",userAvatarUrls:s}))}))}shouldComponentUpdate(e){return!Object(le.a)(this.props,e)}render(){return r.createElement(de.a,{style:be.root},this._renderContents())}_isValidImageSource(e){return e&&""!==e&&e.indexOf("MEDIA_NOT_FOUND")<0}_getParticipantsFromEntry(){const{entry:e,perspective:t,users:i}=this.props;return e.participants?e.participants.filter((({user_id:e})=>t!==e)).map((({user_id:e})=>i[e])).filter(Boolean):[]}_getParticipantsFromEntryText(e){const{conversation:{conversation_id:t}}=this.props;return Object(me.b)(e.length,t)}}const be=J.a.create((e=>({root:{paddingBottom:e.spaces.space20},conversationAvatarContainer:{alignSelf:"center",height:e.spaces.space64,marginBottom:e.spaces.space12,width:e.spaces.space64},userAddedYouContainer:{flexDirection:"row",justifyContent:"center"},userAddedYouText:{flexShrink:1,marginLeft:e.spaces.space12},joinConversationDetails:{marginTop:e.spaces.space4},userAvatarList:{marginTop:e.spaces.space4},userAvatarFacepile:{marginTop:e.spaces.space4,justifyContent:"center"}})));var _e=Object(oe.a)(ge),ve=i("oQhu");var ye=Object(ve.a)((function(e){const t=J.a.theme.spacesPx.space40;return{DMUserAvatarSizeType:"xLarge",DMUserAvatarSizePx:t,DMUserAvatarSpacerPx:t+J.a.theme.spacesPx.space12}})),Ee=i("shC7"),Se=i("38/B");const Ce=function(e){return Re(e,Se.a.reducedMotionEnabled)},Re=Object(ve.a)((function(e,t){const i=function(){const{DMUserAvatarSizePx:e,DMUserAvatarSpacerPx:t}=ye(J.a.theme.scale),i=xe[J.a.theme.scale],s=we/i,n=Ae/e,r=Ae/2,a=Ae-r,o=Ae-r-t;return{cssTransition:Se.a.reducedMotionEnabled?{}:{transition:`transform ${Te}, opacity ${Te}`},messageContainer:{base:{transform:[{translateX:0}]},active:{sent:{transform:[{translateX:(Ee.a.isRTL?1:-1)*a}]},received:{transform:[{translateX:(Ee.a.isRTL?-1:1)*o}]}}},actionsContainer:{base:{transform:[{translateX:0}]},active:{sent:{transform:[{translateX:(Ee.a.isRTL?1:-1)*Ie[J.a.theme.scale]}]},received:{transform:[{translateX:(Ee.a.isRTL?-1:1)*(Ie[J.a.theme.scale]+o)-r}]}}},voiceMessage:{container:{base:{height:i},active:{height:we}},base:{height:i,transform:[{scale:1}]},active:{base:{transform:[{scale:s}]},sent:{paddingRight:r/s,transformOrigin:Ee.a.isRTL?"bottom left":"bottom right"},received:{paddingLeft:r/s,transformOrigin:Ee.a.isRTL?"bottom right":"bottom left"}}},userAvatar:{base:{transform:[{scale:1}]},sent:{transformOrigin:Ee.a.isRTL?"bottom left":"bottom right"},received:{transformOrigin:Ee.a.isRTL?"bottom right":"bottom left"},active:{opacity:1,pointerEvents:"all",transform:[{scale:n}]},visuallyHidden:{opacity:0,pointerEvents:"none"}}}}();return{actionsContainer:function({isSent:e,isVoiceMessageActive:t}){const s=[i.cssTransition,i.actionsContainer.base];return t&&s.push(e?i.actionsContainer.active.sent:i.actionsContainer.active.received),s},messageContainer:function({isSent:e,isVoiceMessageActive:t}){const s=[i.cssTransition,i.messageContainer.base];return t&&s.push(e?i.messageContainer.active.sent:i.messageContainer.active.received),s},voiceMessageContainer:function({isSent:e,isVoiceMessageActive:t}){const s=[i.cssTransition,i.voiceMessage.container.base];return t&&s.push(i.voiceMessage.container.active),s},voiceMessage:function({isSent:e,isVoiceMessageActive:t}){const s=[i.cssTransition,i.voiceMessage.base];return t&&(s.push(i.voiceMessage.active.base),s.push(e?i.voiceMessage.active.sent:i.voiceMessage.active.received)),s},userAvatar:function({isSent:e,isVoiceMessageActive:t}){const s=[i.cssTransition,i.userAvatar.base,e?i.userAvatar.sent:i.userAvatar.received];return t?s.push(i.userAvatar.active):e&&s.push(i.userAvatar.visuallyHidden),s}}}));const we=60,Ae=we,xe={xSmall:42,small:42,normal:47,large:47,xLarge:47},Ie={xSmall:72.26,small:165.61-89.3,normal:158.22-94.4,large:166.64-100.58,xLarge:181.55-111.81},Te="0.2s 0s ease-in-out",Me={scribeAction:c.c},Oe=Object(f.createSelector)(((e,t)=>E.e.select(e,t.senderId)),S.k,S.p,((e,t,i)=>({user:e,displaySensitiveMedia:t,isDmNsfwMediaFilterEnabled:i})));var ke=Object(u.g)(Oe,Me);const Le={addToast:p.b,createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_OVERFLOW_ACTIONS"),deleteEntry:l.deleteEntry};var De=Object(u.b)(Le),Pe=i("k49u"),Fe=i("LVU8"),Be=i("3XMw"),Ne=i.n(Be);const Ue=Ne.a.f58dff33,je=Ne.a.ad5a8e8e,He={[Pe.a.MissingParameter]:{toast:Object(Fe.a)(Ue)},[Pe.a.DirectMessageDestroyPermissionsError]:{toast:{text:je}},showToast:!0};var We=i("V/6K"),ze=i("xCUF"),Ve=i("uKEd");const qe=[],Ge=Object(f.createSelector)((e=>Object(Ve.l)(e).entries),((e,t)=>Object(Ve.p)(e,t.entry.id)||qe),((e,t)=>t.perspective),((e,t,i)=>({selectedReactions:t.filter((t=>{const s=e[t]&&e[t].data;return s&&s.sender_id===i})).map((t=>e[t].data.reaction_key))}))),Qe={createReaction:Ve.d,createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_REACTIONS_POPOVER"),fetchUpdatesIfNeeded:ze.d,removeReaction:Ve.k};var Ke=Object(u.g)(Ge,Qe),$e=i("33Kz"),Ye=i("wTX1");var Xe=({accessible:e,accessibilityLabelFormatter:t,count:i,emojiSize:s,emotion:n,enableHoverStyle:a,onPress:c,style:l})=>{const{featureSwitches:d}=r.useContext(o.a),h=Object($e.b)(n,d),p=t&&h?t({emoji:h,count:i}):void 0,u=X.a.generate({backgroundColor:J.a.theme.colors.gray50,color:J.a.theme.colors.gray600});return r.createElement(ee.a,{accessibilityLabel:p,accessible:e,interactiveStyles:a?u:null,onPress:c,style:[Je.container,...l||[]]},r.createElement(he.c,{size:s,style:Je.unsetLineHeight},h),i?r.createElement(Ye.a,{color:"gray600",containerStyle:Je.count,count:i,size:"xSmall"},i):null)};const Je=J.a.create((e=>({container:{flexDirection:"row"},count:{alignSelf:"center",minWidth:e.spaces.space16,paddingLeft:e.spaces.space2},unsetLineHeight:{lineHeight:"unset"}})));var Ze=i("Irs7");const et=Ne.a.ca7a2214,tt=Ne.a.fc0e94b7;class it extends r.Component{constructor(...e){super(...e),n()(this,"_handleReactionScribing",((e,t)=>{const{analytics:i}=this.props,s=t?"delete_reaction":"create_reaction";i.scribe({section:"twitter_service",component:"direct_messages",element:s,action:"success",data:{reaction_emotion:e}})})),n()(this,"_reactionClickHandler",((e,t)=>()=>{const{createReaction:i,createLocalApiErrorHandler:s,dismiss:n,fetchUpdatesIfNeeded:r,removeReaction:a,entry:o,perspective:c}=this.props,l={reaction_key:e,conversation_id:o.conversation_id,dm_id:o.id,perspective:c};(t?a:i)(l).then(this._handleReactionScribing(e,t)).then((()=>r())).catch(s()),n()}))}render(){const{selectedReactions:e}=this.props,t=Object($e.a)(this.context.featureSwitches).map((t=>{const i=e.includes(t);return r.createElement(Xe,{accessibilityLabelFormatter:i?et:tt,accessible:!0,emojiSize:"xLarge",emotion:t,enableHoverStyle:!0,key:t,onPress:this._reactionClickHandler(t,i),style:[nt.reaction,i&&nt.selectedReaction]})}));return r.createElement(de.a,{style:nt.reactions},t)}}n()(it,"contextType",o.a);var st=Object(Ze.a)(Ke(it));const nt=J.a.create((e=>({reactions:{cursor:"pointer",flexDirection:"row",padding:e.spaces.space12},reaction:{borderRadius:e.borderRadii.small,padding:e.spaces.space4},selectedReaction:{backgroundColor:e.colors.gray50}})));var rt=i("OiMc");class at extends r.Component{constructor(...e){super(...e),n()(this,"_renderDMReactionPickerContent",(e=>{const{entry:t,perspective:i}=this.props;return r.createElement(st,{dismiss:e,entry:t,perspective:i})}))}render(){const{children:e,onDismiss:t}=this.props;return r.createElement(rt.a,{enableEnterKeyToggle:!0,onDismiss:t,preferredVerticalOrientation:"up",renderContent:this._renderDMReactionPickerContent,withArrow:!0,withFixedPosition:this.context.isDrawer},e)}}n()(at,"contextType",We.a);var ot=i("fz3c"),ct=i("mjJ+"),lt=i("Q0VY"),dt=i("eb3s"),ht=i("/yvb"),pt=i("ZToW"),ut=i("CaKu"),mt=i("i4Oy"),ft=i("4w6w");const gt=(e,t)=>{if(null==e)return!1;const[i,s]=t||[0,0];return!((0===i||1===i)&&e.length===s)},bt=e=>{const{message_data:t}=e;if(!t)return!1;const{attachment:i}=t;if(!i)return!0;if(i.sticker)return!1;const s=i.tweet||i.photo||i.animated_gif||i.video||void 0;if(s)return gt(t.text,s.indices);if(i.card){var n;const e=((null==(n=t.entities)?void 0:n.urls)||[]).find((e=>e.url===i.card));return gt(t.text,e&&e.indices)}return!0},_t=e=>{var t;const i=null==e||null==(t=e.message_data)?void 0:t.attachment;return!(!i||!(i.card||i.tweet||i.photo||i.animated_gif||i.video||i.fleet))},vt=e=>{var t;const i=null==e||null==(t=e.message_data)?void 0:t.attachment;return!(!i||!i.fleet)},yt=(e,t,i)=>{const s=1.25*J.a.theme.fontSizesPx.normal;return{compositeRendered:e?void 0!==t&&void 0!==i:void 0!==t,isTextSquared:void 0!==t&&void 0!==i&&(i===t||i<=t-s),isAttachmentSquared:void 0!==i&&void 0!==t&&(t===i||t<=i-s)}};var Et=i("hiGS"),St=i("zIWA"),Ct=i("Lsrn"),Rt=i("k/Ka");const wt=(e={})=>Object(Rt.a)("svg",{...e,style:[Ct.a.root,e.style],viewBox:"0 0 24 24"},r.createElement("g",null,r.createElement("path",{d:"M16.925 9.5H14.5V7.075c0-.414-.336-.75-.75-.75s-.75.336-.75.75V9.5h-2.425c-.414 0-.75.336-.75.75s.336.75.75.75H13v2.425c0 .414.336.75.75.75s.75-.336.75-.75V11h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-.3 11H4.25c-.413 0-.75-.337-.75-.75V8.402c0-.414-.336-.75-.75-.75s-.75.336-.75.75V19.75C2 20.99 3.01 22 4.25 22h12.375c.414 0 .75-.336.75-.75s-.336-.75-.75-.75z"}),r.createElement("path",{d:"M19.75 2h-12C6.51 2 5.5 3.01 5.5 4.25v12c0 1.24 1.01 2.25 2.25 2.25h12c1.24 0 2.25-1.01 2.25-2.25v-12C22 3.01 20.99 2 19.75 2zm.75 14.25c0 .413-.337.75-.75.75h-12c-.413 0-.75-.337-.75-.75v-12c0-.413.337-.75.75-.75h12c.413 0 .75.337.75.75v12z"})));wt.metadata={width:24,height:24};var At=wt;const xt=(e={})=>Object(Rt.a)("svg",{...e,style:[Ct.a.root,e.style],viewBox:"0 0 24 24"},r.createElement("g",null,r.createElement("path",{d:"M22.436 16.92H19.76v-2.673c0-.415-.335-.75-.75-.75s-.75.335-.75.75v2.674h-2.676c-.413 0-.75.337-.75.75s.337.75.75.75h2.677v2.677c0 .413.337.75.75.75s.75-.337.75-.75V18.42h2.676c.414 0 .75-.337.75-.75s-.336-.75-.75-.75z"}),r.createElement("path",{d:"M11.088 21.214c-2.61-.046-10.064-6.778-10.064-13.157 0-3.066 2.525-5.755 5.404-5.755 2.29 0 3.83 1.582 4.646 2.73.816-1.148 2.357-2.73 4.646-2.73 2.878 0 5.403 2.69 5.403 5.755 0 1.13-.232 2.323-.69 3.545-.145.39-.58.584-.966.44-.388-.146-.584-.58-.438-.966.394-1.053.594-2.07.594-3.02 0-2.266-1.824-4.254-3.903-4.254-2.525 0-3.94 2.937-3.952 2.966-.23.562-1.155.562-1.387 0-.01-.03-1.425-2.966-3.952-2.966-2.08 0-3.904 1.988-3.904 4.255 0 5.76 7.076 11.63 8.563 11.657.168-.003.764-.195 1.758-.892.343-.238.81-.154 1.045.184.237.34.155.808-.184 1.045-1.085.76-1.966 1.153-2.618 1.164z"})));xt.metadata={width:24,height:24};var It=xt,Tt=i("ACHU");const Mt=Ne.a.ba60339a,Ot=Ne.a.j4bfee22,kt=Ne.a.d96cf7cd,Lt=Ne.a.faddd3a2,Dt=Ne.a.eb497e08,Pt=Ne.a.b170974a,Ft=Ne.a.i202bd22,Bt=Ne.a.f2e5491a,Nt=Ne.a.f88553c8,Ut=Ne.a.cac14829,jt=Ne.a.h63a5c3b;class Ht extends r.Component{constructor(e,t){super(e,t),n()(this,"_renderOverflowMenu",(e=>{const{entry:t,isSent:i,analytics:s}=this.props,n=s.contextualScribeNamespace,a=[{text:Mt,Icon:Et.a,isEmphasized:!0,onClick:this._handleShowDeleteConfirmation(e)}];return i||a.push({text:Ft,Icon:St.a,link:{pathname:`/i/report/${ot.a.DMMessage}/${t.id}`,state:{clientReferer:window.location.pathname,conversationId:t.conversation_id,scribeNamespace:n}},onClick:this.props.onReportMessage}),ut.a.isAvailable()&&a.push({text:Bt,Icon:At,onClick:this._handleCopyMessageText}),r.createElement(ct.a,{isFixed:this.context.isDrawer,items:a,onCloseRequested:this._handleHideActionsAndMenus(e),preferredHorizontalOrientation:"right"})})),n()(this,"_handleCopyMessageText",(e=>{const{addToast:t}=this.props,i=this._replaceMessageUrls();i&&(ut.a.setString(i),t({text:Nt})),e&&e()})),n()(this,"_handleSetActionsActive",(()=>{const{setShouldFreezeUpdates:e}=this.props;this.setState({actionsAreActive:!0}),e(!0)})),n()(this,"_handleDelete",(()=>{const{createLocalApiErrorHandler:e,deleteEntry:t,entry:i}=this.props;t({conversationId:i.conversation_id,id:i.id}).catch(e(He))})),n()(this,"_handleHideDeleteConfirmation",(()=>{this.setState({showDeleteConfirmation:!1})})),n()(this,"_handleHideActionsAndMenus",(e=>()=>{const{setShouldFreezeUpdates:t}=this.props;e&&e(),this.setState({actionsAreActive:!1}),t(!1)})),n()(this,"_handlePressReactionPickerButton",(()=>{const{analytics:e,entry:t}=this.props;e.scribe({component:"reaction_button",element:Object(C.a)(t),action:"click"}),this._handleSetActionsActive()})),n()(this,"_handleShowDeleteConfirmation",(e=>()=>{const{setShouldFreezeUpdates:t}=this.props;e(),this.setState({actionsAreActive:!1,showDeleteConfirmation:!0}),t(!1)})),n()(this,"_replaceMessageUrls",(()=>{const{entry:e}=this.props,t=e&&e.message_data&&e.message_data.entities;let i=e&&e.message_data&&e.message_data.text||"";return lt.a.tweetTextParts(i,[0,i.length],t).forEach((e=>{"url"===e.entityType&&(i=i.replace(e.url,e.expandedUrl))})),i})),this.state={actionsAreActive:!1,showDeleteConfirmation:!1},this._hasMedia=_t(this.props.entry),this._isNarrow=mt.a.get("screen").width<J.a.theme.breakpoints.xSmall}render(){const{isSent:e,shouldShowReactionButton:t,style:i}=this.props,s=this._areActionsVisible();return r.createElement(de.a,{pointerEvents:s?"auto":"none",style:[zt.messageActions,e?zt.messageActionsLeft:zt.messageActionsRight,s?zt.visible:zt.invisible,this._isNarrow&&(this._hasMedia?zt.messageActionsMediaNarrow:zt.messageActionsNarrow),i]},t&&this._renderReactionButton(),this._renderOverflowButton(),this._renderDeleteConfirmation())}_renderDeleteConfirmation(){return this.state.showDeleteConfirmation?r.createElement(dt.a,{confirmButtonLabel:kt,confirmButtonType:"destructive",headline:Ot,onCancel:this._handleHideDeleteConfirmation,onConfirm:this._handleDelete,text:Lt}):null}_renderReactionButton(){const{entry:e,perspective:t}=this.props,{actionsAreActive:i}=this.state;return r.createElement(at,{entry:e,onDismiss:this._handleHideActionsAndMenus(),perspective:t},r.createElement(ht.a,{accessibilityLabel:Pt,"aria-expanded":i?"true":"false","aria-haspopup":"true",hoverLabel:{label:Ut},icon:Vt,onPress:this._handlePressReactionPickerButton,size:this._isNarrow?"normalCompact":"normal",type:"text"}))}_renderOverflowButton(){return r.createElement(ht.a,{accessibilityLabel:Dt,hoverLabel:{label:jt},icon:qt,onPress:this._handleSetActionsActive,renderMenu:this._renderOverflowMenu,size:this._isNarrow?"normalCompact":"normal",type:"text"})}_areActionsVisible(){const{containerIsActive:e,containerIsFocused:t,containerIsHovered:i,isDraft:s}=this.props,{actionsAreActive:n}=this.state,r=(a=this.props.entry,!bt(a)&&_t(a)&&!pt.a.isEnabled);var a;return!s&&(r||e&&!pt.a.isEnabled||t||i||n)}}n()(Ht,"contextType",We.a);var Wt=Object(Ze.a)(De(Ht));const zt=J.a.create((e=>({invisible:{opacity:0},messageActions:{alignSelf:"flex-end",flexDirection:"row"},messageActionsMediaNarrow:{flexDirection:"column"},messageActionsNarrow:{flexShrink:1,flexWrap:"wrap",minWidth:e.spaces.space32},messageActionsLeft:{justifyContent:"flex-end",paddingRight:e.spaces.space4},messageActionsRight:{justifyContent:"flex-start",paddingLeft:e.spaces.space4},actionIcon:{color:e.colors.gray600},visible:{opacity:1}}))),Vt=r.createElement(It,{style:zt.actionIcon}),qt=r.createElement(Tt.a,{style:zt.actionIcon});var Gt=i("97Jx"),Qt=i.n(Gt),Kt=i("uDfI");const $t={createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_CONVERSATION"),removeEntry:l.removeEntry,sendMessage:d.n};var Yt=Object(Kt.b)(null,$t);const Xt="87.5%";var Jt=i("wrlS");const Zt=[],ei=(e,t)=>Object(Ve.p)(e,t.entryId)||Zt,ti=e=>Object(Ve.l)(e).entries,ii={createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_REACTIONS")};var si=Object(u.e)((()=>Object(f.createSelector)(ti,ei,h.h,Jt.c,((e,t,i,s)=>{const n=Object($e.a)(s,{includeInactive:!0});let r,a=0;return{reactionsWithCounts:t.reduceRight(((t,s)=>{const o=e[s]&&e[s].data;if(!o)return t;if(!n.includes(o.reaction_key))return t;const c=(t.get(o.reaction_key)||0)+1;return t.set(o.reaction_key,c),(null==o?void 0:o.sender_id)===i&&(r=o.reaction_key),a+=1,t}),new Map),selectedReactionKey:r,totalReactionCount:a}}))),ii);const ni=[],ri=(e,t)=>t.entryId,ai=e=>Object(Ve.l)(e).entries,oi=(e,t)=>Object(Ve.p)(e,ri(0,t))||ni,ci=(e,t)=>E.e.selectMany(e,((e,t)=>Object(Ve.q)(e,ri(0,t)))(e,t)),li={removeReaction:Ve.k,fetchUpdatesIfNeeded:ze.d,createLocalApiErrorHandler:Object(m.d)("DIRECT_MESSAGES_REACTION_SUMMARY_CONTEXT")};var di=Object(u.e)((()=>Object(f.createSelector)(ai,oi,h.h,ci,Jt.c,((e,t,i,s,n)=>{const r=Object($e.a)(n,{includeInactive:!0}),a=[];t.forEach((t=>{const n=e[t]&&e[t].data;if(!(n&&r.includes(n.reaction_key)))return;const o=s.find((e=>e&&e.id_str===n.sender_id)),c=o&&{avatarUri:o.profile_image_url_https,userId:o.id_str,reactionKey:n.reaction_key,isLoggedInUser:o.id_str===i,screenName:o.screen_name,name:o.name,isProtected:o.protected,isVerified:o.verified,time:n.time};c&&a.push(c)})),a.sort(((e,t)=>t.time-e.time));const o=a.findIndex((e=>e.userId===i));return o>-1&&a.push(...a.splice(0,o)),{loggedInUserId:i,usersWithReactions:a}}))),li),hi=i("TIdA"),pi=i("htQn");const ui=Ne.a.gf5e9ea6,mi=Ne.a.a2d48778,fi=hi.a.createLayoutCache();const gi=J.a.create((e=>({bodyColumn:{flexShrink:1,flexGrow:1,justifyContent:"center",marginHorizontal:e.spaces.space4},body:{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},bottomBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small},column:{alignItems:"center",justifyContent:"center",marginRight:e.spaces.space4},reactionColumn:{alignItems:"center",justifyContent:"center",marginRight:e.componentDimensions.gutterHorizontal},root:{flexDirection:"row",minHeight:"56px",paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}})));var bi=function(e){const{featureSwitches:t}=r.useContext(o.a),{onUndoPress:i,user:s,renderUndo:n,withBottomBorder:a}=e,{avatarUri:c,name:l,screenName:d,isProtected:h,isVerified:p}=s,u=r.useMemo((()=>function(e){e.stopPropagation(),i()}),[i]),m=r.createElement(pe.default,{imageLayoutCache:fi,screenName:d,size:"xxLarge",uri:c}),f=r.createElement(Xe,{accessible:!1,emojiSize:"xLarge",emotion:s.reactionKey}),g=r.createElement(te.a,{badgeContext:"content",isProtected:h,isVerified:p,name:l,screenName:d,withHoverCard:!0,withStackedLayout:!0});return r.createElement(pi.a,{link:{pathname:`/${d}`,anchorless:!0},style:[gi.root,a&&gi.bottomBorder]},r.createElement(de.a,{style:gi.reactionColumn},f),r.createElement(de.a,{style:gi.column},m),r.createElement(de.a,{style:gi.bodyColumn},r.createElement(de.a,{style:gi.body},g)),n?r.createElement(de.a,{style:gi.column},r.createElement(ht.a,{accessibilityLabel:mi({emoji:Object($e.b)(s.reactionKey,t)}),onClick:u,size:"normalCompact",type:"text"},ui)):null)},_i=i("TnY3"),vi=i("xKuM"),yi=i("efqG");const Ei=Ne.a.b772cd65,Si=Ne.a.c0098d49,Ci=Ne.a.j85999eb;class Ri extends r.PureComponent{constructor(...e){super(...e),n()(this,"_renderContent",((e,t)=>r.createElement(de.a,null,this._renderHeader(e,t),this._renderUsers(e,t),this._renderDoneButton(e,t)))),n()(this,"_renderHeader",((e,t)=>"sheet"===t?r.createElement(vi.a,{title:Si,withBottomBorder:!0}):r.createElement(he.c,{visuallyHidden:!0},Si))),n()(this,"_renderUsers",((e,t)=>r.createElement(de.a,{accessibilityLabel:Ci,style:[wi.container,"sheet"===t?wi.sheet:wi.popover]},this._renderUserCells(e)))),n()(this,"_renderDoneButton",((e,t)=>"sheet"===t&&r.createElement(ht.a,{key:"button_done",onPress:e,style:wi.cancelButton,type:"neutral"},Ei))),n()(this,"_renderUserCells",(e=>this.props.usersWithReactions.filter(Boolean).map(((t,i)=>r.createElement(bi,{history:this.props.history,key:t.userId,onUndoPress:this._reactionUndoHandler(t.reactionKey,e),renderUndo:t.isLoggedInUser,user:t,withBottomBorder:i!==this.props.usersWithReactions.length-1}))))),n()(this,"_reactionUndoHandler",((e,t)=>()=>{const{conversationId:i,fetchUpdatesIfNeeded:s,createLocalApiErrorHandler:n,entryId:r,loggedInUserId:a,removeReaction:o}=this.props,c={reaction_key:e,conversation_id:i,dm_id:r,perspective:a};t(),o(c).then(this._handleScribeRemoveReaction(e)).then(s).catch(n())})),n()(this,"_handleScribeRemoveReaction",(e=>()=>{const{analytics:t}=this.props;t.scribe({page:"app",section:"twitter_service",component:"direct_messages",element:"delete_reaction",action:"success",data:{reaction_emotion:e}})}))}render(){const{children:e}=this.props;return r.createElement(yi.a,{renderContent:this._renderContent,withFixedPosition:this.context.isDrawer},e)}}n()(Ri,"contextType",We.a);const wi=J.a.create((e=>({cancelButton:{marginHorizontal:e.spaces.space12,marginVertical:e.spaces.space12},container:{overflowY:"auto",paddingVertical:e.spaces.space12},popover:{maxHeight:"35vh",minWidth:"320px"},sheet:{maxHeight:"65vh"}})));var Ai=Object(_i.a)(Object(Ze.a)(di(Ri)));const xi=Ne.a.h95f9e76;class Ii extends r.PureComponent{constructor(e){super(e),n()(this,"_handleScribeDMReactionSummary",(()=>{const{analytics:e}=this.props;e.scribe({component:"dm_reaction_summary",action:"show"})})),n()(this,"_onSetReactionsNode",(e=>{this._measureWidths(e||void 0)})),n()(this,"_renderReactions",(({isHovered:e})=>{const{reactionsWithCounts:t,selectedReactionKey:i}=this.props,s=this.state.emojiSize||"large",n=t.size-1;return Array.from(t,(([t,a],o)=>r.createElement(Xe,{accessible:!0,count:a,emojiSize:s,emotion:t,enableHoverStyle:!1,key:t,style:[o===n&&Ti.rightPadding,Ti.elementPadding,i===t?Ti.selfSelect:null,e&&Ti.isHoveredDMReaction]})))})),this.state={emojiSize:void 0}}render(){const{conversationId:e,entryId:t,isEndOfDM:i,isSent:s,totalReactionCount:n}=this.props,{emojiSize:a}=this.state;if(0===n)return null;const o=X.a.generate({backgroundColor:J.a.theme.colors.gray50,color:J.a.theme.colors.gray600}),c=xi({reactionCount:n});return r.createElement(de.a,{style:[Ti.container,i?Ti.marginShort:Ti.marginLong,s?Ti.alignRight:Ti.alignLeft,a?Ti.visible:Ti.invisible]},r.createElement(Ai,{conversationId:e,entryId:t},r.createElement(ee.a,{accessibilityLabel:c,accessible:!0,interactiveStyles:o,onPress:this._handleScribeDMReactionSummary,style:[Ti.content],viewRef:this._onSetReactionsNode},this._renderReactions)))}_measureWidths(e){const t=e&&e.parentElement,i={emojiSize:"large"};if(t){const{width:s}=t.getBoundingClientRect(),{width:n=0}=e?e.getBoundingClientRect():{};n>s&&(i.emojiSize="small")}this.setState({...i})}}const Ti=J.a.create((e=>({container:{boxSizing:"border-box"},content:{borderRadius:e.borderRadii.infinite,display:"flex",flexDirection:"row"},rightPadding:{paddingRight:e.spaces.space2},elementPadding:{borderColor:e.colors.transparent,borderWidth:e.borderWidths.small,paddingBottom:e.spaces.space2,paddingTop:e.spaces.space2,paddingLeft:`calc(${e.spaces.space2} * 2)`},selfSelect:{borderColor:J.a.theme.colors.gray50,borderRadius:e.borderRadii.infinite},alignLeft:{alignSelf:"flex-start"},alignRight:{alignSelf:"flex-end"},invisible:{opacity:0},visible:{opacity:1},marginShort:{marginBottom:e.spaces.space4},marginLong:{marginBottom:e.spaces.space12},isHoveredDMReaction:{borderColor:e.colors.transparent,cursor:"pointer"}})));var Mi=Object(Ze.a)(si(Ii)),Oi=i("Xrkv");const ki=Ne.a.icd0bf34,Li=Ne.a.e8bd8fec,Di=Ne.a.b2d32fad,Pi=Ne.a.a763d33e;class Fi extends r.PureComponent{constructor(e){super(e),n()(this,"_handlePress",(e=>{e.stopPropagation(),this.setState({showFullList:!0})})),this.state={showFullList:!1}}render(){const{isGroupDM:e,isSeenByEveryone:t,namesToDisplay:i}=this.props;return r.createElement(de.a,{style:Bi.root},r.createElement(he.c,{align:"right",color:"gray600",size:"small",style:Bi.seenLabel},this._renderSeenLabel()),!t&&e&&i.length?this._renderNameList():null)}_renderSeenLabel(){const{isGroupDM:e,isSeenByEveryone:t,namesToDisplay:i}=this.props;return t?e?Di:ki:i.length?Pi({count:i.length}):Li}_renderNameList(){let{namesToDisplay:e}=this.props;const{showFullList:t}=this.state,i=!t&&e.length>10,s=e.length-10,n=({namesList:e,othersCount:t})=>r.createElement(Ne.a.I18NFormatMessage,{$i18n:"f6464106"},r.createElement(he.c,null,e),r.createElement(he.c,{color:"link",onPress:this._handlePress},Ne.a.d7a0722f({othersCount:t})));i&&(e=e.slice(0,10));const a=Object(Oi.a)(e,i);return r.createElement(he.c,{align:"right",color:"gray600",size:"small",style:Bi.namesList},i?r.createElement(n,{namesList:a,othersCount:s}):r.createElement(he.c,null,a))}}const Bi=J.a.create((e=>({root:{alignItems:"flex-end",width:`calc(100% - ${e.spaces.space2})`},seenLabel:{cursor:"pointer"},namesList:{marginBottom:e.spaces.space2,whiteSpace:"pre-line"}})));var Ni=Fi,Ui=i("t0aI");const ji=({entryId:e,participants:t,user:i})=>{const s=Object.keys(t),n=Hi({entryId:e,participants:t,user:i});return{namesToDisplay:n,isSeenByEveryone:n.length===s.length-1}},Hi=({entryId:e,participants:t,user:i})=>Object.keys(t).reduce(((s,n)=>{const{join_conversation_event_id:r,last_read_event_id:a,user:{name:o}}=t[n],c=n!==i.id_str,l=a&&1!==Object(Ui.a)(e,a),d=!r||1!==Object(Ui.a)(r,e);return c&&l&&d&&s.push(o),s}),[]);var Wi=i("IMYl"),zi=i("21zW"),Vi=i("gmpV");const qi=Ne.a.fad48ee9,Gi=Ne.a.ba60339a,Qi=Ne.a.d338f53e,Ki=Ne.a.ae7d7a24,$i=Ne.a.d725a288,Yi=Ne.a.bbe74f3f,Xi=Ne.a.h0e4cdf4,Ji=Ne.a.bfbc051c;class Zi extends r.PureComponent{constructor(...e){super(...e),n()(this,"_handleRemove",(()=>{const{conversationId:e,removeEntry:t,entryId:i}=this.props;t(e,null,{id:i})})),n()(this,"_handleTryAgain",(()=>{const{sendMessage:e,conversationId:t,localMediaId:i,entryText:s,user:n}=this.props;e({senderId:n.id_str,conversationId:t,text:s,localMediaId:i}),this._handleRemove()}))}render(){const{isSent:e,onPress:t}=this.props,i=this._renderSending(),s=this._renderError(),n=this._renderTimestamp(),a=this._renderReadReceipt(),o=this._renderSentCheckmark(),c=this._renderReactions(),l=n||a||o;return(i||s||c||l)&&r.createElement(de.a,{style:[es.root,e&&es.sentMessage]},i,s,c,l?r.createElement(ee.a,{interactiveStyles:null,onPress:t,style:e&&es.sentContainer},r.createElement(de.a,{style:e&&es.groupedItems},n,o),a):null)}_renderError(){const{isError:e}=this.props;return e&&r.createElement(de.a,null,r.createElement(he.c,{align:"right",color:"gray600",size:"small"},Ki),r.createElement(de.a,{style:es.groupedItems},r.createElement(he.c,{accessibilityRole:"button",color:"red500",onPress:this._handleRemove,size:"small",withInteractiveStyling:!0},Gi),r.createElement(zi.a,null),r.createElement(he.c,{accessibilityRole:"button",color:"primary",onPress:this._handleTryAgain,size:"small",withInteractiveStyling:!0},Qi)))}_renderReactions(){const{conversationId:e,entryId:t,isLastRapidFire:i,isRapidFire:s,isSent:n}=this.props,a=!s||i;return r.createElement(de.a,{style:!n&&es.footerPadderWithAvatar},r.createElement(Mi,{conversationId:e,entryId:t,isEndOfDM:a,isSent:n}))}_renderReadReceipt(){const{entryId:e,isActive:t,isDraft:i,isError:s,isGroupDM:n,isSent:a,participants:o,user:c}=this.props;return t&&a&&!i&&!s?r.createElement(Ni,Qt()({isGroupDM:n},ji({entryId:e,participants:o,user:c}))):null}_renderSending(){const{isDraft:e,isError:t}=this.props;return e&&!t&&r.createElement(he.c,{align:"right",color:"gray600",size:"small"},qi)}_renderSentCheckmark(){const{entryId:e,isDraft:t,isError:i,isLastRapidFire:s,isRapidFire:n,isSent:a,participants:o,user:c}=this.props,{isSeenByEveryone:l}=ji({entryId:e,participants:o,user:c});return!a||t||i||n&&!s?null:r.createElement(he.c,{color:l?"primary":"gray600",style:es.checkmarkContainer},r.createElement(Wi.a,{style:es.checkmark}))}_renderTimestamp(){const{entryTime:e,isDraft:t,isGroupDM:i,isError:s,isLastRapidFire:n,isRapidFire:a,isSent:o,user:{name:c}}=this.props;if(t||s||a&&!n)return null;const l=new Date(Number(e));let d;d=Object(Vi.b)(l)?$i(l):Object(Vi.c)(l)?Yi({time:$i(l)}):Object(Vi.d)(l)?Xi(l):Ji(l);const h=i&&!o,p=o?"right":"left",u=!o;return r.createElement(de.a,{style:[u&&es.footerPadderWithAvatar,o&&es.timestamp]},r.createElement(he.c,{align:p,color:"gray600",size:"small",withInteractiveStyling:o||!pt.a.isEnabled},h&&r.createElement(Ne.a.I18NFormatMessage,{$i18n:"c8b914d4"},r.createElement(he.c,null,c)),h&&" ",d))}}const es=J.a.create((e=>({root:{marginTop:e.spaces.space2,overflow:"hidden",width:Xt},sentMessage:{alignSelf:"flex-end",justifyContent:"flex-end"},sentContainer:{flexDirection:"column"},groupedItems:{justifyContent:"flex-end",flexDirection:"row"},timestamp:{cursor:"pointer"},checkmark:{cursor:"pointer",flexShrink:0,height:"1rem",paddingLeft:e.spaces.space2},checkmarkContainer:{lineHeight:"1"},footerPadderWithAvatar:{marginLeft:`calc(${e.spaces.space40} + ${e.spaces.space12})`}})));var ts=Object(O.c)()(Yt(Zi)),is=i("jtO7");const ss=J.a.create((e=>({root:{borderColor:e.colors.gray50,borderStyle:"solid",borderWidth:e.borderWidths.small,borderBottomWidth:e.borderWidths.none,boxSizing:"border-box",overflow:"hidden"},isLast:{borderBottomWidth:e.borderWidths.small},insideTopRoundedSent:{borderTopLeftRadius:e.borderRadii.xLarge},insideTopRoundedReceived:{borderTopRightRadius:e.borderRadii.xLarge},outsideTopRoundedSent:{borderTopRightRadius:e.borderRadii.xLarge},outsideTopRoundedReceived:{borderTopLeftRadius:e.borderRadii.xLarge},sentLast:{borderBottomLeftRadius:e.borderRadii.xLarge},receivedLast:{borderBottomRightRadius:e.borderRadii.xLarge}})));var ns=({insideTopRounded:e,isSent:t,isLast:i,label:s,onClick:n,tcoUrl:a,outsideTopRounded:o})=>{const c=[ss.root,i&&ss.isLast,i&&t&&ss.sentLast,i&&!t&&ss.receivedLast,e&&t&&ss.insideTopRoundedSent,e&&!t&&ss.insideTopRoundedReceived,o&&t&&ss.outsideTopRoundedSent,o&&!t&&ss.outsideTopRoundedReceived];return r.createElement(de.a,{style:c},r.createElement(is.a,{align:"center",color:"primary",label:s,link:a,onClick:n,withBottomBorder:!1}))},rs=i("fs1G");class as extends r.Component{componentDidMount(){this.props.onImpression()}render(){const{callToActions:e,isSent:t,onCtaClick:i,withSticker:s,withUserText:n}=this.props,a=e.map(((a,o)=>{const c=0===o;return r.createElement(ns,{insideTopRounded:c&&(s||!n),isLast:o===e.length-1,isSent:t,key:o,label:a.label,onClick:i,outsideTopRounded:c&&s,tcoUrl:a.tco_url})}));return r.createElement(de.a,null,a)}}n()(as,"defaultProps",{onCtaClick:rs.a,onImpression:rs.a});var os=as,cs=i("vjRr");const ls=Object(f.createSelector)(((e,t)=>cs.a.createManyHydratedSelector([t.cardUrl])(e)[0]),(e=>({card:e}))),ds={popOutConversation:l.popOutConversation};var hs=Object(u.g)(ls,ds);const ps=J.a.create((e=>({root:{width:"100%"},invisible:{opacity:0},visible:{opacity:1}})));var us=({attachmentContent:e,attachmentHeader:t,isVisible:i=!0,textContent:s})=>r.createElement(de.a,{style:[i?ps.visible:ps.invisible,ps.root]},t,e,s),ms=i("cTG8");const fs=({excludeCardUrl:e,isActive:t=!1,isFailedDraft:i,isFirstRapidFire:s=!1,isRapidFire:n=!1,isSent:a,hasAssociatedAttachment:o,messageData:c={},rootStyle:l,tweetId:d,withCta:h,withMediaLinks:p,withMessageBubble:u})=>{const m=[l,u&&gs.messageTextContainer,u&&a&&gs.sent,u&&!a&&gs.received,i&&gs.failedDraft,n&&!s&&!a&&gs.rapidFireReceived,n&&!s&&a&&gs.rapidFireSent,o&&a&&gs.hasAssociatedAttachmentSent,o&&!a&&gs.hasAssociatedAttachmentReceived,u&&t&&a&&gs.activeSent,u&&t&&!a&&!pt.a.isEnabled&&gs.activeReceived,h&&gs.withCta],f=[gs.tweetText,u&&gs.textAlignLeft,!u&&a&&gs.textAlignRight],{white:g,text:b,primary:_,gray0:v,red500:y}=J.a.theme.colors,E=X.a.generate({color:a?g:b,backgroundColor:i?y:a?_:v}),S=c.text&&c.text.length||0;return r.createElement(ee.a,{accessibilityRole:"none",interactive:a,interactiveStyles:u?E:null,style:m},r.createElement(ms.a,{color:J.a.isDarkMode()||a?"whiteOnColor":void 0,displayTextRange:[0,S],entities:c.entities,excludeCardUrl:e,linkColor:u&&a||J.a.isDarkMode()?"whiteOnColor":"link",linkify:!0,quotedTweetId:d,size:u?void 0:"jumbo",style:f,text:c.text||"",underlineLinks:!0,withMediaLinks:p}))},gs=J.a.create((e=>({tweetText:{overflow:"hidden"},messageTextContainer:{borderRadius:e.borderRadii.xLarge,boxSizing:"border-box",maxWidth:"100%",paddingVertical:e.spaces.space12,paddingHorizontal:e.spaces.space16},textAlignLeft:{textAlign:"left"},textAlignRight:{textAlign:"right"},sent:{alignSelf:"flex-end",backgroundColor:e.colors.primary,borderBottomRightRadius:e.borderRadii.none,borderColor:e.colors.primary},received:{alignSelf:"flex-start",backgroundColor:e.colors.dmReceivedBubbleBackground,borderBottomLeftRadius:e.borderRadii.none,borderColor:e.colors.gray200},activeSent:{backgroundColor:e.colors.lightPrimary},activeReceived:{backgroundColor:e.colors.gray200},failedDraft:{backgroundColor:e.colors.red500},rapidFireReceived:{borderTopLeftRadius:e.borderRadii.none},rapidFireSent:{borderTopRightRadius:e.borderRadii.none},withCta:{borderBottomRightRadius:e.borderRadii.none,borderBottomLeftRadius:e.borderRadii.none},hasAssociatedAttachmentSent:{borderTopRightRadius:e.borderRadii.none},hasAssociatedAttachmentReceived:{borderTopLeftRadius:e.borderRadii.none}})));fs.defaultProps={withMediaLinks:!1};var bs=fs,_s=i("aX4+"),vs=i("bNYH");class ys extends r.Component{constructor(...e){super(...e),n()(this,"state",{attachmentWidth:void 0,textContentWidth:void 0}),n()(this,"_handleAttachmentLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e,{attachmentWidth:i}=this.state;if(i!==t){const e={attachmentWidth:t};this.setState(e)}})),n()(this,"_handlePopOutDM",(()=>{const{conversationId:e,popOutConversation:t}=this.props;e&&t(e)})),n()(this,"_handleTextContentLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e,{textContentWidth:i}=this.state;if(i!==t){const e={textContentWidth:t};this.setState(e)}}))}render(){const{card:e,hasUserText:t,isActive:i,isFailedDraft:s,isFirstRapidFire:n,isRapidFire:a,isSent:o,messageData:c,withCta:l,withMessageBubble:d}=this.props,{attachmentWidth:h,textContentWidth:p}=this.state,u=yt(t,h,p),m=u.isAttachmentSquared?"both":o?"right":"left",f=t?r.createElement(de.a,{onLayout:this._handleTextContentLayout,style:o?Es.sentMessageWrapper:Es.receivedMessageWrapper},r.createElement(bs,{excludeCardUrl:e.url,hasAssociatedAttachment:!0,isActive:i,isFailedDraft:s,isFirstRapidFire:n,isRapidFire:a,isSent:o,messageData:c,rootStyle:u.isTextSquared?o?Es.textSentSquared:Es.textReceivedSquared:void 0,withCta:l,withMessageBubble:d})):null;return r.createElement(us,{attachmentContent:(()=>{if(vs.a.isAudioSpaceCard(e)){const t=vs.a.getAudioSpaceIdFromCard(e);if(t)return r.createElement(de.a,{onClick:this._handlePopOutDM,onLayout:this._handleAttachmentLayout},r.createElement(vs.a,{audioSpaceId:t,withSquareBottomBorderRadius:m}))}return r.createElement(de.a,{onClick:this._handlePopOutDM,onLayout:this._handleAttachmentLayout},r.createElement(_s.a,{card:{name:e.name,url:e.url,binding_values:e.binding_values,users:e.users},cardContext:{tweetUserId:c.sender_id},dmSentOrReceived:o?"sent":"received",withSquareBottomBorderRadius:m}))})(),isVisible:u.compositeRendered,textContent:f})}}n()(ys,"defaultProps",{hasUserText:!1});const Es=J.a.create((e=>({attachmentReceivedSquared:{borderBottomRightRadius:e.borderRadii.none},attachmentSentSquared:{borderBottomLeftRadius:e.borderRadii.none},card:{marginBottom:e.spaces.space2},receivedMessageWrapper:{alignSelf:"flex-start"},sentMessageWrapper:{alignSelf:"flex-end"},received:{borderBottomLeftRadius:e.borderRadii.none},sent:{borderBottomRightRadius:e.borderRadii.none},textReceivedSquared:{borderTopRightRadius:e.borderRadii.none},textSentSquared:{borderTopLeftRadius:e.borderRadii.none}})));var Ss=hs(ys),Cs=i("cSHO"),Rs=i("rxPX");const ws={...g.a,EXPIRED:"expired"},As=e=>{const{message_data:t}=e;if(t){const{time:e}=t;return(new Date).getTime()-parseInt(e,10)>864e5}return!0},xs=(e,t)=>Cs.c(e,t.fleetId),Is=(e,t)=>t.messageData.recipient_id?E.e.select(e,t.messageData.recipient_id):void 0,Ts=(e,t)=>{const i=Cs.d(e,t.fleetId),s=As(t.entry);return s||i===g.a.FAILED?ws.EXPIRED:s||i!==g.a.NONE?i:ws.LOADING},Ms=(e,t)=>Cs.e(e,t.fleetId);var Os=Object(Rs.a)().propsFromState((()=>({fleet:xs,fleetUser:Is,fleetFetchStatus:Ts,isInterstitialed:Ms}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(m.d)("DM_FLEET_MESSAGE"),fetchUserFleetsIfNeeded:Cs.b,updateFleetIsInterstitialed:Cs.i}))).withAnalytics({page:"messages",section:"fleet"}),ks=i("prG5"),Ls=i("LKEN"),Ds=i("9Xij"),Ps=i("Qwev"),Fs=i("lHOd"),Bs=i("qKzg"),Ns=i("vboP"),Us=i("A91F");const js=Ne.a.f720438f,Hs=Ne.a.cc1030a5,Ws=Ne.a.f9a364da,zs=Ne.a.h59a1759,Vs=Ne.a.e51ddecb;function qs(e){var t;const{featureSwitches:i}=r.useContext(o.a),s=r.useContext(Fs.a),{fleet:n,fleetFetchStatus:a,fleetViewerUrl:c,isInterstitialed:l}=e,d=null==n||null==(t=n.media_entity)?void 0:t.media_url_https,[h,p]=r.useState(a!==ws.EXPIRED);r.useEffect((()=>{if(h){const e=setTimeout((()=>p(!1)),500);return()=>clearTimeout(e)}}),[h]);const u=i.isTrue("responsive_web_fleets_dm_consumption_enabled"),m=u?js:Hs;if(u&&a===ws.LOADING)return(e=>r.createElement(de.a,{style:Gs.loadingIndicatorWrapper},r.createElement(Ds.a,{ratio:9/16},r.createElement(de.a,{style:Gs.activityIndicatorWrapper},e?void 0:r.createElement(Ps.a,null)))))(h);if(u&&n&&n.media_entity&&d){var f,g,b;const e=null==n||null==(f=n.media_entity)||null==(g=f.additional_metadata)||null==(b=g.alt_text)?void 0:b.text,t=Object(Ls.b)(Bs.b.Original,n.media_entity),i=()=>{c&&s.push(c)};return r.createElement(Ns.a,{buttonLabel:Ws,description:zs,isInterstitialed:l,onBackgroundClick:i,onButtonClick:i},r.createElement(ks.a,{accessibilityLabel:e||Vs,aspectMode:Us.a.withinRange(9/16,10),image:{url:d,width:t.width,height:t.height}}))}return r.createElement(he.c,{color:"gray600"},m)}const Gs=J.a.create((e=>({loadingIndicatorWrapper:{backgroundColor:e.colors.gray0,borderColor:e.colors.gray50},activityIndicatorWrapper:{height:"100%",justifyContent:"center",alignItems:"center"}}))),Qs=Ne.a.d9e524a7,Ks=Ne.a.b3d08517,$s=Ne.a.ab1dd773,Ys=Ne.a.f483af99;class Xs extends r.Component{constructor(...e){super(...e),n()(this,"_fleetsDMConsumptionEnabled",this.context.featureSwitches.isTrue("responsive_web_fleets_dm_consumption_enabled")),n()(this,"_fleetsViewerScreenEnabled",this.context.featureSwitches.isTrue("responsive_web_fleets_viewer_screen_enabled")),n()(this,"state",{attachmentWidth:void 0,textContentWidth:void 0}),n()(this,"_getSquareBottomStyles",(e=>{const{isSent:t}=this.props;let i="left";return e?i="both":t&&(i="right"),Js[i]})),n()(this,"_handleAttachmentLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e,{attachmentWidth:i}=this.state;i!==t&&this.setState({attachmentWidth:t})})),n()(this,"_handleClick",(e=>{const{analytics:t}=this.props;e.stopPropagation(),t.scribe({element:"fleet_attachment",action:"click"})})),n()(this,"_handleTextContentLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e,{textContentWidth:i}=this.state;i!==t&&this.setState({textContentWidth:t})})),n()(this,"_renderFleet",(e=>{var t;const{fleet:i,fleetFetchStatus:s,fleetUser:n,isInterstitialed:a,isSent:o}=this.props,c=!(null==i||null==(t=i.media_entity)||!t.media_url_https)||s===ws.LOADING,l=c&&this._fleetsDMConsumptionEnabled&&this._fleetsViewerScreenEnabled&&i&&n&&null!=n&&n.screen_name&&null!=i&&i.fleet_id?(d=n.screen_name,h=i.fleet_id,`/${d}/fleets/${h}`):void 0;var d,h;const p=[this._fleetsDMConsumptionEnabled&&c?Zs.fleetWrapper:Zs.tombstoneWrapper,o?Zs.sentMessageWrapper:Zs.receivedMessageWrapper,this._getSquareBottomStyles(e)];return r.createElement(ee.a,{interactiveStyles:null,link:a?void 0:l,onClick:l?this._handleClick:void 0,onLayout:this._handleAttachmentLayout,style:p},r.createElement(qs,{fleet:i,fleetFetchStatus:s,fleetViewerUrl:l,isInterstitialed:a}))})),n()(this,"_renderFleetAttachmentHeader",(()=>{const{isSent:e,withMessageBubble:t,isRapidFire:i,isFirstRapidFire:s}=this.props;let n;return n=e&&t?Ys:t?$s:e?Ks:Qs,r.createElement(he.c,{color:"gray600",size:"small",style:[Zs.attachmentHeader,e?Zs.sentMessageWrapper:Zs.receivedMessageWrapper,i&&!s&&Zs.fleetHeaderSpacing]},n)})),n()(this,"_renderFleetTextContent",(e=>{const{hasUserText:t,isActive:i,isFailedDraft:s,isFirstRapidFire:n,isRapidFire:a,isSent:o,messageData:c,withCta:l,withMessageBubble:d}=this.props;return t?r.createElement(de.a,{onLayout:this._handleTextContentLayout,style:[o?Zs.sentMessageWrapper:Zs.receivedMessageWrapper,!d&&Zs.fleetReactionSpacing]},r.createElement(bs,{hasAssociatedAttachment:!0,isActive:i,isFailedDraft:s,isFirstRapidFire:n,isRapidFire:a,isSent:o,messageData:c,rootStyle:e?o?Zs.sentSquared:Zs.receivedSquared:void 0,withCta:l,withMessageBubble:d})):null}))}componentDidMount(){const{analytics:e,createLocalApiErrorHandler:t,messageData:i,fleetFetchStatus:s,fleetId:n,fetchUserFleetsIfNeeded:r}=this.props;e.scribe({element:"fleet_attachment",action:"impression"}),this._fleetsDMConsumptionEnabled&&s!==ws.EXPIRED&&i.recipient_id&&(r(i.recipient_id,n).catch(t()),e.scribe({element:"fleet_attachment",action:"fetch_user_fleets"}))}componentDidUpdate(e){const{fleet:t,onIsFleetAvailable:i}=this.props;if(this._fleetsDMConsumptionEnabled&&!Object(le.a)(t,e.fleet)){i(!!t)}}render(){const{hasUserText:e,messageData:t}=this.props,{attachmentWidth:i,textContentWidth:s}=this.state;if(!t||!t.attachment||!t.attachment.fleet)return null;const{compositeRendered:n,isAttachmentSquared:a,isTextSquared:o}=yt(e,i,s);return r.createElement(us,{attachmentContent:this._renderFleet(a),attachmentHeader:this._fleetsDMConsumptionEnabled?this._renderFleetAttachmentHeader():void 0,isVisible:n,textContent:this._renderFleetTextContent(o)})}}n()(Xs,"contextType",o.a);const Js=J.a.create((e=>({both:{borderBottomRightRadius:e.borderRadii.none,borderBottomLeftRadius:e.borderRadii.none},left:{borderBottomLeftRadius:e.borderRadii.none},right:{borderBottomRightRadius:e.borderRadii.none}}))),Zs=J.a.create((e=>({attachmentHeader:{marginBottom:e.spaces.space4},isSent:{borderBottomRightRadius:e.borderRadii.none},fleetWrapper:{borderRadius:e.borderRadii.xLarge,WebkitMaskImage:"url(data:image/png;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICRAEAOw==)",width:"100%"},fleetReactionSpacing:{marginTop:e.spaces.space4},fleetHeaderSpacing:{marginTop:e.spaces.space12},received:{borderBottomLeftRadius:e.borderRadii.none},receivedMessageWrapper:{alignSelf:"flex-start"},receivedSquared:{borderTopRightRadius:e.borderRadii.none},sentMessageWrapper:{alignSelf:"flex-end"},sentSquared:{borderTopLeftRadius:e.borderRadii.none},tombstoneWrapper:{backgroundColor:e.colors.gray0,borderColor:e.colors.gray50,borderRadius:e.borderRadii.xLarge,boxSizing:"border-box",flexDirection:"row",borderWidth:e.borderWidths.small,paddingHorizontal:e.spaces.space16,paddingVertical:e.spaces.space12,overflow:"auto"}})));var en=Os(Xs),tn=i("RCZO");const sn=Ne.a.b327c129,nn=e=>{e.stopPropagation()};var rn=({media:e,mediaUrl:t})=>{const i=e.ext_alt_text||sn,s=e.media_url_https,{width:n,height:a}=e.original_info||{},o=Object(tn.c)(e).rgb,c=r.createElement(ks.a,{accessibilityLabel:i,aspectMode:Us.a.withinRange(9/16,10),backgroundColor:o,image:{url:s,width:n,height:a},shouldShowAltLabel:!!e.ext_alt_text});return t?r.createElement(ee.a,{interactiveStyles:null,link:t,onPress:nn},c):c},an=i("Modb"),on=i("lklz"),cn=i("XrEN"),ln=i("ZvMt");var dn=({media:e,messageId:t})=>{const i=e&&cn.a.extractVideoProps(on.b.forDm(t),e);return i?r.createElement(an.a,Qt()({},i,{aspectRatio:ln.a.getAspectRatio(e.video_info),withPostPlayback:!0})):null};const hn={scribeAction:c.c};var pn=Object(u.b)(hn);class un extends r.PureComponent{constructor(e,t){super(e,t),n()(this,"_handleLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e;this.state.width!==t&&this.setState({width:t})})),n()(this,"_getElement",(()=>{const{isSensitive:e,contentType:t}=this.props;return`${e?"sensitive":"untrusted"}_${t}_interstitial`})),n()(this,"_handleClick",(()=>{const{scribeAction:e,scribeNamespace:t}=this.props;this.setState({hide:!1}),e({...t,element:this._getElement(),action:"reveal"})})),this.state={hide:!0,width:0}}componentDidMount(){const{scribeAction:e,scribeNamespace:t}=this.props;e({...t,element:this._getElement(),action:"impression"})}render(){const{children:e,ctaText:t,description:i,withSquareBottomBorderRadius:s}=this.props,{hide:n,width:a}=this.state,o=a<J.a.theme.breakpoints.micro;return n?r.createElement(de.a,{accessible:!0,onLayout:this._handleLayout,style:[fn.root,o?{flexDirection:"column"}:{flexDirection:"row",alignItems:"center"},s&&mn[s]]},r.createElement(de.a,{style:fn.description},r.createElement(he.c,null,i)),r.createElement(de.a,{style:[fn.button,o?fn.breakButtonWrapper:void 0]},r.createElement(ht.a,{onClick:this._handleClick,size:"normalCompact",style:fn.buttonElement,type:"text"},t))):e}}n()(un,"defaultProps",{isSensitive:!1});const mn=J.a.create((e=>({both:{borderBottomRightRadius:e.borderRadii.none,borderBottomLeftRadius:e.borderRadii.none},left:{borderBottomLeftRadius:e.borderRadii.none},right:{borderBottomRightRadius:e.borderRadii.none}}))),fn=J.a.create((e=>({breakButtonWrapper:{marginTop:J.a.theme.spaces.space4,marginLeft:`calc(-1 * ${e.spaces.space12})`},button:{flexGrow:1,alignItems:"flex-start"},buttonElement:{paddingHorizontal:e.spaces.space12},description:{flexGrow:1,flexShrink:1},root:{backgroundColor:e.colors.gray0,borderColor:e.colors.gray50,borderRadius:e.borderRadii.xLarge,boxSizing:"border-box",borderWidth:e.borderWidths.small,maxWidth:"100%",paddingLeft:e.spaces.space16,paddingTop:e.spaces.space16,paddingBottom:e.spaces.space16,paddingRight:e.spaces.space4,overflow:"auto",display:"flex"}})));var gn=Object(O.c)()(pn(un)),bn=i("CoGJ");const _n=r.createElement(bn.a,null),vn=Ne.a.d9de7b57,yn=Ne.a.f2879f4d,En=Ne.a.b518221e,Sn=Ne.a.eeaa9f90,Cn=Ne.a.g2b43663,Rn=Ne.a.f277e949;class wn extends r.Component{constructor(...e){super(...e),n()(this,"state",{attachmentWidth:void 0,textContentWidth:void 0}),n()(this,"_renderAttachment",(()=>{const{entry:e,hasUserText:t,isFirstRapidFire:i,isRapidFire:s,isSent:n,isTrusted:a,messageData:o}=this.props,{attachmentWidth:c,textContentWidth:l}=this.state,{attachment:d}=o||{},h=e.is_draft,p=yt(t,c,l),u=[An.mediaAttachment,n&&An.isSent,!n&&An.received,n&&p.isAttachmentSquared&&An.equalComponentDimensionsSent,!n&&p.isAttachmentSquared&&An.equalComponentDimensionsReceived,s&&!i&&n&&An.rapidFireSent,s&&!i&&!n&&An.rapidFireReceived];let m,f,g=null;if(!h&&e.conversation_id&&(g=`/messages/${e.conversation_id}/media/${e.id}`),d)if(d.photo)m=d.photo,f=r.createElement(rn,{media:m,mediaUrl:g});else if(d.animated_gif)m=d.animated_gif,f=r.createElement(dn,{media:m,messageId:e.id});else if(d.video){if(m=d.video,Object(C.e)(d,this.context.featureSwitches))throw new Error("DMMediaMessage should not be used to render voice messages");f=r.createElement(dn,{media:m,messageId:e.id})}const b=p.isAttachmentSquared?"both":n?"right":"left",_=m&&f&&(n?f:this._getMediaContentWithGuard(m,a,f,b));return{attachmentContent:r.createElement(de.a,{onLayout:this._handleAttachmentLayout,style:u},_),media:m}})),n()(this,"_handleAttachmentLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e,{attachmentWidth:i}=this.state;if(i!==t){const e={attachmentWidth:t};this.setState(e)}})),n()(this,"_handleTextContentLayout",(e=>{const{nativeEvent:{layout:{width:t}}}=e,{textContentWidth:i}=this.state;if(i!==t){const e={textContentWidth:t};this.setState(e)}}))}render(){const{entry:e,hasUserText:t,isActive:i,isFailedDraft:s,isFirstRapidFire:n,isRapidFire:a,isSent:o,messageData:c,withCta:l,withMessageBubble:d}=this.props,{attachmentWidth:h,textContentWidth:p}=this.state,u=e.is_draft,m=yt(t,h,p),{media:f,attachmentContent:g}=this._renderAttachment(),b=t?r.createElement(de.a,{onLayout:this._handleTextContentLayout,style:o?An.sentMessageWrapper:An.receivedMessageWrapper},r.createElement(bs,{hasAssociatedAttachment:!0,isActive:!!i,isFailedDraft:s,isFirstRapidFire:!!n,isRapidFire:!!a,isSent:o,messageData:u?c:this._parseMessageData(c,f),rootStyle:m.isTextSquared?o?An.sentSquared:An.receivedSquared:void 0,withCta:l,withMessageBubble:d})):null;return r.createElement(us,{attachmentContent:g,isVisible:m.compositeRendered,textContent:b})}_getMediaContentWithGuard(e,t,i,s){const{displaySensitiveMedia:n,isDmNsfwMediaFilterEnabled:a}=this.props;if(e.possibly_sensitive&&this.context.featureSwitches.isTrue("dm_conversations_nsfw_media_filter_enabled")){if(a){const t="animated_gif"===e.type&&Cn||"video"===e.type&&Sn||En;return r.createElement(gn,{contentType:e.type,ctaText:t,description:yn,isSensitive:!0,withSquareBottomBorderRadius:s},i)}}else if(!n&&e.possibly_sensitive)return r.createElement(gn,{contentType:e.type,ctaText:Rn,description:_n,isSensitive:!0,withSquareBottomBorderRadius:s},i);return t?i:r.createElement(gn,{contentType:e.type,ctaText:Rn,description:vn,withSquareBottomBorderRadius:s},i)}_parseMessageData(e,t){var i;const s=null!=e&&null!=(i=e.entities)&&i.urls&&t?e.entities.urls.filter((e=>e.display_url!==t.display_url)):null;return e&&s?{...e,entities:{...e.entities,urls:s,media:t?[t]:[]}}:void 0}}n()(wn,"contextType",o.a),n()(wn,"defaultProps",{hasUserText:!1});const An=J.a.create((e=>({equalComponentDimensionsSent:{borderBottomLeftRadius:e.borderRadii.none},equalComponentDimensionsReceived:{borderBottomRightRadius:e.borderRadii.none},invisible:{opacity:0},isSent:{borderBottomRightRadius:e.borderRadii.none},mediaAttachment:{borderRadius:e.borderRadii.xLarge,WebkitMaskImage:"url(data:image/png;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICRAEAOw==)"},receivedMessageWrapper:{alignSelf:"flex-start"},sentMessageWrapper:{alignSelf:"flex-end"},rapidFireReceived:{borderTopLeftRadius:e.borderRadii.none},rapidFireSent:{borderTopRightRadius:e.borderRadii.none},received:{borderBottomLeftRadius:e.borderRadii.none},receivedSquared:{borderTopRightRadius:e.borderRadii.none},sentSquared:{borderTopLeftRadius:e.borderRadii.none},visible:{opacity:1}})));var xn=wn,In=Object(Rs.a)().propsFromActions((()=>({markSpamStatus:l.markSpamStatus})));const Tn=Ne.a.fd07947f,Mn=Ne.a.c7a92dc9,On=Ne.a.f277e949,kn=Ne.a.fb3ccb55;class Ln extends r.PureComponent{constructor(...e){super(...e),n()(this,"_handlePress",(e=>()=>{const{conversationId:t,dmId:i,markSpamStatus:s}=this.props;s({conversationId:t,dmId:i,markSpam:e})}))}render(){const{children:e}=this.props;return r.createElement(gn,{contentType:"dm",ctaText:On,description:kn},e,this._renderButtons())}_renderButtons(){return r.createElement(de.a,{style:Pn.buttons},r.createElement(ht.a,{onPress:this._handlePress(!1),style:Pn.leftButton,type:"secondary"},Mn),r.createElement(ht.a,{onPress:this._handlePress(!0),type:"secondary"},Tn))}}var Dn=In(Ln);const Pn=J.a.create((e=>({buttons:{flexDirection:"row",paddingTop:e.spaces.space4},leftButton:{marginRight:e.spaces.space12}})));var Fn=({isActive:e=!1,isFailedDraft:t,isFirstRapidFire:i=!1,isRapidFire:s=!1,isSent:n,messageData:a,withCta:o,withMessageBubble:c})=>r.createElement(bs,{isActive:e,isFailedDraft:t,isFirstRapidFire:i,isRapidFire:s,isSent:n,messageData:a,withCta:o,withMediaLinks:!0,withMessageBubble:c}),Bn=i("U+bB");const Nn=e=>{const t=e.images,i=t.svg||t.size_1x;if(i)return i.url},Un=J.a.create((e=>({stickerItem:{height:`calc(3 * ${e.fontSizes.jumbo})`,width:`calc(3 * ${e.fontSizes.jumbo})`}})));var jn=({sticker:e})=>r.createElement(Bn.a,{accessibilityLabel:e.display_name,source:Nn(e),style:Un.stickerItem}),Hn=i("XOJV");const Wn=(e,t)=>{var i;const s=null==(i=t.messageData)?void 0:i.attachment;if(s&&s.tweet)return s.tweet.status};var zn=Object(Rs.a)().propsFromState((()=>({tweet:Hn.a.createHydratedTweetSelector(Wn)}))).propsFromActions((()=>({popOutConversation:l.popOutConversation}))),Vn=i("b5s6");const qn=r.createElement(he.c,{link:"/settings/safety"});var Gn=e=>r.createElement(Ne.a.I18NFormatMessage,{$i18n:"j3c7dd33"},r.cloneElement(qn,null,Ne.a.adcf07b5));const Qn=Ne.a.e4df0ad7,Kn=Ne.a.f277e949,$n=Ne.a.b5b91d58,Yn=Ne.a.bb594d7b,Xn=r.createElement(Gn,null);const Jn=J.a.create((e=>({attachment:{marginBottom:0},receivedMessageWrapper:{alignSelf:"flex-start"},sentMessageWrapper:{alignSelf:"flex-end"},received:{borderBottomLeftRadius:e.borderRadii.none,borderColor:e.colors.gray200},receivedAttachmentSquared:{borderBottomRightRadius:e.borderRadii.none},receivedSquared:{borderTopRightRadius:e.borderRadii.none},sent:{borderBottomRightRadius:e.borderRadii.none,borderColor:e.colors.primary},sentAttachmentSquared:{borderBottomLeftRadius:e.borderRadii.none},sentSquared:{borderTopLeftRadius:e.borderRadii.none}})));var Zn=zn((function(e){const{featureSwitches:t}=r.useContext(o.a),{conversationId:i,displaySensitiveMedia:s,hasUserText:n=!1,isActive:a=!1,isDmNsfwMediaFilterEnabled:c,isFailedDraft:l,isFirstRapidFire:d=!1,isRapidFire:h=!1,isSent:p,isTrusted:u,messageData:m,popOutConversation:f,tweet:g,withCta:b,withMessageBubble:_}=e,[v,y]=r.useState(void 0),[E,S]=r.useState(void 0),C=r.useMemo((()=>function(){i&&f(i)}),[i,f]),R=r.useMemo((()=>function(e){const{nativeEvent:{layout:{width:t}}}=e;v!==t&&y(t)}),[v]),w=r.useMemo((()=>function(e){const{nativeEvent:{layout:{width:t}}}=e;E!==t&&S(t)}),[E]);if(!m||!m.attachment||!m.attachment.tweet)return null;const A=m.attachment.tweet,x=p?"sent":"received",I=yt(n,v,E),T=r.createElement(Vn.a,{onPress:t.isTrue("responsive_web_dm_quick_access_enabled")?C:void 0,style:[Jn[x],n&&Jn.attachment,I.isAttachmentSquared?p?Jn.sentAttachmentSquared:Jn.receivedAttachmentSquared:void 0],tweetId:A.status}),M=I.isAttachmentSquared?"both":p?"right":"left",O=(()=>{if(!g)return null;if(p)return T;if(g.possibly_sensitive&&t.isTrue("dm_conversations_nsfw_media_filter_enabled")){if(c||void 0===c)return r.createElement(gn,{contentType:"photo",ctaText:Yn,description:$n,withSquareBottomBorderRadius:M},T)}else if(!s&&g.possibly_sensitive)return r.createElement(gn,{contentType:"photo",ctaText:Kn,description:Xn,withSquareBottomBorderRadius:M},T);return u?T:r.createElement(gn,{contentType:"tweet",ctaText:Kn,description:Qn,withSquareBottomBorderRadius:M},T)})(),k=r.createElement(de.a,{onLayout:R,style:Jn.attachment},O),L=n?r.createElement(de.a,{onLayout:w,style:p?Jn.sentMessageWrapper:Jn.receivedMessageWrapper},r.createElement(bs,{hasAssociatedAttachment:!0,isActive:a,isFailedDraft:l,isFirstRapidFire:d,isRapidFire:h,isSent:p,messageData:m,rootStyle:I.isTextSquared?p?Jn.sentSquared:Jn.receivedSquared:void 0,tweetId:A.status,withCta:b,withMediaLinks:!0,withMessageBubble:_})):null;return r.createElement(us,{attachmentContent:k,isVisible:I.compositeRendered,textContent:L})})),er=i("8W85");function tr(){const e=r.useContext(hr),[t,i]=e.activeVoiceMessage,[,s]=e.playerApi,[,n]=e.playerState,[,a]=t;const o={media:a,onEnded:function(){i([null,null]),e.scribeAction&&e.scribeAction.complete()},onPlayerApi:s,onPlayerState:n};return r.createElement(er.a,o)}var ir=i("89tF"),sr=i("k89r");function nr(e){const t=function(){const e=r.useState(or.activeVoiceMessage),t=r.useState(or.playerApi),i=r.useState(or.playerState),s=function(){const e=Object(sr.a)();return r.useMemo((()=>{const t={page:"messages",section:"thread",component:"message",element:"voice"};function i({action:e,component:i=t.component}){const{page:s,section:n,element:r}=t;return{page:s,section:n,component:i,element:r,action:e}}const s=(t,s)=>s?s.data?e.scribe({...i({action:t}),data:s.data}):e.scribe({...i({action:t,component:ar(s)})}):e.scribe({...i({action:t})});return{impression:e=>s("impression",e),report:e=>s("report",e),play:e=>s("play",e),pause:()=>s("pause"),complete:()=>s("complete")}}),[e])}();return{activeVoiceMessage:e,playerApi:t,playerState:i,scribeAction:s}}();return r.createElement(cr.Provider,{value:t},e.children)}const rr={Timelines:Object(ir.a)({message:!0,inbox_timeline:!0,low_quality_timeline:!0,requests_timeline:!0})};function ar({isLowQuality:e,isTrusted:t}){return t?rr.Timelines.inbox_timeline:e?rr.Timelines.low_quality_timeline:rr.Timelines.requests_timeline}const or={activeVoiceMessage:[null,null],playerApi:null,playerState:null,scribeAction:null},cr=r.createContext({activeVoiceMessage:[or.activeVoiceMessage,lr],playerApi:[or.playerApi,lr],playerState:[or.playerState,lr],scribeAction:null});function lr(){throw new Error("DMVoiceContext is not initialized")}function dr(e){const{featureSwitches:t}=r.useContext(o.a);return Object(C.d)(t)?r.createElement(nr,null,e.children,r.createElement(tr,null)):e.children}const hr=cr;var pr=i("MH+I"),ur=i("5Ixf"),mr=i("AtEG");function fr(e){var t,i;const s=r.useContext(hr),{isLowQuality:n,isSent:a,isTrusted:o}=e;if(null==(t=e.media)||!t.video_info)return null;const[c,l]=s.activeVoiceMessage,[d]=s.playerApi,[h]=s.playerState,{scribeAction:p}=s,[u]=c,m=e.messageId===u;if(!p)return null;const f=br(h),g=(null==(i=e.media)?void 0:i.video_info.duration_millis)||0,b={durationMs:g,isActive:m,isSent:a,playerApi:null,playerState:null,onImpression:()=>p.impression({isLowQuality:n,isTrusted:o}),onPlayRequest:()=>l([e.messageId,e.media]),onPlay:()=>p.play({data:{duration_ms:g}}),onPause:()=>p.pause()};return m&&f&&f.contentId===e.media.id_str&&(b.playerApi=d,b.playerState=h,null!=f&&f.durationMs&&(b.durationMs=null==f?void 0:f.durationMs)),r.createElement(gr,b)}function gr(e){const{isActive:t,isSent:i,playerState:s,playerApi:n}=e,a=null==s?void 0:s.isPlaying,o=br(s),c=(null==o?void 0:o.currentTimeMs)||0,l=(null==o?void 0:o.durationMs)||e.durationMs,d=Math.max(t?l-c:l,0);r.useLayoutEffect((()=>{e.onImpression()}),[]),r.useEffect((()=>{n&&0===c&&(n.play(),e.onPlay())}),[n]);const h=J.a.isDarkMode()||i,p={color:h?"whiteOnColor":"normal"},u=[yr.voiceMessage,Er({isSent:i,squared:t}),i?yr.voiceMessageSent:yr.voiceMessageReceived,Ce(J.a.theme.scale).voiceMessage({isVoiceMessageActive:t,isSent:i})],m=a?ur.a:mr.a;return r.createElement(de.a,{style:[yr.container,Ce(J.a.theme.scale).voiceMessageContainer({isVoiceMessageActive:t,isSent:i})]},r.createElement(de.a,{style:u},r.createElement(de.a,{style:yr.startSpacer}),r.createElement(ht.a,{accessibilityLabel:a?vr:_r,icon:r.createElement(m,{style:h?yr.iconColorDark:yr.iconColorDefault}),onPress:()=>{n?a?(n.pause(),e.onPause()):(n.play(),e.onPlay()):e.onPlayRequest()},size:"normal",type:"invertedText"}),r.createElement(de.a,{style:yr.durationSpacer}),r.createElement(de.a,{style:i?yr.durationOpacity:void 0},r.createElement(pr.a,Qt()({countdown:!0,timeMs:d},p,{color:"gray600",size:"small",style:i?yr.durationDark:void 0,weight:"bold",withCountdownSymbol:t}))),r.createElement(de.a,{style:yr.endSpacer})))}const br=e=>e?e.tracks[e.currentTrackId]:null,_r=Ne.a.c94b7d89,vr=Ne.a.eb6f9582,yr=J.a.create((e=>({displayNone:{display:"none"},container:{flexDirection:"row",alignSelf:"flex-end",alignItems:"center",justifyContent:"center"},voiceMessage:{alignSelf:"flex-end",flexDirection:Ee.a.isRTL?"row-reverse":"row",alignItems:"center",justifyContent:"center"},voiceMessageSent:{backgroundColor:e.colors.primary},voiceMessageReceived:{backgroundColor:e.colors.dmReceivedBubbleBackground},durationSpacer:{width:e.spaces.space4},durationOpacity:{opacity:.75},durationDark:{color:e.colors.whiteOnColor},iconColorDark:{color:e.colors.whiteOnColor},iconColorDefault:{color:e.colors.gray900},startSpacer:{width:e.spaces.space4},endSpacer:{width:e.spaces.space16}})));function Er({isSent:e,squared:t}){return[Sr.base,e?Sr.sent:Sr.received,t?e?Sr.sentSquared:Sr.receivedSquared:void 0]}const Sr=J.a.create((e=>({base:{borderRadius:e.borderRadii.xLarge,WebkitMaskImage:"url(data:image/png;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICRAEAOw==)"},sent:{borderBottomRightRadius:e.borderRadii.none},sentSquared:{borderTopRightRadius:e.borderRadii.none},received:{borderBottomLeftRadius:e.borderRadii.none},receivedSquared:{borderTopLeftRadius:e.borderRadii.none}})));class Cr extends r.Component{constructor(e,t){super(e,t),n()(this,"_fleetsDMConsumptionEnabled",this.context.featureSwitches.isTrue("responsive_web_fleets_dm_consumption_enabled")),n()(this,"_handleIsFleetAvailable",(e=>{const{isFleetAttachmentAvailable:t}=this.state;e!==t&&this.setState({isFleetAttachmentAvailable:e})})),this.state={isFleetAttachmentAvailable:!As(e.entry)}}render(){const{entry:e,isSent:t,onCtaClick:i,onCtaImpression:s}=this.props,{isFleetAttachmentAvailable:n}=this.state,{message_data:a}=e,o=a&&a.attachment?a.attachment:{},c=e.marked_as_spam,l=_t(e),d=!!a&&!!a.ctas,h=bt(e),p=(e=>{const{message_data:t}=e;if(!t)return!1;if(_t(e)&&!vt(e))return!1;if(!t.text)return!1;const i=Object(ft.parse)(t.text);if(!i||0===i.length)return!1;const s=i.sort(((e,t)=>t.indices[1]-e.indices[1])).reduce(((e,t)=>`${e.slice(0,t.indices[0])}${e.slice(t.indices[1])}`),t.text).trim();return i.length<=10&&0===s.length})(e),u=!(h&&p),m=vt(e);let f;f=o.sticker?r.createElement(jn,{sticker:o.sticker}):this._renderDMMessage(h,d,u);const g=c?r.createElement(Dn,{conversationId:e.conversation_id,dmId:e.id},f):f,b=l&&!m&&!Object(C.e)(null==a?void 0:a.attachment,this.context.featureSwitches),_=[this._fleetsDMConsumptionEnabled&&m&&n&&Rr.fleetRoot,t?Rr.isSent:Rr.isReceived,d&&Rr.withCta,b?Rr.mediaRoot:Rr.flexShrink,this.props.style];return r.createElement(de.a,{style:_},g,a&&a.ctas?r.createElement(os,{callToActions:a.ctas,isSent:t,onCtaClick:i,onImpression:s,withSticker:!!o.sticker||p,withUserText:h}):null)}_renderDMMessage(e,t,i){const{entry:s,isActive:n,isDmNsfwMediaFilterEnabled:a,isFirstRapidFire:o,isLowQuality:c,isRapidFire:l,isSent:d,isTrusted:h,displaySensitiveMedia:p}=this.props,{message_data:u,error:m}=s,f=u&&{...u,entities:u&&u.entities||void 0,error:m},g=null==f?void 0:f.attachment,b={isActive:n,isFailedDraft:!!m,isFirstRapidFire:o,isRapidFire:l,isSent:d,withCta:t,withMessageBubble:i};if(f&&g){if(g.tweet)return r.createElement(Zn,Qt()({conversationId:s.conversation_id,displaySensitiveMedia:p,hasUserText:e,isDmNsfwMediaFilterEnabled:a,isTrusted:h,messageData:f},b));if(g.photo||g.animated_gif||g.video)return g.video&&Object(C.e)(g,this.context.featureSwitches)?r.createElement(fr,{isLowQuality:c,isSent:!!d,isTrusted:h,media:g.video,messageId:s.id}):r.createElement(xn,Qt()({displaySensitiveMedia:p,entry:s,hasUserText:e,isDmNsfwMediaFilterEnabled:a,isTrusted:h,messageData:f},b));if(g.card)return r.createElement(Ss,Qt()({cardUrl:g.card,conversationId:s.conversation_id,hasUserText:e,messageData:f},b));if(g.fleet)return r.createElement(en,Qt()({entry:s,fleetId:g.fleet,hasUserText:e,messageData:f,onIsFleetAvailable:this._handleIsFleetAvailable},b))}return r.createElement(Fn,Qt()({},b,{messageData:f}))}}n()(Cr,"contextType",o.a);const Rr=J.a.create((e=>({flexShrink:{flexShrink:1},fleetRoot:{flex:.7},mediaRoot:{flex:1},isSent:{alignItems:"flex-end"},isReceived:{alignItems:"flex-start"},withCta:{alignItems:"stretch"}})));var wr=Cr;const Ar=J.a.create((e=>({avatar:{borderRadius:e.borderRadii.infinite}})));var xr=({showAvatar:e,size:t="xLarge",user:i})=>e?r.createElement(pe.default,{accessibilityLabel:i.name,circle:!0,link:{pathname:`/${i.screen_name}`},size:t,style:Ar.avatar,uri:i.profile_image_url_https}):r.createElement(de.a,{style:[Ar.avatar,pe.default.getSizeStyle(t)]}),Ir=i("B3eJ");function Tr({color:e,isActive:t,size:i,...s}){const n=r.useContext(hr),[a,o]=r.useState(.5),[c]=n.playerState;r.useEffect((()=>{t&&c&&c.isPlaying&&o(Math.random())}),[t,c]);const l=t&&(null==c?void 0:c.isPlaying),d=i+2*Mr,h=[Or.container,s.style,{width:i,height:i}];return r.createElement(de.a,{style:h},r.createElement(de.a,{style:[Or.container,Or.transitionOpacity,l?Or.show:Or.hide]},Se.a.reducedMotionEnabled?null:r.createElement(Ir.a,{audioLevel:a,color:e,paused:!l,size:i})),r.createElement(de.a,{style:[Or.border,{width:d,height:d},Or.transitionOpacity,t?Or.show:Or.hide]}))}const Mr=parseInt(J.a.theme.spaces.space2,10),Or=J.a.create((e=>({container:{alignItems:"center",justifyContent:"center",pointerEvents:"none"},border:{position:"absolute",top:-1*Mr,left:-1*Mr,backgroundColor:e.colors.navigationBackground,borderRadius:e.borderRadii.infinite},transitionOpacity:{transition:"opacity 0.2s 0s ease-in-out"},hide:{opacity:0},show:{opacity:1}})));var kr=i("uArA"),Lr="messageEntry";const Dr={element:"cta_dm"},Pr={isGroupDM:!1,isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1};class Fr extends r.Component{constructor(...e){super(...e),n()(this,"_handleClick",Object(kr.a)((()=>{const{entry:{error:e,id:t,is_draft:i},isActive:s,setActiveEntry:n}=this.props;i||e||(n(s?null:t),this._handleScribeMessageEntryClick())}))),n()(this,"_handleScribeMessageEntryClick",(()=>{const{isActive:e}=this.props;if(!pt.a.isEnabled&&!e){const{entry:e}=this.props,t={component:"message",element:Object(C.a)(e),action:"click"};this._scribeAction(t)}})),n()(this,"_handleCtaImpression",(()=>{this._scribeAction({...Dr,action:"show"})})),n()(this,"_handleCtaClick",(()=>{this._scribeAction({...Dr,action:"click"})})),n()(this,"_isDMVoiceMessage",(()=>{var e;return Object(C.e)(null==(e=this.props.entry.message_data)?void 0:e.attachment,this.context.featureSwitches)}))}shouldComponentUpdate(e){return!Object(le.a)(this.props,e)}render(){const{isActive:e,isSent:t,user:i}=this.props,s=this._getRapidFireProps(),n=s.isRapidFire&&!s.isLastRapidFire,a=[Nr.root.base,n&&Nr.root.footerSpacing];if(!i)return null;const o=!pt.a.isEnabled||t;return r.createElement(de.a,{style:a},r.createElement(ee.a,{accessible:!0,"aria-expanded":o&&e?"true":"false",interactiveStyles:null,onPress:o?this._handleClick:void 0,style:[t?Nr.root.sent:Nr.root.received],testID:Lr},(({isFocused:e,isHovered:t})=>this._renderMessage({isFocused:e,isHovered:t,rapidFireProps:s}))),this._renderFooter(s))}_renderMessage({isHovered:e,isFocused:t,rapidFireProps:i}){const{displaySensitiveMedia:s,entry:n,isActive:a,isDmNsfwMediaFilterEnabled:o,isLowQuality:c,isVoiceMessageActive:l,isWide:d,isReadOnly:h,isSent:p,isTrusted:u,perspective:m,scribeVoiceMessage:f,setShouldFreezeUpdates:g}=this.props,{isFirstRapidFire:b,isRapidFire:_}=i,v=[p?Nr.messageContainer.sent:Nr.messageContainer.received,d?Nr.messageContainer.wide:Nr.messageContainer.narrow,p&&d&&Nr.messageContainer.sentWide,!p&&d&&Nr.messageContainer.receivedWide],y=u&&!h,E=this._isDMVoiceMessage();return r.createElement(de.a,{style:v},n.error?null:r.createElement(Wt,{containerIsActive:a,containerIsFocused:t,containerIsHovered:e,entry:n,isDraft:!!n.is_draft,isSent:p,onReportMessage:E&&f?()=>f.report({isLowQuality:c,isTrusted:u}):void 0,perspective:m,setShouldFreezeUpdates:g,shouldShowReactionButton:y,style:E&&Ce(J.a.theme.scale).actionsContainer({isSent:p,isVoiceMessageActive:l})}),r.createElement(wr,{displaySensitiveMedia:s,entry:n,isActive:a,isDmNsfwMediaFilterEnabled:o,isFirstRapidFire:b,isLowQuality:c,isRapidFire:_,isSent:p,isTrusted:u,key:n.id,onCtaClick:this._handleClick,onCtaImpression:this._handleCtaImpression,style:E&&Ce(J.a.theme.scale).messageContainer({isSent:p,isVoiceMessageActive:l})}),this._possiblyRenderUserAvatar(i))}_renderFooter({isLastRapidFire:e,isRapidFire:t}){var i,s;const{isGroupDM:n,entry:a,isActive:o,isSent:c,participants:l,user:d}=this.props;return r.createElement(ts,{conversationId:a.conversation_id,entryId:a.id,entryText:null==(i=a.message_data)?void 0:i.text,entryTime:a.time,isActive:o,isDraft:!!a.is_draft,isError:!!a.error,isGroupDM:n,isLastRapidFire:e,isRapidFire:t,isSent:c,localMediaId:null==(s=a.message_data)?void 0:s.localMediaId,onPress:this._handleClick,participants:l,user:d})}_possiblyRenderUserAvatar({isLastRapidFire:e,isRapidFire:t}){const{isSent:i,isVoiceMessageActive:s,user:n}=this.props,a=this._isDMVoiceMessage();if(!n||i&&!a)return null;const{DMUserAvatarSizePx:o,DMUserAvatarSizeType:c}=ye(J.a.theme.scale),l={showAvatar:!!a||(!t||!!e),size:c,user:n},d=[Nr.userAvatar.base,i?Nr.userAvatar.sent:Nr.userAvatar.received,a&&Ce(J.a.theme.scale).userAvatar({isVoiceMessageActive:s,isSent:i})];return r.createElement(de.a,{style:Nr.userAvatar.container},i?null:r.createElement(de.a,{style:Nr.userAvatar.spacer}),a?r.createElement(Tr,{color:i?J.a.theme.colors.primary:J.a.theme.colors.text,isActive:!!s,size:o,style:d}):null,r.createElement(de.a,{style:d},r.createElement(xr,l)))}_scribeAction(e){const{analytics:t}=this.props;t.scribe({...e})}_getRapidFireProps(){return{isFirstRapidFire:this.props.isFirstRapidFire,isLastRapidFire:this.props.isLastRapidFire,isRapidFire:this.props.isRapidFire}}}n()(Fr,"contextType",o.a),n()(Fr,"defaultProps",Pr),n()(Fr,"contextType",o.a);var Br=Object(Ze.a)(ke(function(e){function t(t){const{entry:i}=t,s=r.useContext(hr),[n]=s.activeVoiceMessage,{scribeAction:a}=s,[o]=n,c=o===i.id,l={...t,isVoiceMessageActive:c,scribeVoiceMessage:a};return r.createElement(e,l)}return t.defaultProps=Pr,t}(Fr)));const Nr={root:J.a.create((e=>({base:{flexDirection:"column",paddingBottom:e.spaces.space20},received:{cursor:"default",alignItems:"flex-start"},sent:{cursor:"pointer",alignItems:"flex-end"},footerSpacing:{paddingBottom:e.spaces.space2}}))),messageContainer:J.a.create((e=>({sent:{flexDirection:"row",justifyContent:"flex-end"},received:{flexDirection:"row-reverse",justifyContent:"flex-end"},narrow:{width:"100%"},wide:{width:Xt},receivedWide:{paddingRight:e.spaces.space12},sentWide:{paddingLeft:e.spaces.space12}}))),userAvatar:J.a.create((e=>({container:{flexDirection:"row",alignItems:"flex-end"},base:{position:"absolute"},sent:{right:0},received:{left:0},spacer:{width:ye(e.scale).DMUserAvatarSpacerPx}})))};var Ur=i("H4nC");class jr extends r.Component{shouldComponentUpdate(e){return!Object(le.a)(this.props,e)}render(){const{conversation:e,entry:t,isActive:i,isWide:s,isFirstRapidFire:n,isLastRapidFire:a,isRapidFire:o,perspective:c,scribeNamespace:d,setActiveEntry:h,setShouldFreezeUpdates:p}=this.props;if(Object(G.b)(t)||Object(G.e)(t)){const{conversation_id:u,low_quality:m,participants:f,read_only:g,trusted:b,type:_}=e,{message_data:{sender_id:v}={}}=t,y=void 0===u||b;return r.createElement(Br,{entry:t,isActive:i,isFirstRapidFire:n,isGroupDM:_===l.CONVERSATION_TYPE.GROUP,isLastRapidFire:a,isLowQuality:!!m,isRapidFire:o,isReadOnly:g,isSent:v===c,isTrusted:!!y,isWide:s,participants:f,perspective:c,scribeNamespace:d,senderId:v,setActiveEntry:h,setShouldFreezeUpdates:p})}return Object(G.a)(t)?r.createElement(_e,{conversation:e,entry:t,entryType:t.type,perspective:c}):Object(G.d)(t)?r.createElement(Ur.a,{entry:t,isCompact:!1}):null}}n()(jr,"defaultProps",{isActive:!1});const Hr=Object(f.createSelector)(((e,t)=>{const i=Object(Ve.o)(e,t.conversationId),s=i&&Object(K.a)(i);return s&&Object(l.selectEntry)(e,s)}),(e=>({lastEntry:e})));var Wr=Object(u.c)(Hr);const zr=Object(f.createSelector)(((e,t)=>E.e.selectMany(e,t.userIds||[])),(e=>({users:e})));var Vr=Object(Kt.b)(zr),qr=i("Enqy"),Gr=i("+/1j");const Qr="overflow",Kr=(e,t)=>e.id_str<t.id_str?-1:e.id_str>t.id_str?1:0,$r={stiffness:1e3,damping:70},Yr=140,Xr={scale:Object(qr.spring)(1,$r),translateY:Object(qr.spring)(0,$r)},Jr=(e,t)=>({key:e.id_str,data:e,style:Xr}),Zr=Object(F.a)({translateY:Yr,scale:0}),ea=Object(F.a)({scale:Object(qr.spring)(1,$r),translateY:Object(qr.spring)(Yr,$r)}),ta=[{key:"bubble",style:{scale:Object(qr.spring)(1,$r),translateY:Object(qr.spring)(0,$r)}}],ia=Object(F.a)({translateY:Yr,scale:0}),sa=Object(F.a)({scale:Object(qr.spring)(1,$r),translateY:Object(qr.spring)(Yr,$r)}),na=e=>[isFinite(e.scale)&&{scale:e.scale.toFixed(3)},isFinite(e.translateY)&&{translateY:`${Math.round(e.translateY)}%`}].filter(Boolean);class ra extends r.Component{constructor(...e){super(...e),n()(this,"state",{isHidden:!0}),n()(this,"_afterLeave",(()=>{const{users:e}=this.props;this.setState((t=>({isHidden:0===e.length})))}))}componentDidUpdate(e,t){this.state.isHidden&&this.props.users&&this.props.users.length&&this.setState({isHidden:!1})}shouldComponentUpdate(e,t){return!Object(le.a)(this.props,e)||!Object(le.a)(this.state,t)}render(){const{isHidden:e}=this.state,{users:t}=this.props,i=t.sort(Kr).slice(0,5).map(Jr);return t.length>5&&i.push({key:Qr,style:Xr}),r.createElement(de.a,{style:[aa.root,e&&aa.hidden]},r.createElement(de.a,{style:aa.avatarRow},r.createElement(qr.TransitionMotion,{styles:i,willEnter:Zr,willLeave:ea},(e=>r.createElement(r.Fragment,null,e.map(((e,i)=>{if(e.style.scale<=.05)return null;const s=na(e.style);return e.key===Qr?r.createElement(de.a,{key:e.key,style:[aa.avatar,aa.avatarSpacer,aa.overflowAvatar,{transform:s}]},r.createElement(Gr.a,{style:aa.overflowAvatarText},"+",t.length-5)):r.createElement(de.a,{key:e.key,style:[aa.avatar,{transform:s}]},r.createElement(pe.default,{accessibilityLabel:e.data&&e.data.name,size:"xLarge",uri:e.data&&e.data.profile_image_url_https}))})))))),r.createElement(qr.TransitionMotion,{didLeave:this._afterLeave,styles:t.length>0?ta:[],willEnter:ia,willLeave:sa},(e=>r.createElement(r.Fragment,null,e.map((e=>r.createElement(de.a,{key:e.key,style:[aa.messageBubble,{transform:na(e.style)}]},r.createElement(de.a,{style:aa.dot}),r.createElement(de.a,{style:[aa.dot,aa.dot1]}),r.createElement(de.a,{style:[aa.dot,aa.dot2]}))))))))}}const aa=J.a.create((e=>({root:{flexDirection:"row",paddingBottom:e.spaces.space20,paddingRight:e.spaces.space12,width:"calc(100% * 7/8)",position:"relative",transitionProperty:"height, padding-bottom",transitionDuration:"0.2s",overflow:"hidden"},hidden:{paddingBottom:0,paddingRight:0,height:0,width:0},avatarRow:{display:"inline-flex",alignItems:"flex-start",flexDirection:"row"},avatar:{marginEnd:e.spaces.space12,transformOrigin:"50% 100%"},avatarSpacer:{height:e.spaces.space40,width:e.spaces.space40},overflowAvatar:{borderRadius:e.borderRadii.infinite,backgroundColor:e.colors.primary,alignItems:"center",justifyContent:"center"},overflowAvatarText:{color:"white"},messageBubble:{alignItems:"center",borderRadius:e.borderRadii.infinite,maxWidth:"100%",paddingVertical:e.spaces.space12,paddingHorizontal:e.spaces.space16,backgroundColor:e.colors.gray50,borderBottomLeftRadius:e.borderRadii.none,borderColor:e.colors.gray200,flexDirection:"row",height:e.spaces.space40,overflow:"hidden",transformOrigin:"0% 100%"},dot:{display:"flex-inline",position:"relative",width:e.spaces.space12,height:e.spaces.space12,overflow:"hidden",borderRadius:e.borderRadii.infinite,backgroundColor:e.colors.gray600,marginEnd:e.spaces.space4,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationKeyframes:[{"15%":{transform:[{scale:1.4}],backgroundColor:e.colors.primary},"30%":{transform:[{scale:1}]}}]},dot1:{animationDelay:"0.1s"},dot2:{animationDelay:"0.2s"}})));var oa=Vr(ra),ca=i("tn7R");class la extends r.PureComponent{constructor(...e){super(...e),n()(this,"_timers",{}),n()(this,"state",{forceHide:!1,userIds:[]}),n()(this,"_handleLivePipelineUpdate",(e=>{const{user_id:t}=e.dm_typing;t!==this.context.loggedInUserId&&(this._timers[t]&&clearTimeout(this._timers[t]),this._timers[t]=setTimeout((()=>this._removeAvatar(t)),4e3),this.setState((e=>({forceHide:!1,userIds:[...e.userIds.filter((e=>e!==t)),t]}))))})),n()(this,"_removeAvatar",((e,t=!1)=>{this.setState((i=>{const s=i.userIds.filter((t=>t!==e));return{forceHide:t&&0===s.length,userIds:s}}))}))}componentDidMount(){this._initializeLivePipeline()}UNSAFE_componentWillReceiveProps(e){if(e.lastEntry){const{lastEntry:t={}}=this.props||{},{lastEntry:i}=e;t&&t.id!==i.id&&i.message_data&&this._removeAvatar(i.message_data.sender_id,!0)}}componentDidUpdate(e,t){e.conversationId!==this.props.conversationId&&(this._teardownLivePipeline(),this._initializeLivePipeline())}componentWillUnmount(){this._teardownLivePipeline()}render(){const{forceHide:e,userIds:t}=this.state;return!e&&r.createElement(oa,{conversationId:this.props.conversationId,userIds:t})}_teardownLivePipeline(){Object(ca.a)(this._timers).forEach((e=>clearTimeout(e))),this._livePipelineSubscription&&this._livePipelineSubscription.teardown()}_initializeLivePipeline(){const{conversationId:e}=this.props;Object(a.h)().then((({LivePipeline:t})=>{t.isSupportedAndReady(this.context.featureSwitches)&&this.context.featureSwitches.isTrue("livepipeline_dm_features_enabled")&&!this._livePipelineSubscription&&(this._livePipelineSubscription=t.get().subscribeTopic(`/dm_typing/${e}`,this._handleLivePipelineUpdate))}))}}n()(la,"contextType",o.a);var da=Wr(la),ha=i("Fz18"),pa=i("yw4N"),ua=i("dPJJ"),ma=i("zrc3"),fa=(i("8Clt"),i("A9rn")),ga=i("pQ3Z"),ba=i.n(ga),_a=i("VY6S"),va=i("Resy");class ya{constructor(e){n()(this,"_trackScroll",(()=>{this._programmaticScroll?this._programmaticScroll=!1:this._lastScrollTs=Date.now()})),n()(this,"_normalize",(()=>{this._wrapperNode&&0!==this._transform&&this._viewport&&(this._wrapperNode.style.transform="",this._viewport.scrollBy(-1*this._transform),this._transform=0)})),n()(this,"_normalizeIfNeeded",(()=>{if(!this._wrapperNode||!this._viewport||0===this._transform)return;const e=this._viewport,{top:t,height:i}=this._wrapperNode.getBoundingClientRect(),s=new va.a(t,i),n=s.translateBy(-1*this._transform),r=e.getRect();r.contains(n.getTop())||r.contains(n.getBottom())||r.contains(s.getTop())||r.contains(s.getBottom())?this._normalize():this._debouncedNormalize()})),this._transform=0,this._viewport=e,this._lastScrollTs=0,this._debouncedNormalize=Object(_a.a)(this._normalize,500),this._removeScrollListener=e.addScrollListener(this._normalizeIfNeeded),this._removeScrollTracker=e.addScrollListener(this._trackScroll)}setWrapperNode(e){this._wrapperNode=e}teardown(){this._removeScrollListener(),this._removeScrollTracker(),delete this._viewport}offsetBy(e){if(Math.abs(e)<=.5)return;const t=this._wrapperNode,i=Date.now()-this._lastScrollTs;!t||i>=500?(this._programmaticScroll=!0,this._viewport&&this._viewport.scrollBy(e)):(this._transform=this._transform-e,t.style.transform=`translateY(${this._transform}px)`,this._normalizeIfNeeded())}}class Ea extends r.Component{constructor(e,t){super(e,t),n()(this,"_updatesSuspended",!1),n()(this,"_handleHeightsUpdate",((e,t)=>{const{anchoring:i}=this.props;this._scrollBy(i.offsetCorrection(e,t))})),n()(this,"_receiveWrapperNode",(e=>this._offsetHandler.setWrapperNode(e))),n()(this,"_handleRefUpdate",(e=>{this._ref=e})),n()(this,"_handleEnterFullscreen",(()=>{this._updatesSuspended=!0,this._ref&&this._ref.freezeUpdates()})),n()(this,"_handleExitFullscreen",(()=>{this._updatesSuspended=!1,this.forceUpdate(),this._ref&&this._ref.resumeUpdates()}));const i=this._findInitialAnchor(e.initialAnchors||[]);this._initialItemIndex=i?i.anchorIndex:0,this._initialAnchor=i&&i.anchor,this._offsetHandler=new ya(e.viewport)}UNSAFE_componentWillMount(){const{viewport:e,anchoring:t}=this.props;this.setState({scrollHeadroom:t.initialScrollHeadroom(e)})}shouldComponentUpdate(e,t){const i=!ba()(this.props,e)||!ba()(this.state,t);return!this._updatesSuspended&&i}componentDidMount(){this._initialAnchor&&this._scrollToAnchor(this._initialAnchor),this._requestAnimationFrame((()=>{const{retryPositionRestoration:e,list:t,onPositionRestored:i}=this.props;if(e&&this._initialAnchor){!!t.find((({id:e})=>this._initialAnchor&&e===this._initialAnchor.id))&&this._initialAnchor&&this._scrollToAnchor(this._initialAnchor)}i(),this._requestAnimationFrame((()=>{this._relaxScrollHeadroom()}))})),this._unlistenFullscreenEnter=ua.a(this._handleEnterFullscreen),this._unlistenFullscreenExit=ua.b(this._handleExitFullscreen)}getAnchors(e){const t=e||this._ref&&this._ref.getPositioning();return t?this.props.anchoring.anchorCandidates(t):[]}getPositioning(){return this._ref&&this._ref.getPositioning()}componentWillUnmount(){this._unmounted=!0,this._offsetHandler.teardown(),this._unlistenFullscreenEnter&&this._unlistenFullscreenEnter(),this._unlistenFullscreenExit&&this._unlistenFullscreenExit()}render(){const{list:e,renderItem:t,renderList:i}=this.props,{scrollHeadroom:s}=this.state;return r.createElement("div",{ref:this._receiveWrapperNode,style:{paddingBottom:s}},i({initialItemIndex:this._initialItemIndex,list:e,renderItem:t,ref:this._handleRefUpdate,onHeightsUpdate:this._handleHeightsUpdate}))}_scrollToAnchor(e){const{anchoring:t}=this.props,i=this._ref&&this._ref.getPositioning();i&&this._scrollBy(t.offsetToAnchor(i,e))}_findInitialAnchor(e){const{list:t}=this.props;return e.map((e=>{const i=Object(ma.a)(t,(({id:t})=>t===e.id));return i>=0?{anchorIndex:i,anchor:e}:null})).find((e=>e))}_relaxScrollHeadroom(){const e=this._ref&&this._ref.getPositioning();if(e){const{anchoring:t}=this.props,i=t.scrollHeadroom(e),{scrollHeadroom:s}=this.state;i<s&&this.setState({scrollHeadroom:i})}}_scrollBy(e){this._offsetHandler.offsetBy(e)}_requestAnimationFrame(e){return window.requestAnimationFrame((()=>{this._unmounted||e()}))}}n()(Ea,"defaultProps",{anchoring:fa.a});var Sa=i("AOWc"),Ca=i("180P"),Ra=i("Ey+e"),wa=i("64vW"),Aa=i("QFTV");const xa=(e,t,i)=>{if(t<0||t>=e.length)return-1;if(i(e[t]))return t;for(let s=1;;s++){const n=t-s,r=t+s,a=n<0,o=r>=e.length;if(a&&o)break;if(!o&&i(e[r]))return r;if(!a&&i(e[n]))return n}return-1};var Ia=({list:e,nextList:t,sliceStart:i,sliceEnd:s})=>{const n=t.reduce(((e,{id:t})=>(e[t]=!0,e)),{}),r=xa(e,i,(({id:e})=>!Object(Aa.a)(e)&&n.hasOwnProperty(e)&&n[e]));if(-1===r)return null;let a=Object(ma.a)(t,(({id:t})=>e[r].id===t));Object(Sa.a)(a>=0,"newSliceStart should be defined if we found a common item");return r>0&&Object(Aa.a)(e[r-1].id)&&a>0&&Object(Aa.a)(t[a-1].id)&&(a-=1),{sliceStart:a,sliceEnd:Math.min(t.length,a+s-i)}},Ta=i("I7xG"),Ma=i("jHwr"),Oa=i("+d3d");const ka={heightsReady:!0};class La extends r.PureComponent{constructor(e,t){super(e,t),n()(this,"_updatesSuspended",!1),n()(this,"freezeUpdates",(()=>{this._updatesSuspended=!0})),n()(this,"resumeUpdates",(()=>{this._updatesSuspended=!1,this._scheduleUpdate()})),n()(this,"_handleHeightsChange",(e=>{this._postRenderProcessing({hasListChanged:!1,newHeights:e})})),n()(this,"_handleRefUpdate",(e=>{this._ref=e})),n()(this,"_setNecessarySlice",((e,t)=>{const{sliceStart:i,sliceEnd:s}=this.state,n={start:i,end:s},r={start:e,end:t},{start:a,end:o}=((e,t)=>{if(t.start>=e.start&&t.end<=e.end)return e;if(t.start>=e.end||t.end<=e.start)return t;{const i=Math.max(e.start-t.start,t.end-e.end);return{start:Math.min(e.start+i,t.start),end:Math.max(e.end-i,t.end)}}})(n,r);this._setSlice(a,o)})),n()(this,"_setSlice",((e,t)=>{if(this._updatesSuspended)return;const{sliceStart:i,sliceEnd:s}=this.state;e===i&&t===s||this.setState({sliceStart:e,sliceEnd:t})}));const{list:i,initialItemIndex:s}=this.props;this._assumedItemHeight=e.assumedItemHeight,this._getSlice=Object(Ta.a)(this,(e=>e.list),((e,t)=>t.sliceStart),((e,t)=>t.sliceEnd),((e,t,i)=>e.slice(t,i))),this._getRectangles=Object(Ta.a)(this,(e=>e.list),((e,t,i)=>i._heights),((e,t,i)=>i._assumedItemHeight),Da),this._heights={};const{cacheKey:r,heightCache:a}=this.props;r&&a.hasOwnProperty(r)&&(this._heights=a[r]),this.state=this._getDefaultSlice(i,s);const o=Object(Ma.a)((()=>this._criticalUpdate()),window.requestAnimationFrame);this._scheduleUpdate=window.requestIdleCallback?Object(Ma.a)((()=>this._criticalUpdate()),window.requestIdleCallback):o,this._schedulePositioningNotification=Object(Ma.a)((()=>this._notifyPositioning()),window.requestIdleCallback?e=>window.requestIdleCallback(e,{timeout:500}):window.requestAnimationFrame),this._handleScroll=Object(Oa.a)(o,100,{trailing:!0}),this._scheduleDebouncedUpdate=Object(_a.a)((()=>{window.requestAnimationFrame((()=>{this._debouncedUpdate()}))}),500),this._removeDebouncedListener=e.viewport.addScrollListener(this._scheduleDebouncedUpdate)}componentDidMount(){this._unlistenScroll=this.props.viewport.addScrollListener(this._handleScroll),this._postRenderProcessing({hasListChanged:!0})}componentWillUnmount(){this._unmounted=!0,this._unlistenScroll&&this._unlistenScroll(),this._removeDebouncedListener();const{cacheKey:e,heightCache:t}=this.props;e&&(t[e]=this._heights)}componentDidUpdate(e){this._postRenderProcessing({hasListChanged:e.list!==this.props.list})}UNSAFE_componentWillReceiveProps(e){const{list:t}=this.props,{sliceStart:i,sliceEnd:s}=this.state,n=e.list;if(n!==t){const e=Ia({list:t,nextList:n,sliceStart:i,sliceEnd:s})||this._getDefaultSlice(n);this._setSlice(e.sliceStart,e.sliceEnd)}}UNSAFE_componentWillUpdate(){this._prevPositioning=this.getPositioning()}getPositioning(){const{sliceStart:e,sliceEnd:t}=this.state;return new D.a({viewportRectangle:this._getRelativeViewportRect(),list:this.props.list,rectangles:this._getRectangles(),sliceStart:e,sliceEnd:t})}render(){const{renderList:e,renderItem:t}=this.props,{blankSpaceAbove:i,blankSpaceBelow:s}=this._computeBlankSpace();return r.createElement(wa.a.Provider,{value:ka},e({ref:this._handleRefUpdate,list:this._getSlice(),blankSpaceAbove:i,blankSpaceBelow:s,renderItem:t,onHeightsChange:this._handleHeightsChange}))}_computeBlankSpace(){const{list:e}=this.props,{sliceStart:t,sliceEnd:i}=this.state,s=this._getRectangles(),n=0===e.length?0:s[e[t].id].getTop()-s[e[0].id].getTop(),r=Object(K.a)(e);return{blankSpaceAbove:n,blankSpaceBelow:i>=e.length||!r?0:s[r.id].getBottom()-s[e[i].id].getTop()}}_postRenderProcessing({hasListChanged:e,newHeights:t}){const{wasHeightChange:i}=this._recordHeights(t);if(i||e){const e=this._prevPositioning;if(e){const{onHeightsUpdate:t}=this.props;t(e,this.getPositioning())}}const{minimumOffscreenToViewportRatio:s,preferredOffscreenToViewportRatio:n}=this.props;e||!this._sliceIncludesScaledViewport(s)?this._scheduleUpdate():this._sliceIncludesScaledViewport(n)||this._scheduleDebouncedUpdate(),this._schedulePositioningNotification()}_sliceIncludesScaledViewport(e){const{sliceStart:t,sliceEnd:i}=this._computeSlice({offscreenToViewportRatio:e});return t>=this.state.sliceStart&&i<=this.state.sliceEnd}_recordHeights(e){if(!this._ref)return{heightDelta:0,wasHeightChange:!1};const t=e||this._ref.getItemHeights();let i=!1;const s=Object.keys(t).reduce(((e,s)=>{const n=this._heights.hasOwnProperty(s)?this._heights[s]:this._assumedItemHeight,r=t[s];return i=i||n!==r,e+(r-n)}),0);return i&&(this._heights=Object.assign({...this._heights},t)),{wasHeightChange:i,heightDelta:s}}_criticalUpdate(){const{sliceStart:e,sliceEnd:t}=this._computeSlice({offscreenToViewportRatio:this.props.minimumOffscreenToViewportRatio});"number"==typeof e&&"number"==typeof t&&this._setNecessarySlice(e,t)}_debouncedUpdate(){const{sliceStart:e,sliceEnd:t}=this._computeSlice({offscreenToViewportRatio:this.props.preferredOffscreenToViewportRatio});"number"==typeof e&&"number"==typeof t&&this._setSlice(e,t)}_computeSlice({offscreenToViewportRatio:e}){const{list:t}=this.props;if(this._unmounted||0===t.length)return{};const i=this._getRelativeViewportRect(),s=i.getHeight()*e,n=i.getTop()-s,r=i.getBottom()+s,a=this._getRectangles(),o=Object(ma.a)(t,(({id:e})=>a[e].getBottom()>n)),c=o>=0?o:t.length-1,l=Object(ma.a)(t,(({id:e})=>a[e].getTop()>=r),c),d=l>=0?l:t.length;return this._schedulePositioningNotification(),{sliceStart:c,sliceEnd:d}}_notifyPositioning(){if(!this._unmounted){const{onPositioningUpdate:e}=this.props;e(this.getPositioning())}}_getRelativeViewportRect(){if(!this._ref)return new va.a(0,0);const e=this._ref.getWrapperNode();if(!e)return new va.a(0,0);const t=Math.ceil(e.getBoundingClientRect().top);return this.props.viewport.getRect().translateBy(-t)}_getDefaultSlice(e,t=0){const{viewport:i}=this.props,s=i.getRect().getHeight(),n={...this,props:{...this.props,list:e},state:{...this.state},context:{...this.context},refs:null},r=this._getRectangles(n),{id:a}=e[t],o=r[a].getBottom(),c=Object(ma.a)(e,(({id:e})=>r[e].getTop()-o>=s),t),l=c>=0?c:e.length;return{sliceStart:t,sliceEnd:Math.min(e.length,l)}}}n()(La,"defaultProps",{assumedItemHeight:400,heightCache:{},initialItemIndex:0,minimumOffscreenToViewportRatio:.5,preferredOffscreenToViewportRatio:2.5});const Da=(e,t,i)=>{const s={};return e.reduce(((e,{id:n})=>{const r=t.hasOwnProperty(n)?t[n]:i,a=new va.a(e,r);return s[n]=a,a.getBottom()}),0),s};var Pa=La,Fa=i("SrIh"),Ba=i("b1wW"),Na=i("E6XO"),Ua=i("06eB"),ja=i.n(Ua),Ha=i("aITJ");const Wa=()=>window.performance?window.performance.now():Date.now();class za extends r.Component{constructor(e,t){super(e,t),n()(this,"_perfReported",!1),n()(this,"_observeElement",(e=>{const t=this._resizeObserver;t&&(t.disconnect(),t.observe(e))})),n()(this,"_handleResize",(e=>{const{onHeightChanged:t,id:i}=this.props,[s]=e;this._isResizeObserverHeightUpdatesEnabled&&s&&s.contentRect.height!==this._currentHeight&&(this._currentHeight=s.contentRect.height,t(i,s.contentRect.height)),this._perfReported||(this.props.onVisible(i,Wa()-this._perfStart),this._perfReported=!0)})),n()(this,"_setRef",(e=>{const{id:t,setAPI:i}=this.props;e?(this._element=e,i(t,this),this._observeElement(e)):(i(t,void 0),this._element=void 0)})),this._isResizeObserverHeightUpdatesEnabled=this.context.featureSwitches.isTrue("responsive_web_vs_config_resize_observer_enabled")&&Ha.b.isDesktopOS()&&Ha.b.isSafari(),this._resizeObserver=new window.ResizeObserver(this._handleResize),this._perfStart=Wa()}shouldComponentUpdate(e){const{render:t,data:i}=this.props;return t!==e.render||!ja()(i,e.data)}componentWillUnmount(){this._resizeObserver&&this._resizeObserver.disconnect()}componentDidUpdate(e){const{id:t,setAPI:i}=this.props;e.id!==t&&(i(e.id,void 0),i(t,this))}measureHeight(){return this._currentHeight=this._element?this._element.getBoundingClientRect().height:0,this._currentHeight}render(){const{data:e,render:t}=this.props;return r.createElement("div",{ref:this._setRef},t(e))}}n()(za,"contextType",o.a);var Va=i("iChn");class qa extends r.PureComponent{constructor(...e){super(...e),n()(this,"_cells",new Map),n()(this,"_heightUpdates",{}),n()(this,"_visibilityMeasurements",new Map),n()(this,"_handleItemVisible",((e,t)=>{this._visibilityMeasurements.has(e)||this._visibilityMeasurements.set(e,t)})),n()(this,"_reportVisibilityMeasurements",(()=>{if(!this._visibilityMeasurements.size)return;let e=0;this._visibilityMeasurements.forEach((t=>e+=t));const t=Math.round(e/this._visibilityMeasurements.size),i=Ha.b.isDesktopOS()?"scroller_legacy":"scroller_legacy_mobile";Na.c(`scroller:ttfv:${i}`,{duration_ms:t}),this._visibilityMeasurements.clear()})),n()(this,"_handleCellHeightChanged",((e,t)=>{this._heightUpdates[e]=t,this._flushHeightUpdates()})),n()(this,"_flushHeightUpdates",Object(Oa.a)((()=>{const{onHeightsChange:e}=this.props;e(this._heightUpdates),this._heightUpdates={}}),100,{trailing:!0})),n()(this,"_setCellRef",((e,t)=>{t?this._cells.set(e,t):this._cells.delete(e)})),n()(this,"_handleDivRefUpdate",(e=>{this._div=e}))}getWrapperNode(){return this._div}getItemHeights(){const{list:e}=this.props;return Object(Va.a)(e,(e=>e.id),(e=>{const t=this._cells.get(e.id);return t?t.measureHeight():0}))}componentWillUnmount(){this._reportVisibilityMeasurements()}render(){const{blankSpaceAbove:e,blankSpaceBelow:t}=this.props;return r.createElement("div",{ref:this._handleDivRefUpdate,style:{paddingTop:e,paddingBottom:t}},this._renderContent())}_renderContent(){const{renderItem:e,list:t}=this.props;return t.map((({data:t,id:i})=>r.createElement(za,{data:t,id:i,key:i,onHeightChanged:this._handleCellHeightChanged,onVisible:this._handleItemVisible,render:e,setAPI:this._setCellRef})))}}var Ga=i("oi7R"),Qa=i("aWzz"),Ka=i("Lqdf");const $a=e=>(Object(Fa.a)(`Fallback to slow hashing in VirtualScroller (type = ${e?e.type:""})`),Object(Ca.a)(e));class Ya extends r.Component{constructor(e,t){super(e,t),n()(this,"_onDemandRenderer",(e=>{const{minimumOffscreenToViewportRatio:t,preferredOffscreenToViewportRatio:i}=this.props;return r.createElement(Pa,Qt()({},e,{assumedItemHeight:this.props.assumedItemHeight,cacheKey:this.props.cacheKey,minimumOffscreenToViewportRatio:t,onPositioningUpdate:this._handlePositioningUpdate,preferredOffscreenToViewportRatio:i,renderList:this._viewRenderer,viewport:this._viewport}))})),n()(this,"_viewRenderer",(e=>r.createElement(qa,e))),n()(this,"_getItemRenderer",(()=>this._getMemoizedItemRenderer(this.props.renderer))),n()(this,"_getMemoizedItemRenderer",Object(ve.a)((e=>t=>t?t.presentational?t.renderNode():e(t.data):null))),n()(this,"_handleAnchorRendererRefUpdate",(e=>{this._anchorRenderer=e})),n()(this,"_handlePositionRestored",(()=>{const{onPositionRestored:e}=this.props;e(),this._edgeProximity=this._createEdgeProximity();const t=this._anchorRenderer&&this._anchorRenderer.getPositioning();t&&this._edgeProximity.handlePositioningUpdate(t)})),n()(this,"_handlePositioningUpdate",(e=>{this._edgeProximity&&this._edgeProximity.handlePositioningUpdate(e);const{onItemsRendered:t}=this.props;t&&t({positions:e.getRenderedItems(),viewport:e.getForViewport()})})),n()(this,"_getList",(()=>{const{identityFunction:e,items:t,header:i,footer:s}=this.props;return this._getMemoizedList(e,t,i,s)})),n()(this,"_getMemoizedList",Object(ve.a)(((e,t,i,s)=>{const n={},r=t.reduce(((t,i)=>{const s=e(i)||i.id||$a(i);return Object(Sa.a)("number"==typeof s||"string"==typeof s,"Item id must not be falsy"),n.hasOwnProperty(s)?Object(Fa.a)("Duplicate item id generated in VirtualScroller. Latter item will be discarded",{extra:{id:s}}):(t.push({data:{data:i},id:s}),n[s]=!0),t}),[]),a=i?{id:Aa.c,data:{presentational:!0,renderNode:()=>i}}:null,o=s?{id:Aa.b,data:{presentational:!0,renderNode:()=>s}}:null;return r.length?[...a?[a]:[],...r,...o?[o]:[]]:[]}))),this._viewport=e.viewport||t.viewport||Ga.a.root()}scrollToTop(e){this._viewport.scrollToTop()}isAtTop(){const e=this._anchorRenderer&&this._anchorRenderer.getPositioning();return(e&&e.getForViewport().getTop()||0)<50}adjustFocusBy(e){}UNSAFE_componentWillMount(){this._isManualScrollRestoration=window.history&&"manual"===window.history.scrollRestoration,this._loadStoredPosition(this.props)}UNSAFE_componentWillReceiveProps(e){const{cacheKey:t}=this.props;t!==e.cacheKey&&(this._preservePosition(this._customLocation),this._loadStoredPosition(e))}componentWillUnmount(){this._preservePosition(this._customLocation)}render(){const{cacheKey:e,items:t,noItemsRenderer:i,anchoring:s}=this.props;return t.length?r.createElement(Ea,{anchoring:s,initialAnchors:this._initialAnchors||[],key:e,list:this._getList(),onPositionRestored:this._handlePositionRestored,ref:this._handleAnchorRendererRefUpdate,renderItem:this._getItemRenderer(),renderList:this._onDemandRenderer,retryPositionRestoration:!this._isManualScrollRestoration,viewport:this._viewport}):i()}_preservePosition(e){if(this._anchorRenderer&&e){const t=this._anchorRenderer.getAnchors();e.savePosition(t)}}_createEdgeProximity(){const{nearStartProximityRatio:e,nearEndProximityRatio:t}=this.props;return new Ka.b([{condition:Ka.a.nearTop(5),callback:e=>this.props.onAtStart(e)},{condition:Ka.a.nearTopRatio(e),callback:e=>this.props.onNearStart(e)},{condition:Ka.a.nearBottomRatio(t),callback:e=>this.props.onNearEnd(e)},{condition:Ka.a.nearBottom(5),callback:e=>this.props.onAtEnd(e)}])}_loadStoredPosition(e){const{getCustomLocation:t}=this.context,{initialAnchor:i}=e;if(this._customLocation=t&&t(),this._initialAnchors=i?[i]:[],this._customLocation){const e=this._customLocation.getSavedPosition();e&&e.length?this._initialAnchors=e:this._initialAnchors=i?[i]:[],this._initialAnchors.length>0&&this._customLocation&&this._customLocation.claimScrollRestoration()}}}n()(Ya,"displayName","VirtualScroller"),n()(Ya,"contextTypes",{viewport:Qa.object,getCustomLocation:Qa.func}),n()(Ya,"defaultProps",{anchoring:Ea.defaultProps.anchoring,assumedItemHeight:Pa.defaultProps.assumedItemHeight,identityFunction:$a,minimumOffscreenToViewportRatio:Pa.defaultProps.minimumOffscreenToViewportRatio,nearEndProximityRatio:1.75,nearStartProximityRatio:.25,noItemsRenderer:()=>null,onPositionRestored:rs.a,onAtEnd:rs.a,onAtStart:rs.a,onNearEnd:rs.a,onNearStart:rs.a,onScrollEnd:rs.a,preferredOffscreenToViewportRatio:Pa.defaultProps.preferredOffscreenToViewportRatio,scrollerDisplayType:Ba.a.Vertical});var Xa=Object(Ra.a)(Ya),Ja=i("mw9i");const Za=Ne.a.i859a9d3,eo=Ne.a.i8ecae5b,to=Ne.a.ffde2fdb,io=()=>r.createElement(de.a,{style:ro.spinner},r.createElement(Ps.a,{accessibilityLabel:to})),so=e=>e.entry.id;class no extends r.Component{constructor(e,t){super(e,t),n()(this,"_renderItem",(e=>{const{conversation:t}=this.props,i=t.conversation_id;switch(e.type){case j.b.TYPING_INDICATOR:return i?r.createElement(da,{conversationId:i}):null;case j.b.READ_ONLY_INDICATOR:return i?r.createElement(de.a,{style:ro.readOnly},r.createElement(he.c,{align:"center",color:"gray600",size:"small"},eo,"",r.createElement(he.c,{link:"https://support.twitter.com/articles/14606#faq"},Za))):null;case j.b.CONVERSATION_PROFILE_INFO_HEADER:return r.createElement(ae,{conversation:t});default:return this._renderDMEntry(e)}})),n()(this,"_setActiveEntry",(e=>{this.setState({activeEntryId:e})})),n()(this,"_setShouldFreezeUpdates",(e=>{this.setState({shouldFreezeUpdates:e})})),this._anchoring=U({isOwnMessage:e=>{var t,i;return(null==(t=e.entry)||null==(i=t.message_data)?void 0:i.sender_id)===this.props.perspective||!1},typingIndicatorId:z}),this.state={activeEntryId:null,shouldFreezeUpdates:!1}}shouldComponentUpdate(e,t){return!1===t.shouldFreezeUpdates}render(){const{conversation:e,style:t,onHistoryRequest:i}=this.props,{activeEntryId:s}=this.state,n=(({conversation:e,footer:t,readOnlyEntry:i,canInjectConversationProfileInfoHeader:s,activeEntryId:n})=>{const r=e&&e.entries||[],a=r.reduce(((e,t,i)=>{s&&0===i&&e.push(W);const a=Object(K.a)(e),o=i===r.length-1;if(e.push({isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1,entry:t,isActive:n===t.id}),a){const i=Q(a.entry,t),s=e[e.length-2];i?(e[e.length-1].isRapidFire=!0,s.isRapidFire||(s.isFirstRapidFire=!0,s.isRapidFire=!0),o&&(e[e.length-1].isLastRapidFire=!0)):s.isRapidFire&&(s.isLastRapidFire=!0)}return e}),[]);return t&&a.push(t),e.read_only&&i&&a.push(i),a})({conversation:e,footer:V,readOnlyEntry:q,canInjectConversationProfileInfoHeader:e.status===j.c.AT_END&&e.type===j.a.ONE_TO_ONE,activeEntryId:s}),a=`dm-activity-${e.conversation_id}`;return r.createElement(pa.a,{style:[ro.scrollContainer,t]},e.status&&e.status!==j.c.AT_END?r.createElement(io,null):null,r.createElement(Ja.a,{style:[ro.content,ro.alignTop],withGutter:!0},r.createElement(ha.a,{identifier:a},r.createElement(Xa,{anchoring:this._anchoring,assumedItemHeight:100,cacheKey:a,identityFunction:so,initialAnchor:n.length>0?L.a(so((o=n,o[o.length-1]))):void 0,items:n,nearStartProximityRatio:2,onNearStart:i,renderer:this._renderItem}))));var o}_renderDMEntry({entry:e,isActive:t,isFirstRapidFire:i,isLastRapidFire:s,isRapidFire:n}){const{conversation:a,isWide:o,perspective:c,scribeNamespace:l}=this.props;return e&&r.createElement(jr,{conversation:a,entry:e,isActive:t,isFirstRapidFire:i,isLastRapidFire:s,isRapidFire:n,isWide:o,key:e.id,perspective:c,scribeNamespace:l,setActiveEntry:this._setActiveEntry,setShouldFreezeUpdates:this._setShouldFreezeUpdates})}}const ro=J.a.create((e=>({spinner:{alignItems:"center",marginVertical:"30px"},scrollContainer:{backgroundColor:e.colors.cellBackground,flexGrow:1,maxHeight:"100%",overflowX:"hidden",paddingTop:e.spaces.space20,WebkitOverflowScrolling:"touch"},content:{flexGrow:1,transform:[{translate3d:"0,0,0"}]},alignTop:{justifyContent:"flex-start"},readOnly:{paddingBottom:e.spaces.space20}})));var ao=i("uB9N"),oo=i("v//M"),co=i("J2UM"),lo=i("07FG"),ho=i("I8M8"),po=i("7myi"),uo=i("883S"),mo=i("z0MJ"),fo=i.n(mo),go=i("Es6L"),bo=i("LsPn"),_o=i("GSsg"),vo=i("EbOo");var yo=Object(Rs.a)().propsFromActions((()=>({addToast:p.b,block:E.e.block,createLocalApiErrorHandler:Object(m.d)("UNTRUSTED_CONVERSATION_ACTIONS"),muteDMUser:l.muteDMUser,unmuteDMUser:l.unmuteDMUser,unblock:E.e.unblock}))),Eo=i("b2lu");const So=Ne.a.ccf2f24e,Co=Ne.a.ib3fe8a9,Ro=Ne.a.a5e50981;var wo=({isGroup:e,isMuted:t,onMuteDMUserClick:i,onUnmuteDMUserClick:s,onBlockClick:n,onReportClick:a,requestorScreenName:c})=>{const{featureSwitches:l}=r.useContext(o.a),d=l.isTrue("dm_conversations_muting_enabled"),h={backgroundColor:"transparent",borderColor:"gray600",color:"gray600",size:"normal"},p=r.createElement(ht.a,h,d?Ro:Co),u=r.createElement(ht.a,Qt()({},h,{onPress:a}),So),m=r.useCallback(((e,o)=>r.createElement(Eo.a,{dismiss:e,flatBorders:"sheet"===o,isMuted:t,onBlockClick:n,onMuteDMUserClick:i,onReportClick:a,onUnmuteDMUserClick:s,requestorScreenName:c,showBlock:!0,showCancel:"sheet"===o,showMute:d})),[t,d,i,s,n,a,c]);return e?u:r.createElement(yi.a,{renderContent:m},p)},Ao=i("u0B7"),xo=i("cHvH"),Io=i("vMjK"),To=i("24HD");const Mo=Ne.a.da878dcf,Oo=Ne.a.d96cf7cd,ko=Ne.a.gde6b424,Lo=Ne.a.e308019b,Do=Ne.a.gf5e9ea6,Po=Ne.a.hc52446b,Fo=Ne.a.f7e1ad65,Bo={headline:Ne.a.gdf4b79f,text:Ne.a.bbf83d83,confirmButtonLabel:Ne.a.bb1d57b6},No={headline:Ne.a.e067c8bd,text:Ne.a.ddaeefd7,confirmButtonLabel:Ne.a.da878dcf};class Uo extends r.PureComponent{constructor(e,t){super(e,t),n()(this,"_renderCopy",(e=>{const{conversation:t}=this.props,{loggedInUserId:i}=this.context;return r.createElement(he.c,{style:jo.copy},e?Po:Fo({senderName:Object(C.c)(t,i).name}))})),n()(this,"_renderActionButtons",(e=>{const{conversation:t}=this.props,{loggedInUserId:i}=this.context;return r.createElement(xo.a,null,(({windowWidth:s})=>{const n=s<=J.a.theme.breakpoints.small;return r.createElement(de.a,{style:jo.actionsContainer},r.createElement(de.a,{style:n?jo.actionFullWidth:[jo.actionHalfWidth,jo.actionMarginRight]},r.createElement(Fs.a.Consumer,null,(s=>r.createElement(wo,{isGroup:e,isMuted:!!t.muted,onBlockClick:this._handleBlockClick,onMuteDMUserClick:this._handleMuteDMUserClick(s),onReportClick:this._handleReportMenuItemClick,onUnmuteDMUserClick:this._handleUnmuteDMUserClick(s),requestorScreenName:Object(C.c)(t,i).screenName})))),r.createElement(ht.a,{onPress:this._handleLeaveConversationClick,size:"normal",style:n?[jo.actionFullWidth,jo.actionMarginTop]:[jo.actionHalfWidth,jo.actionMarginLeft],type:"destructiveSecondary"},Oo),r.createElement(ht.a,{onPress:this._handleAcceptConversation,size:"normal",style:[jo.actionFullWidth,jo.actionMarginTop],type:"secondary"},Mo))}))})),n()(this,"_renderLeaveConfirmationSheet",(()=>r.createElement(dt.a,{confirmButtonLabel:Bo.confirmButtonLabel,confirmButtonType:"destructive",headline:Bo.headline,onCancel:this._handleCancelLeave,onConfirm:this._handleConfirmLeave,text:Bo.text}))),n()(this,"_renderAcceptMutedConfirmationSheet",(()=>r.createElement(dt.a,{confirmButtonLabel:No.confirmButtonLabel,confirmButtonType:"primary",headline:No.headline,onCancel:this._handleCancelAcceptMuted,onConfirm:this._handleConfirmAccept,text:No.text}))),n()(this,"_renderBlockConfirmationSheet",(()=>{const{conversation:e}=this.props,{loggedInUserId:t}=this.context,{screenName:i,idStr:s}=Object(C.c)(e,t);return Object(To.e)({confirmation:Object(To.b)(i),onClose:this._handleBlockLeave,handleConfirm:this._createBlockUserHandler(s)})})),n()(this,"_scribeAction",(e=>{const{scribeAction:t,scribeNamespace:i}=this.props;t({...i,action:e},this._getScribeData())})),n()(this,"_getScribeData",(()=>{const{conversation:e}=this.props;return{items:[{conversation_type:e.type===l.CONVERSATION_TYPE.GROUP?1:0}]}})),n()(this,"_handleReportTextClick",(()=>{this._scribeAction("report")})),n()(this,"_handleReportMenuItemClick",(()=>{const{conversationId:e,history:t,scribeNamespace:i}=this.props;e&&(this._scribeAction("report"),t.push(Object(C.b)(e,window.location.pathname,i)))})),n()(this,"_handleLeaveConversationClick",(()=>{this.setState({showLeaveConfirmation:!0,showBlockConfirmation:!1})})),n()(this,"_handleMuteDMUserClick",(e=>()=>{const{addToast:t,conversation:i,conversationId:s,createLocalApiErrorHandler:n,muteDMUser:r}=this.props,{loggedInUserId:a}=this.context,{idStr:o,name:c}=Object(C.c)(i,a);r(o,s).then((()=>{t({action:{label:Do,onAction:this._handleUnmuteDMUserClick(e)},text:ko({name:c})}),e.location.pathname.match("additional")||e.replace("/messages/requests")}),n()),this._scribeAction("mute_user")})),n()(this,"_handleUnmuteDMUserClick",(e=>()=>{const{addToast:t,conversation:i,conversationId:s,createLocalApiErrorHandler:n,unmuteDMUser:r}=this.props,{loggedInUserId:a}=this.context,{idStr:o,name:c}=Object(C.c)(i,a);s&&(r(o,s).then((()=>{t({action:{label:Do,onAction:this._handleMuteDMUserClick(e)},text:Lo({name:c})}),e.replace(`/messages/requests/${s}`)}),n()),this._scribeAction("unmute_user"))})),n()(this,"_handleBlockClick",(()=>{this.setState({showBlockConfirmation:!0,showLeaveConfirmation:!1})})),n()(this,"_handleCancelLeave",(()=>{this.setState({showLeaveConfirmation:!1})})),n()(this,"_handleCancelAcceptMuted",(()=>{this.setState({showAcceptMutedConfirmation:!1})})),n()(this,"_handleBlockLeave",(()=>{this.setState({showBlockConfirmation:!1})})),n()(this,"_handleConfirmLeave",(()=>{const{leaveConversation:e,conversation:t,conversationId:i,history:s}=this.props,n=t.type===l.CONVERSATION_TYPE.GROUP?"leave_group":"delete_thread";this.setState({showLeaveConfirmation:!1}),e({conversationId:i}),this._scribeAction(n),s.goBack()})),n()(this,"_handleConfirmAccept",(()=>{const{acceptConversation:e,conversationId:t,scribeAction:i,scribeNamespace:s}=this.props,{showAcceptMutedConfirmation:n}=this.state;t&&(e(t),n?(i({...s,element:"accept_muted_dialog",action:"accept"},this._getScribeData()),this.setState({showAcceptMutedConfirmation:!1})):this._scribeAction("accept"))})),n()(this,"_handleAcceptConversation",(()=>{const{conversation:e}=this.props;e.muted?this.setState({showAcceptMutedConfirmation:!0}):this._handleConfirmAccept()})),n()(this,"_createBlockUserHandler",(e=>()=>{const{addToast:t,block:i,createLocalApiErrorHandler:s}=this.props;this.setState({showBlockConfirmation:!1}),i(e).then((()=>{t({action:{label:Io.c,onAction:this._createUnblockUserHandler(e)},text:Io.a})}),s(vo.a)),this._scribeAction("block")})),n()(this,"_createUnblockUserHandler",(e=>()=>{const{createLocalApiErrorHandler:t,unblock:i}=this.props;i(e).catch(t(Ao.a)),this._scribeAction("unblock")})),this.state={showAcceptMutedConfirmation:!1,showLeaveConfirmation:!1,showBlockConfirmation:!1}}componentDidMount(){this._scribeAction("impression")}render(){const{conversation:e}=this.props,{showAcceptMutedConfirmation:t,showBlockConfirmation:i,showLeaveConfirmation:s}=this.state,n=(e&&e.type)===l.CONVERSATION_TYPE.GROUP;return r.createElement(r.Fragment,null,r.createElement(de.a,{style:jo.root},this._renderCopy(n),this._renderActionButtons(n)),Ha.b.isKaiOS()?r.createElement(bo.a,{leftText:Oo,onLeftClick:this._handleLeaveConversationClick,onRightClick:this._handleAcceptConversation,rightText:Mo}):null,s?this._renderLeaveConfirmationSheet():null,t?this._renderAcceptMutedConfirmationSheet():null,i?this._renderBlockConfirmationSheet():null)}}n()(Uo,"contextType",o.a);const jo=J.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,borderColor:e.colors.borderColor,borderTopStyle:"solid",borderTopWidth:"1px",paddingVertical:e.spaces.space20,paddingHorizontal:e.componentDimensions.gutterHorizontal},copy:{paddingBottom:e.spaces.space20},reportlink:{marginLeft:e.spaces.space4},actionsContainer:{display:"flex",flexWrap:"wrap",flexDirection:"row"},actionFullWidth:{width:"100%"},actionHalfWidth:{width:`calc(50% - ${e.spaces.space4})`},actionMarginRight:{marginRight:e.spaces.space4},actionMarginLeft:{marginLeft:e.spaces.space4},actionMarginTop:{marginTop:e.spaces.space12}})));var Ho=Object(O.c)({element:"untrusted_interstitial"})(yo(Uo)),Wo=i("rFBM"),zo=i("jTgF");const Vo=Ne.a.badb01a0,qo=Ne.a.d6b11d9c,Go=Ne.a.i7ca1446,Qo=e=>e&&(e.tweet||e.media),Ko=({gifMetadata:e={},tweetAttachment:t,media:i})=>{let s;return t?s={tweet:t}:i?i.mediaFile?s={media:i}:i.externalMediaDetails&&(s={media:i,provider:e.provider,gifUrl:e.url}):s=null,s};class $o extends r.PureComponent{constructor(e,t){super(e,t),n()(this,"_composer",r.createRef()),n()(this,"_handleLivePipelineUpdate",(()=>{this._fetchUpdatesIfNeeded(),this._updatePolling&&this._updatePolling.restart()})),n()(this,"_fetchUpdatesIfNeeded",(()=>{const{conversationId:e,createLocalApiErrorHandler:t,fetchUpdatesIfNeeded:i,isDmReceiptSettingEnabled:s}=this.props;i(s?{active_conversation_id:e,dm_users:!0}:{}).catch(t())})),n()(this,"_handleInitialFetch",(()=>{this._initialFetch()})),n()(this,"_initialFetch",(()=>{const{conversationId:e,createLocalApiErrorHandler:t,fetchInboxIfNeeded:i,fetchUpdatesIfNeeded:s}=this.props;return i().then((()=>{if(e)return this._fetchConversation(e).then((()=>this._requestWelcomeMessage(e)))})).then((()=>s())).catch(t()).finally((()=>{this._updatePolling&&this._updatePolling.start()}))})),n()(this,"_isUntrustedConversation",(e=>{const{isNewGroupConversation:t}=this.props;return!(null!=e&&e.trusted||t)})),n()(this,"_leaveConversation",(e=>{const{createLocalApiErrorHandler:t,leaveConversation:i}=this.props;i(e).catch(t({showToast:!0}))})),n()(this,"_acceptConversation",(e=>{const{acceptConversation:t,createLocalApiErrorHandler:i}=this.props;t(e).then((()=>{Ha.b.isMobileOS()&&this._fetchConversation(e)})).catch(i({showToast:!0}))})),n()(this,"_renderActions",(()=>{const{conversation:e,conversationId:t,history:i,scribeAction:s}=this.props;return e&&this._isUntrustedConversation(e)?e.read_only?null:t&&r.createElement(Ho,{acceptConversation:this._acceptConversation,conversation:e,conversationId:t,history:i,leaveConversation:this._leaveConversation,scribeAction:s}):r.createElement(r.Fragment,null,this._renderComposerBar(),Ha.b.isKaiOS()?r.createElement(bo.a,{leftText:Go,onLeftClick:this._handleInfoClick,onRightClick:this._handleComposeClick,rightText:Vo}):null)})),n()(this,"_render",(()=>{const{conversation:e,conversationId:t,isWide:i,perspective:s,scribeNamespace:n}=this.props,{attachment:a,composerHeight:o}=this.state;return r.createElement(dr,{key:t},r.createElement(Wo.a,{allowDragDrop:!Qo(a),onFilesAdded:this._handleDragDrop,style:Yo.dragDrop},r.createElement(pa.a,{style:[Yo.scrollView,!Object(go.a)()&&!this._isUntrustedConversation(e)&&{paddingBottom:o}]},s&&e?r.createElement(no,{conversation:e,isWide:i,onHistoryRequest:this._handleHistoryRequest,perspective:s,scribeNamespace:n,style:Yo.activity}):null),this._renderActions()))})),n()(this,"_handleNavHeightChange",(e=>{this.setState({composerHeight:`${e}px`})})),n()(this,"_handleTyping",(()=>{this._throttleSaveDraftText(),this._throttleUpdateTyping()})),n()(this,"_throttleUpdateTyping",Object(Oa.a)((()=>{const{conversationId:e,createLocalApiErrorHandler:t,updateTyping:i}=this.props;e&&i({conversationId:e}).catch(t())}),2e3,{trailing:!1})),n()(this,"_throttleSaveDraftText",Object(Oa.a)((()=>{const{conversationId:e}=this.props;e&&this._handleSaveDraftText()}),1e3,{leading:!1})),n()(this,"_handleDragDrop",(e=>{this._currentComposer&&this._currentComposer._handleAddMediaFiles(e)})),n()(this,"_handleHistoryRequest",(()=>{const{conversationId:e,fetchConversationHistory:t,createLocalApiErrorHandler:i}=this.props;t({conversationId:e}).catch(i())})),n()(this,"_handleSendMessage",((e,t)=>{var i,s;const{addToast:n,cardUrl:r,conversationId:a,createLocalApiErrorHandler:o,gifMetadata:c,history:l,location:d,newConversationParticipants:h,perspective:p,scribeAction:u,scribeNamespace:m,sendMessage:f,tweetAttachment:g}=this.props,{attachment:b}=this.state,_=b&&b.media;if(e.emoji||e.quickReply||_||(this._currentComposer&&this._currentComposer.clear(),this._currentComposer&&this._currentComposer.focus()),c&&u({...m,element:"remote",action:"send_gif_dm"}),u(g?{...m,action:"send_tweet_dm"}:{...m,action:"send_dm"}),this.setState({isSending:!0}),!a){return f({senderId:p,recipients:h&&h.map((({data:e})=>e.id_str)),text:t,tweetAttachment:g}).then((e=>{this.setState({attachment:null,isSending:!1}),l.replace(`/messages/${e}`)}),o(uo.b)),Promise.resolve()}return!this.state.attachment||null!=(i=this.state.attachment)&&null!=(s=i.media)&&s.uploading||(this.setState({attachment:null}),l.replace(d.pathname)),f({senderId:p,cardUrl:r,conversationId:a,text:t,tweetAttachment:g,...e.quickReply&&{quickReply:e.quickReply}}).then((()=>{e.emoji||e.quickReply||!_||(this._currentComposer&&this._currentComposer.clear(),this._currentComposer&&this._currentComposer.focus()),this.setState({isSending:!1})})).catch((e=>{if(this.setState({isSending:!1}),!Object(zo.d)(e)||e.code!==ho.b.CANCELED)if(Object(zo.d)(e)){const t=Object(zo.b)(e,qo);t&&n(t)}else o(uo.b)(e)}))})),n()(this,"_handlePopOutConvo",(()=>{const{conversationId:e,popOutConversation:t}=this.props;t(e)})),n()(this,"_handleInfoClick",(()=>{const{history:e,conversationId:t}=this.props;t&&e.push(`/messages/${t}/info`)})),n()(this,"_handleComposeClick",(()=>{this._currentComposer&&this._currentComposer.focus()})),n()(this,"_handleSaveDraftText",(()=>{const{conversationId:e,saveText:t}=this.props;e&&this._currentComposer&&t(e,this._currentComposer.value())})),this.state={attachment:Ko(e),composerHeight:J.a.theme.componentDimensions.appBarHeight,isSending:!1},this._showDMQuickAccess=this.context.featureSwitches.isTrue("responsive_web_dm_quick_access_enabled")}componentDidMount(){const{googleAnalyticsPageView:e,scribeNamespace:t,scribePageImpression:i,updateTweetDetailNav:s}=this.props;return i(t),s(t),e(t),this._initializePolling({interval:3e3}),this._initializeLivePipeline(),this._focusComposerIfNeeded(),this._initialFetch()}_focusComposerIfNeeded(){fo()((()=>Object(co.a)().then((({detectedType:e,KEYBOARD:t,MOUSE:i})=>{const s=this.props.quickReplyOptions;(e(t)||e(i))&&!s&&this._currentComposer&&this._currentComposer.focus()}))))}_initializeLivePipeline(){const{conversationId:e}=this.props;Object(a.h)().then((({LivePipeline:t})=>{e&&t.isSupportedAndReady(this.context.featureSwitches)&&this.context.featureSwitches.isTrue("livepipeline_dm_features_enabled")&&!this._livePipelineSubscription&&(this._livePipelineSubscription=t.get().subscribeTopic(`/dm_update/${e}`,this._handleLivePipelineUpdate),this._initializePolling({interval:1e4}))}))}_initializePolling({interval:e}){this._updatePolling&&this._updatePolling.stop(),this._updatePolling=new _o.a(this._fetchUpdatesIfNeeded,{interval:e})}componentWillUnmount(){const{conversation:e,conversationId:t,removeConversation:i}=this.props,s=(null==e?void 0:e.entries)||[];this._updatePolling&&this._updatePolling.stop(),this._updatePolling=void 0,this._livePipelineSubscription&&this._livePipelineSubscription.teardown(),0===s.length&&i(t),1===s.length&&"welcome_message_create"===s[0].type&&i(t)}componentDidUpdate(e,t){const{conversationId:i,conversation:s,isLoaded:n,isUploading:r,quickReplyOptions:a,updateConversationReadState:o}=this.props;var c;i!==e.conversationId?(i&&this._fetchConversation(i),this._focusComposerIfNeeded(),this._livePipelineSubscription&&this._livePipelineSubscription.teardown(),this._initializeLivePipeline()):((null==s?void 0:s.sort_event_id)!==(null==(c=e.conversation)?void 0:c.sort_event_id)&&o(i),r||!e.isUploading||a||this._currentComposer&&this._currentComposer.focus(),e.isLoaded&&!n&&i&&this._fetchConversation(i))}UNSAFE_componentWillReceiveProps(e){const{media:t}=this.props,{media:i}=e;Object(le.a)(t,i)||this.setState({attachment:Ko(e)})}render(){const{fetchStatus:e}=this.props;return r.createElement(Ja.a,{style:[Yo.root,Ha.b.isKaiOS()&&Yo.kaiOSFix]},r.createElement(oo.a,{fetchStatus:e,onRequestRetry:this._handleInitialFetch,render:this._render}))}_renderComposerBar(){const{addMedia:e,cardUrl:t,conversation:i,conversationId:s,dataSaverMode:n,draftText:a,dtabBarInfo:o,history:c,isUploading:l,mediaMetadata:d,mediaUploadProgress:h,quickReplyOptions:p,removeMedia:u,richTextInputContext:m,scribeNamespace:f,typeaheadWrapper:g}=this.props,{attachment:b,isSending:_}=this.state,v=this.props.prefillText||a,y=!Object(go.a)();return null!=i&&i.read_only?null:r.createElement(ao.a,{attachment:b,conversationId:s,disabled:l,dtabBarInfo:o,history:c,isCardPreviewTombstoned:Object(lo.a)(t),isSending:_,isUploading:l,key:s,mediaMetadata:d,mediaUploadProgress:h,onAddMedia:e,onBlur:this._handleSaveDraftText,onHeightChange:this._handleNavHeightChange,onSend:this._handleSendMessage,onTyping:n?this._throttleSaveDraftText:this._handleTyping,prefillText:"string"==typeof v?v:void 0,quickReplyOptions:p,ref:this._composer,removeMedia:u,richTextInputContext:m,scribeNamespace:f,style:[!y&&Yo.offsetBottom],typeaheadWrapper:g})}get _currentComposer(){return this._composer.current}_fetchConversation(e){const{createLocalApiErrorHandler:t,fetchConversationIfNeeded:i,updateConversationReadState:s}=this.props;return i({conversationId:e}).then((()=>s(e))).catch(t(Object(k.a)(e)))}_requestWelcomeMessage(e){const{addWelcomeMessageToConversation:t,createLocalApiErrorHandler:i,conversation:s,location:n}=this.props,{text:r}=n.query,a=Array.isArray(n.query.welcome_message_id)?n.query.welcome_message_id[0]:n.query.welcome_message_id,o=!!this.state.attachment||!(!r||a),c=!s||!s.type||s.type===l.CONVERSATION_TYPE.GROUP,d=s&&s.participants&&Object.keys(s.participants).length<=1;return o||c||d?Promise.resolve():t(e,a).catch(i({showToast:!1}))}}n()($o,"contextType",o.a),n()($o,"defaultProps",{isNewGroupConversation:!1,typeaheadWrapper:po.a});const Yo=J.a.create((e=>({root:{flexGrow:1},activity:{flexBasis:e.spacesPx.space1,flexGrow:1,height:"100%"},kaiOSFix:{paddingBottom:e.spaces.space20},dragDrop:{flexGrow:1},scrollView:{flexGrow:1},infoButton:{marginRight:e.spaces.space4},offsetBottom:{paddingBottom:J.a.iPhoneOffsetBottom}})));t.a=Object(O.c)()(M($o))},"V/6K":function(e,t,i){"use strict";var s=i("ERkP");const n=s.createContext({isDrawer:!1});t.a=n},"X/yg":function(e,t,i){"use strict";i.d(t,"h",(function(){return n})),i.d(t,"g",(function(){return r})),i.d(t,"f",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return h}));var s=i("XnpN");const n=(e,t)=>t.location&&t.location.state&&t.location.state.tweetAttachment,r=(e,t)=>t.location&&t.location.state&&t.location.state.participants,a=(e,t)=>t.location&&t.location.state&&t.location.state.isNewGroupConversation,o=e=>{const{message_data:t}=e;let i="text_bubble";const s=t&&t.attachment||{};return s.tweet?i="tweet":s.photo?i="photo":s.animated_gif?i="gif":s.video?i=s.video.audio_only?"voice_message":"video":s.card&&(i="card"),i};function c(e){return e.isTrue("dm_voice_rendering_enabled")}function l(e,t){return!!(e&&e.video&&c(t))&&!!e.video.audio_only}function d(e,t,i){return{pathname:`/i/report/dm_conversation/${e}`,state:{clientReferer:t,scribeNamespace:i}}}function h(e,t){if(!e)return{name:"",screenName:"",idStr:""};const i=Object(s.a)(e,t).map((({user:e})=>e)),n=i&&i[0];return{name:n&&n.name||"",screenName:n&&n.screen_name||"",idStr:n&&n.id_str||""}}},XnpN:function(e,t,i){"use strict";i("kYxP");var s=i("aWyx"),n=i("t0aI");const r=(e=0)=>new Date(Number(e)),a=(e,t)=>r(e.join_time)-r(t.join_time),o=({user:e},{user:t})=>Object(n.a)(e.id_str,t.id_str);var c=i("tn7R"),l=i("VIKJ");t.a=(e,t)=>{const{participants:i,type:n,created_by_user_id:r}=e,d=Object(c.a)(i),[h,p]=Object(l.a)(d,(({user:e})=>e.id_str===t));return p.length?n===s.a.GROUP&&1===p.length?[...h,...p]:r?p.sort(((...e)=>(t,i)=>e.map((e=>e(t,i))).filter((e=>!!e))[0]||0)((e=>({user:t},{user:i})=>{switch(e){case t.id_str:return-1;case i.id_str:return 1;default:return 0}})(r),a,o)):p:h}},aA19:function(e,t,i){"use strict";var s=i("ERkP"),n=i("aWyx"),r=i("XnpN"),a=i("rHpw"),o=i("9Xij"),c=i("cm6r"),l=i("TIdA"),d=i("A91F"),h=i("oSwX"),p=i("U+bB"),u=i("MWbm");const m=a.a.create((e=>({root:{borderRadius:e.borderRadii.infinite,overflow:"hidden"},container:{height:"auto",overflow:"hidden",width:"100%"},image:{borderRadius:e.borderRadii.none}}))),f=a.a.create((e=>({container:{flexDirection:"row"},left:{flex:1},right:{flex:1,marginLeft:e.borderWidths.small,marginRight:`calc(-1 * ${e.borderWidths.small})`}}))),g=a.a.create((e=>({container:{flexDirection:"column"},top:{flex:1,marginBottom:e.borderWidths.small},bottom:{flex:1}}))),b=({left:e,right:t})=>s.createElement(u.a,{style:f.container},s.createElement(u.a,{style:f.left},e),s.createElement(u.a,{style:f.right},t)),_=({top:e,bottom:t})=>s.createElement(u.a,{style:g.container},s.createElement(u.a,{style:g.top},e),s.createElement(u.a,{style:g.bottom},t));class v extends s.Component{render(){const{link:e,conversation:t,perspective:i}=this.props,n=t&&t.avatar_image_https,a=t?Object(r.a)(t,i).map((({user:e})=>e)):[],l=a.slice(0,3),d=this._avatarFromGroup(t)||this._avatarFromSrc(n)||this._avatarFromParticipants(l),h=e||this._defaultLink(t,a);return d?s.createElement(o.a,{ratio:1,style:m.root},h?s.createElement(c.a,{interactiveStyles:null,link:h},d):d):null}_defaultLink(e,t){if(e)return e.type===n.a.GROUP?`/messages/${e.conversation_id}/participants`:e.type===n.a.ONE_TO_ONE?`/${t[0].screen_name}`:void 0}_avatarFromGroup(e){const t=e&&e.avatar&&e.avatar.image&&e.avatar.image.original_info;return t?s.createElement(l.a,{accessibilityLabel:"",aspectMode:d.a.SQUARE,backgroundColor:a.a.theme.colors.gray50,image:t,rounded:!0}):null}_avatarFromSrc(e){return e?s.createElement(p.a,{source:e}):null}_avatarFromParticipants(e){const t=e.length;return 0===t?null:1===t?this._singleParticipantAvatar(e[0]):this._multipleParticipantAvatar(e)}_singleParticipantAvatar(e){const{size:t}=this.props;return s.createElement(u.a,{key:e.id_str,style:m.container},s.createElement(h.default,{importantForAccessibility:"no-hide-descendants",size:t||"xxLarge",style:m.image,uri:e.profile_image_url_https}))}_multipleParticipantAvatar(e){const t=e.length,i=e.map(((e,i)=>{const n=2===t||3===t&&0===i?.5:1;return s.createElement(u.a,{key:e.id_str,style:m.container},s.createElement(h.default,{aspectRatio:n,circle:!1,importantForAccessibility:"no-hide-descendants",size:"custom",style:m.image,uri:e.profile_image_url_https}))}));if(2===t)return s.createElement(b,{left:i[1],right:i[0]});{const e=s.createElement(_,{bottom:i[2],top:i[1]}),t=i[0];return s.createElement(b,{left:e,right:t})}}}t.a=v},b2lu:function(e,t,i){"use strict";var s=i("ERkP"),n=i("3XMw"),r=i.n(n),a=i("MWbm"),o=i("CKsB"),c=i("/yvb"),l=i("rHpw"),d=i("hiGS"),h=i("w02m"),p=i("qz6Z"),u=i("pu5c"),m=i("zIWA");const f=r.a.e67b2d65,g=r.a.jd44c4e4,b=r.a.f05597b2,_=r.a.g9c74283,v=r.a.fcd4d489,y=r.a.gbed8594,E=r.a.g9074da4,S=r.a.ad63377d,C=r.a.h09b49f7,R=r.a.i6b19b07,w=r.a.j7bb1a42,A=r.a.ea200ba6,x=r.a.cfd2f35d,I=({dismiss:e,isGroup:t,isMuted:i,onDeleteClick:n,onMuteDMUserClick:r,onUnmuteDMUserClick:l,onReportClick:I,onBlockClick:M,requestorScreenName:O,flatBorders:k,showBlock:L,showCancel:D,showDelete:P,showMute:F})=>{const B=s.useCallback((()=>{r&&r(),e()}),[e,r]),N=s.useCallback((()=>{l&&l(),e()}),[e,l]),U=s.useCallback((()=>{I&&I(),e()}),[e,I]),j=s.useCallback((()=>{M&&M(),e()}),[e,M]),H=s.useCallback((()=>{n&&n(),e()}),[e,n]);return s.createElement(a.a,{accessibilityRole:"dialog",style:k?T.flatCorners:T.roundCorners},P?s.createElement(o.a,{Icon:d.a,actionSubText:C,actionText:t?E:S,onClick:H,textColor:"red500"}):null,F?i?s.createElement(o.a,{Icon:h.a,actionSubText:_,actionText:b({screenName:O}),onClick:N}):s.createElement(o.a,{Icon:p.a,actionSubText:g,actionText:f({screenName:O}),onClick:B}):null,L?s.createElement(o.a,{Icon:u.a,actionSubText:y,actionText:v({screenName:O}),onClick:j}):null,s.createElement(o.a,{Icon:m.a,actionSubText:A,actionText:t?R:w({screenName:O}),onClick:U}),D?s.createElement(c.a,{onPress:e,style:T.cancelButton,type:"neutral"},x):null)};I.defaultProps={isGroup:!1,isMuted:!1,flatBorders:!1,showBlock:!1,showCancel:!1,showDelete:!1,showMute:!1};const T=l.a.create((e=>({roundCorners:{borderRadius:e.borderRadii.xLarge},flatCorners:{borderRadius:e.borderRadii.none},cancelButton:{marginHorizontal:e.spaces.space16,marginVertical:e.spaces.space16}})));t.a=I},b9JY:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return l}));var s=i("aWyx");const n=e=>e&&e.type===s.b.MESSAGE,r=e=>e&&e.type===s.b.WELCOME_MESSAGE,a=e=>e&&e.type===s.b.TRUST_CONVERSATION,o=e=>e&&e.type===s.b.REACTION_CREATE,c=[s.b.CONVERSATION_AVATAR_UPDATE,s.b.CONVERSATION_NAME_UPDATE,s.b.JOIN_CONVERSATION,s.b.PARTICIPANTS_JOIN,s.b.PARTICIPANTS_LEAVE],l=e=>e&&c.indexOf(e.type)>-1},cSHO:function(e,t,i){"use strict";i.d(t,"c",(function(){return m})),i.d(t,"e",(function(){return f})),i.d(t,"f",(function(){return g})),i.d(t,"d",(function(){return b})),i.d(t,"h",(function(){return v})),i.d(t,"g",(function(){return y})),i.d(t,"b",(function(){return E})),i.d(t,"a",(function(){return S})),i.d(t,"i",(function(){return C})),i.d(t,"j",(function(){return R}));var s=i("oEOe"),n=i("kGix"),r=i("Ssj5"),a=i("G6rE");const o="fleets",c=Object.freeze({REQUEST:"rweb/fleets/FETCH_USER_FLEETS_REQUEST",SUCCESS:"rweb/fleets/FETCH_USER_FLEETS_SUCCESS",FAILURE:"rweb/fleets/FETCH_USER_FLEETS_FAILURE"}),l="rweb/fleets/UPDATE_FLEET",d="rweb/fleets/UPDATE_IS_FLEET_GLOBAL_AUDIO_MUTED",h={fleets:{},fleetThreads:{},isFleetGlobalAudioMuted:!0,userFetchStatus:{}};const p=(e,t)=>null!=t&&t.data?t.data.is_interstitialed:!!(null!=e&&e.tombstone&&Object.keys((null==e?void 0:e.tombstone)||{}).length>0||null!=e&&e.possibly_sensitive||null!=e&&e.tweet_possibly_sensitive),u=(e,t)=>e.fleets.fleets[t],m=(e,t)=>{const i=u(e,t);return null==i?void 0:i.data},f=(e,t)=>{var i;return!(null==(i=m(e,t))||!i.is_interstitialed)},g=(e,t)=>{const i=m(e,t),s=null==i?void 0:i.fleet_thread_id;if(s){const t=((e,t)=>((e,t)=>e.fleets.fleetThreads[t])(e,t))(e,s);return null==t?void 0:t.data}},b=(e,t)=>{const i=u(e,t);return(null==i?void 0:i.fetchStatus)||n.a.NONE},_=(e,t)=>e.fleets.userFetchStatus[t]||n.a.NONE,v=(e,t)=>{const i=a.e.selectIdByScreenName(e,t);return i?_(e,i):n.a.NONE},y=e=>e.fleets.isFleetGlobalAudioMuted,E=(e,t)=>(i,r,{api:a})=>{const o=r(),l=t&&b(o,t),d=_(o,e),h=s.b(i,{params:{user_id:e},request:a.Fleets.fetchUserFleets});return d===n.a.LOADING||l===n.a.LOADED&&d===n.a.LOADED?Promise.resolve():h({actionTypes:c,context:"FETCH_USER_FLEETS",meta:{user_id:e,fleet_id:t}})},S=e=>(t,i)=>{const s=a.e.selectFetchStatusByScreenName(i(),e),r=v(i(),e);return s===n.a.LOADING||r===n.a.LOADING?Promise.resolve():(s===n.a.NONE?t(a.e.fetchOneByScreenNameIfNeeded(e)):Promise.resolve()).then((()=>{const s=a.e.selectIdByScreenName(i(),e);return s&&r===n.a.NONE?t(E(s)):Promise.resolve()}))},C=e=>(t,i)=>{const s=u(i(),e);null!=s&&s.data&&t({meta:{fleet_id:e},payload:{fetchStatus:s.fetchStatus,userId:s.data.user_id_str,data:{...s.data,is_interstitialed:!1}},type:l})},R=e=>t=>{t({payload:{isFleetGlobalAudioMuted:e},type:d})};r.a.register({[o]:function(e=h,t){switch(t.type){case c.REQUEST:{const{user_id:i,fleet_id:s}=t.meta;let r;return s&&!e.fleets[s]&&(r={[s]:{fetchStatus:n.a.LOADING,userId:i}}),{...e,userFetchStatus:{...e.userFetchStatus,[i]:n.a.LOADING},fleets:{...e.fleets,...r}}}case c.SUCCESS:var i;if(null!=(i=t.payload)&&i.entities){const{fleets:i,fleetThreads:s}=t.payload.entities,{user_id:r,fleet_id:a}=t.meta;let o={},c={};i&&(o=Object.keys(i).reduce(((t,s)=>{const r=i[s],a=e.fleets[s];return r.is_interstitialed=p(r,a),t[s]={fetchStatus:n.a.LOADED,data:r,userId:r.user_id_str},t}),{})),s&&(c=Object.keys(s||{}).reduce(((e,t)=>(e[t]={fetchStatus:n.a.LOADED,data:s[t]},e)),{}));const l=a&&!o[a]&&{[a]:{...e.fleets[a],fetchStatus:n.a.FAILED,userId:r}};return Object.keys(e.fleets).forEach((t=>{e.fleets[t].userId===r&&e.fleets[t].fetchStatus===n.a.NONE&&(e.fleets[t].fetchStatus=n.a.LOADED)})),{...e,fleets:{...e.fleets,...o,...l},fleetThreads:{...e.fleetThreads,...c},userFetchStatus:{...e.userFetchStatus,[r]:n.a.LOADED}}}break;case c.FAILURE:{const{user_id:i,fleet_id:s}=t.meta,r=s&&e.fleets[s].fetchStatus===n.a.LOADING&&{[s]:{...e.fleets[s],fetchStatus:n.a.FAILED,userId:i}};return{...e,fleets:{...e.fleets,...r},userFetchStatus:{...e.userFetchStatus,[i]:n.a.FAILED}}}case l:{const{meta:{fleet_id:i},payload:s}=t;return{...e,fleets:{...e.fleets,[i]:s}}}case"rweb/fleets/ADD_DM_FLEETS":var s;if(null!=(s=t.payload)&&s.fleets){const{fleets:i}=t.payload,s=Object.keys(i).reduce(((e,t)=>(e[t]={fetchStatus:n.a.NONE,userId:i[t].userId},e)),{});return{...e,fleets:{...s,...e.fleets}}}break;case d:{var r;const i=null==(r=t.payload)?void 0:r.isFleetGlobalAudioMuted;if(void 0!==i)return{...e,isFleetGlobalAudioMuted:i};break}default:return e}}})},dPJJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return l}));i("kYxP");var s=i("6/RC");const n=new Set,r=new Set;let a=!1;function o(){if(s.canUseDOM&&!a){const e=["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"];["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","msfullscreenchange"].forEach((t=>{document.addEventListener(t,(()=>{const t=e.map((e=>document[e])).filter(Boolean)[0];t?n.forEach((e=>e(t))):r.forEach((e=>e()))}))}))}a=!0}const c=e=>(a||o(),n.add(e),()=>n.delete(e)),l=e=>(a||o(),r.add(e),()=>r.delete(e))},g54k:function(e,t,i){"use strict";i.d(t,"b",(function(){return c}));var s=i("oEGd"),n=i("hqKg"),r=i("s1N3");var a=e=>{const{sender_id:t,by_user_id:i,participants:s=[]}=e;return Object(r.a)(s.map((({user_id:e})=>e)).concat([t,i]).filter(Boolean))},o=i("G6rE");const c=(e,t)=>({users:a(t).reduce(((t,i)=>(t[i]=e[i],t)),{})}),l=Object(n.createSelector)(o.e.selectAll,((e,t)=>t.entry),c);t.a=Object(s.c)(l)},hiGS:function(e,t,i){"use strict";var s=i("ERkP"),n=i("Lsrn"),r=i("k/Ka");const a=(e={})=>Object(r.a)("svg",{...e,style:[n.a.root,e.style],viewBox:"0 0 24 24"},s.createElement("g",null,s.createElement("path",{d:"M20.746 5.236h-3.75V4.25c0-1.24-1.01-2.25-2.25-2.25h-5.5c-1.24 0-2.25 1.01-2.25 2.25v.986h-3.75c-.414 0-.75.336-.75.75s.336.75.75.75h.368l1.583 13.262c.216 1.193 1.31 2.027 2.658 2.027h8.282c1.35 0 2.442-.834 2.664-2.072l1.577-13.217h.368c.414 0 .75-.336.75-.75s-.335-.75-.75-.75zM8.496 4.25c0-.413.337-.75.75-.75h5.5c.413 0 .75.337.75.75v.986h-7V4.25zm8.822 15.48c-.1.55-.664.795-1.18.795H7.854c-.517 0-1.083-.246-1.175-.75L5.126 6.735h13.74L17.32 19.732z"}),s.createElement("path",{d:"M10 17.75c.414 0 .75-.336.75-.75v-7c0-.414-.336-.75-.75-.75s-.75.336-.75.75v7c0 .414.336.75.75.75zm4 0c.414 0 .75-.336.75-.75v-7c0-.414-.336-.75-.75-.75s-.75.336-.75.75v7c0 .414.336.75.75.75z"})));a.metadata={width:24,height:24},t.a=a},jHwr:function(e,t,i){"use strict";t.a=(e,t)=>{let i=null;const s=()=>{i=null,e()};return()=>(i||(i=t(s)),i)}},kgfz:function(e,t){function i(e){var t=[];for(var i in e)t.push(i);return t}(e.exports="function"==typeof Object.keys?Object.keys:i).shim=i},"n+Zb":function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return n}));const s=e=>({id:e,distanceToViewportTop:0}),n=e=>({id:e,distanceToViewportBottom:0})},p9G8:function(e,t,i){"use strict";i.d(t,"b",(function(){return d}));i("kYxP");var s=i("Xrkv"),n=i("aWyx"),r=i("XnpN"),a=i("3XMw"),o=i.n(a);const c=o.a.g755fcde,l=o.a.f6b1ff81;t.a=(e,t)=>{const{type:i,name:s,participants:a={}}=e;if(i===n.a.GROUP&&s)return s;if(!Object.keys(a).length)return;const o=Object(r.a)(e,t).map((({user:e})=>e));return d(o,t,i)};const d=(e=[],t,i=n.a.GROUP)=>{const r=e.filter((e=>e.id_str!==t)).map((e=>e.name));switch(r.length){case 0:return c;case 1:{const[e]=r;return i===n.a.GROUP?l({name:e}):e}default:{const e=!0;return Object(s.a)(r,e)}}}},qKzg:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));i("ERkP");const s=Object.freeze({Backward:"backward",Forward:"forward"}),n=Object.freeze({Original:"ORIG",Large:"LARGE",Medium:"MEDIUM",Small:"SMALL",Thumb:"THUMB"}),r=Object.freeze({Gif:"TWEET_GIF",Image:"TWEET_IMAGE",Video:"TWEET_VIDEO"});Object.freeze({Hashtag:"hashtag",Mention:"mention",Tweet:"tweet",Text:"text"})},uB9N:function(e,t,i){"use strict";var s=i("KEM+"),n=i.n(s),r=i("ERkP"),a=i("1YZw"),o=i("rxPX"),c=i("zh9S"),l=i("P1r1"),d=i("AspN"),h=Object(o.a)().propsFromState((()=>({dataSaverMode:l.j}))).propsFromActions((()=>({addMedia:d.b,addToast:a.b,processMultipleMedia:d.d,removeMediaUpload:d.f,scribeAction:c.c,uploadMedia:d.l}))),p=i("wpu3"),u=i("97Jx"),m=i.n(u),f=i("MWbm"),g=i("0FVZ"),b=i("Oe3h");class _ extends r.PureComponent{render(){const{accessibilityLabel:e,accessibilityRole:t,children:i,onLayout:s,sideNavPresent:n,style:a}=this.props;return n?r.createElement(r.Fragment,null,r.createElement(f.a,{accessibilityLabel:e,accessibilityRole:t,onLayout:s,style:a},i)):r.createElement(g.a.BottomComposer,null,r.createElement(b.a,{id:"DMComposerWrapper"},((n,o)=>r.createElement(f.a,m()({ref:n()},o({accessibilityLabel:e,accessibilityRole:t,onLayout:s,style:a})),i))))}}var v=_,y=(i("kYxP"),i("HPNB")),E=i("htQn"),S=i("t62R"),C=i("rHpw");class R extends r.Component{constructor(...e){super(...e),n()(this,"_handleClick",(()=>{const{id:e,label:t,onClick:i}=this.props;i({id:e,label:t})}))}render(){const{description:e,label:t,isWide:i}=this.props;return r.createElement(E.a,{accessibilityRole:"button",onClick:this._handleClick,style:[w.root,i&&w.isWide,!i&&w.isNarrow]},r.createElement(S.c,{weight:"bold"},t),r.createElement(S.c,{color:"gray600",size:"small"},e))}}const w=C.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,borderColor:e.colors.borderColor,borderStyle:"solid",paddingLeft:"1rem",paddingVertical:"1rem"},isWide:{borderRadius:e.borderRadii.xLarge,paddingVertical:"0.5rem",borderWidth:e.borderWidths.small},isNarrow:{borderTopWidth:e.borderWidths.small}})));var A=R,x=i("cHvH"),I=i("mw9i");class T extends r.Component{constructor(...e){super(...e),n()(this,"_handleOptionChoose",(e=>{const{onOptionChoose:t,quickReplyOptions:{id:i}}=this.props;return t(i,e)}))}render(){const{quickReplyOptions:{options:e}}=this.props,t=1===e.length;return r.createElement(x.a,null,(({windowWidth:i})=>{const s=y.a.isTwoColumnLayout(i),n=[s&&M.isWide,s&&t&&M.oneButtonOnly,!s&&M.isNarrow];return r.createElement(I.a,{style:n,withGutter:s},e.map((e=>this.renderOption(e,s))))}))}renderOption(e,t){return r.createElement(A,{description:e.description,id:e.id,isWide:t,key:e.id,label:e.label,onClick:this._handleOptionChoose})}}const M=C.a.create((e=>({oneButtonOnly:{gridTemplateColumns:"1fr"},isWide:{backgroundColor:e.colors.gray0,display:"grid",gridColumnGap:e.spaces.space12,gridRowGap:e.spaces.space12,gridTemplateColumns:"1fr 1fr",paddingVertical:e.spaces.space12},isNarrow:{maxHeight:"168px",overflow:"auto"}})));var O=T,k=i("krmn"),L=i("cIoY"),D=i("w3n3"),P=i("MLl7"),F=i("3XMw"),B=i.n(F),N=i("J2UM"),U=i("VPdC"),j=i("pKoL"),H=i("eyty"),W=i("oQhu"),z=i("JYMr");class V extends r.Component{constructor(...e){super(...e),n()(this,"state",{currentStepIndex:-1})}componentDidMount(){this._scheduleNextStep(0)}componentWillUnmount(){this._currentTimeoutId&&clearTimeout(this._currentTimeoutId)}render(){const{steps:e}=this.props,{currentStepIndex:t}=this.state,i=t>=0&&t<e.length?e[t].progress:0;return r.createElement(z.a,{progress:i})}_scheduleNextStep(e){const{steps:t}=this.props;e<t.length&&(this._currentTimeoutId=setTimeout((()=>{this._currentTimeoutId=void 0,this.setState({currentStepIndex:e}),this._scheduleNextStep(e+1)}),t[e].waitMs))}}n()(V,"defaultProps",{steps:[{waitMs:1e3,progress:.1},{waitMs:1400,progress:.3},{waitMs:1800,progress:.5},{waitMs:2400,progress:.6},{waitMs:3e3,progress:.9}]});class q extends r.PureComponent{render(){const{isSending:e,isUploading:t,progress:i}=this.props;return e&&!t?r.createElement(V,null):r.createElement(z.a,{progress:e?Math.max(i,.02):0})}}var G=q,Q=i("Dtul"),K=i("Es6L"),$="dmComposerAttachments",Y="dmComposerTextInput",X="dmComposerSendButton",J=i("GZwR"),Z=i("aITJ"),ee=i("6OUF"),te=i("9Xij"),ie=i("/yvb"),se=i("gpVt"),ne=i("Lsrn"),re=i("k/Ka");const ae=(e={})=>Object(re.a)("svg",{...e,style:[ne.a.root,e.style],viewBox:"0 0 24 24"},r.createElement("g",null,r.createElement("path",{d:"M21.13 11.358L3.614 2.108c-.29-.152-.64-.102-.873.126-.23.226-.293.577-.15.868l4.362 8.92-4.362 8.92c-.143.292-.08.643.15.868.145.14.333.212.523.212.12 0 .24-.028.35-.087l17.517-9.25c.245-.13.4-.386.4-.664s-.155-.532-.4-.662zM4.948 4.51l12.804 6.762H8.255l-3.307-6.76zm3.307 8.26h9.498L4.948 19.535l3.307-6.763z"})));ae.metadata={width:24,height:24};var oe=ae;const ce=(e={})=>Object(re.a)("svg",{...e,style:[ne.a.root,e.style],viewBox:"0 0 24 24"},r.createElement("g",null,r.createElement("path",{d:"M19 13.5H5c-.828 0-1.5-.672-1.5-1.5s.672-1.5 1.5-1.5h14c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5zm0 6H5c-.828 0-1.5-.672-1.5-1.5s.672-1.5 1.5-1.5h14c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5zm0-12H5c-.828 0-1.5-.672-1.5-1.5S4.172 4.5 5 4.5h14c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5z"})));ce.metadata={width:24,height:24};var le=ce;const de=(e={})=>Object(re.a)("svg",{...e,style:[ne.a.root,e.style],viewBox:"0 0 24 24"},r.createElement("g",null,r.createElement("path",{d:"M19 13H5c-.553 0-1-.447-1-1s.447-1 1-1h14c.553 0 1 .447 1 1s-.447 1-1 1zm0 6H5c-.553 0-1-.447-1-1s.447-1 1-1h14c.553 0 1 .447 1 1s-.447 1-1 1zm0-12H5c-.553 0-1-.447-1-1s.447-1 1-1h14c.553 0 1 .447 1 1s-.447 1-1 1z"})));de.metadata={width:24,height:24};var he=de,pe=i("iySH");const ue=B.a.ee230734,me=B.a.ca0ce0e4,fe=B.a.cdcebd22,ge=B.a.e3275464,be=B.a.ic8c615d,_e=B.a.a04077c4,ve=e=>!(!e||!e.media),ye=Object(p.b)({maxNumberOfPhotos:1}),Ee=r.createElement(oe,null);class Se extends r.Component{constructor(e,t){super(e,t),n()(this,"_handleLayout",(e=>{const{onHeightChange:t}=this.props,{mediaButtonsCollapsible:i}=this.state,s=e.nativeEvent.layout;s&&(Object(K.a)()||t&&t(s.height),s.width<=C.a.theme.breakpoints.small&&!i?this.setState({mediaButtonsCollapsible:!0}):s.width>C.a.theme.breakpoints.small&&i&&this.setState({mediaButtonsCollapsible:!1}))})),n()(this,"_renderQuickReplyPicker",(()=>{const{quickReplyOptions:e}=this.props,{isQuickReplyOpen:t}=this.state;return e&&t?r.createElement(O,{onOptionChoose:this._handleQROptionSelection,quickReplyOptions:e}):null})),n()(this,"_renderComposeBox",(()=>r.createElement(f.a,{style:Ce.composeBoxContainer},this._renderMainContent()))),n()(this,"_renderMainContent",(()=>{const{typeaheadWrapper:e}=this.props,{value:t}=this.state,i=e;return i?r.createElement(i,{contextText:t,isInline:!0,onTextUpdated:this._handleTextChange,onTypeaheadStateChange:this._handleTypeaheadStateChange,source:J.d.ComposeMessage},this._renderFieldTextInput):this._renderFieldTextInput()})),n()(this,"_renderFieldTextInput",(e=>{const{disabled:t,placeholderText:i,richTextInputContext:s}=this.props,n=Z.b.isKaiOS()?fe:i||me,{editorState:a,value:o}=this.state,c=!!s,l=s?{editorState:a,element:s.element}:void 0;return r.createElement(ee.a,{contentAbove:this._renderAttachments(),editable:!t,emojiPickerButton:this._renderEmojiPicker(),handleReturn:c?this._handleReturn:void 0,inputStyle:Ce.composeTextInput,maxNumberOfLines:c?8:4,multiline:!0,numberOfLines:1,onBlur:this._handleOnBlur,onChange:e?this._getHandleChange(e):this._handleTextChange,onFilesAdded:this._handleAddMediaFiles,onFocus:this._handleTextInputFocus,onKeyPress:c?void 0:this._handleReturn,placeholder:n,ref:this._setTextInputRef,richTextInputContext:t?void 0:l,style:Ce.composeInput,testID:Y,useCacheForDOMMeasurements:!this._isSendDisabled(),value:o})})),n()(this,"_getHandleChange",Object(W.a)((e=>t=>{e(t),this._handleTextChange(t)}))),n()(this,"_handleTypeaheadStateChange",(e=>{this.setState({isTypeaheadActive:e})})),n()(this,"_renderAttachments",(()=>{const{attachment:e,conversationId:t,isCardPreviewTombstoned:i,isShareViaDM:s,isUploading:n,mediaMetadata:a}=this.props,{value:o}=this.state,{height:c,width:l}=e&&(e.media&&e.media.mediaFile||e.provider&&e.media&&e.media.externalMediaDetails)||{},d=null==e?void 0:e.media,h=d&&d.id.toString(),p=a&&h&&a[h]&&a[h].altText,u=a&&h&&a[h]&&a[h].defaultAltText,m=Object(se.b)(o);return r.createElement(r.Fragment,null,d?r.createElement(f.a,{style:Ce.attachmentContainer,testID:$},r.createElement(te.a,{ratio:l/c,style:Ce.aspectContainer},r.createElement(f.a,{style:Ce.mediaPreviewContainer},r.createElement(j.a,{accessibilityLabel:p||u,mediaItem:d,onClick:this.canEditImage?this._handleClickMediaDetail:void 0,onEdit:this.canEditImage?this._handleClickMediaDetail:void 0,onRemove:this._handleRemoveMedia(d.id),resizeIfNeeded:"width",style:[Ce.mediaPreview],withAltTextLabel:!!p,withCloseButton:!n,withEditButton:this.canEditImage&&!n}))),e&&e.provider&&e.gifUrl&&r.createElement(f.a,{style:Ce.gifAttribution},r.createElement(L.a,{gifUrl:e.gifUrl,provider:e.provider}))):m&&!s?r.createElement(se.a,{conversationId:t,isCardPreviewTombstoned:i,style:Ce.cardPreviewContainer,urls:m}):null)})),n()(this,"_renderEmojiPicker",(()=>{const{withEmojiPicker:e}=this.props;return e&&Z.b.isDesktopOS()?r.createElement(k.a,{disabled:this.props.disabled,onEmojiSelect:this._handleEmojiSelect,onPress:this._handleTextInputFocus,size:"normalCompact",textInputRef:this._textInput||void 0}):null})),n()(this,"_renderActionButton",(e=>{const{quickReplyOptions:t}=this.props,i=this._hasMessageText();return!t||i||e?r.createElement(ie.a,{accessibilityLabel:ge,disabled:this._isSendDisabled(),hoverLabel:{label:ge},icon:Ee,onPress:this._handleSend,size:"normal",style:Ce.actionButton,testID:X,type:"text"}):this._renderQRToggleButton()})),n()(this,"_renderQRToggleButton",(()=>{const{isQuickReplyOpen:e}=this.state;return r.createElement(ie.a,{accessibilityLabel:be,icon:e?r.createElement(le,null):r.createElement(he,null),onPress:this._handleQuickReplyPickerToggle,size:"normal",style:Ce.actionButton,type:"text"})})),n()(this,"_renderComposer",(()=>{const{attachment:e}=this.props,t=ve(e),i=this._renderComposeBox(),s=this._renderActionButton(t);return r.createElement(f.a,{style:[Ce.composer,t&&Ce.composerWithAttachment]},t?null:this._renderMediaButtons(),i,s)})),n()(this,"_renderMediaButtons",(()=>{const{withGifPicker:e,withMediaPicker:t}=this.props,{mediaButtonsCollapsed:i,mediaButtonsCollapsible:s}=this.state,n=s&&i;return r.createElement(f.a,{style:Ce.uploadButtons},n?r.createElement(ie.a,{accessibilityLabel:ue,icon:r.createElement(pe.a,null),onMouseDown:this._handleShowMediaControlsMouseDown,type:"text"}):null,t&&!n?this._renderMediaPicker():null,e&&!n?this._renderGifButton():null)})),n()(this,"_handleShowMediaControlsMouseDown",(()=>{const{scribeAction:e,scribeNamespace:t}=this.props;this.setState({mediaButtonsCollapsed:!1}),e({...t,component:"dm_composer",element:"toggle",action:"expand"})})),n()(this,"_handleReturn",(e=>{const{nativeEvent:{ctrlKey:t,key:i,metaKey:s,shiftKey:n}}=e,r="Enter"===i,{isTypeaheadActive:a}=this.state;if(!a&&r&&this._keyboardOrMouseDetected&&!(n||s||t))return e.preventDefault(),this._handleSend(e),"handled"})),n()(this,"_handleClickMediaDetail",(()=>{const{attachment:e,conversationId:t,history:i}=this.props;if(this.canEditImage){const s=e&&e.media?e.media.id:0;i.push("/messages/compose/media",{mediaId:s,conversationId:t,tab:"crop"})}})),n()(this,"_handleAddMediaFiles",(e=>{const{addMedia:t,addToast:i,dataSaverMode:s,onAddMedia:n,processMultipleMedia:r,removeMediaUpload:a,removeMedia:o,uploadMedia:c}=this.props;t(e,{location:H.d.Dm}).then((e=>{const t=e.map((e=>e.id));this._validateMedia(e)?(n&&n(t),r(e,{onFailure:o}).then((e=>{s||c(e.map((e=>e.id)),{preUpload:!0})}))):(i({text:_e}),a(t))}))})),n()(this,"_handleEmojiSelect",(e=>{const{editorState:t}=this.state,{richTextInputContext:i}=this.props;if(!i)return;const s=i.insertTextAtCursor(t,e.text);this._handleTextChange(s)})),n()(this,"_handleRemoveMedia",(e=>()=>{this.props.removeMedia&&this.props.removeMedia(e)})),n()(this,"_handleSend",(e=>{if(!this._isSendDisabled()){const{onSend:t}=this.props;this._textInput&&this._textInput.applyFinalValue((i=>{t(e,i)})),this._closeQuickReplyPicker()}})),n()(this,"_handleTextChange",(e=>{const{onTyping:t,richTextInputContext:i}=this.props,{value:s}=this.state;let n;if(i){const t=e.getCurrentContent().getPlainText(),s=i.convertEmojiToEntities(e);n=t,this.setState({editorState:s,value:n})}else n=e.target.value,this.setState({value:n});s!==n&&t&&t()})),n()(this,"_handleOnBlur",(()=>{const{onBlur:e}=this.props,{mediaButtonsCollapsible:t}=this.state;e&&e(),t&&this.setState({mediaButtonsCollapsed:!1})})),n()(this,"_handleTextInputFocus",(()=>{const{quickReplyOptions:e}=this.props,{isQuickReplyOpen:t,mediaButtonsCollapsible:i}=this.state;e&&t&&this._closeQuickReplyPicker(),i&&this.setState({mediaButtonsCollapsed:!0})})),n()(this,"_handleQROptionSelection",((e,t)=>{const{onSend:i,disabled:s}=this.props;s||(i({quickReply:{id:e,selected_id:t.id}},t.label),this._closeQuickReplyPicker())})),n()(this,"_handleQuickReplyPickerToggle",(()=>{this.setState({isQuickReplyOpen:!this.state.isQuickReplyOpen})})),n()(this,"_validateMedia",(e=>!ve(this.props.attachment)&&ye(e))),n()(this,"_detectKeyboardOrMouse",(e=>{const{registerSome:t,KEYBOARD:i,MOUSE:s}=e;t((()=>{this._keyboardOrMouseDetected=!0}),[i,s])})),n()(this,"_isSendDisabled",(()=>{const{attachment:e,canSendEmptyMessage:t,disabled:i,isUploading:s}=this.props,n=ve(e),r=this._hasMessageText()||t,a=!(!e||!e.media)&&(e.media.needsProcessing||s);return i||!r&&!n||a||s})),n()(this,"_hasMessageText",(()=>!!(this.state.value||"").trim())),n()(this,"_closeQuickReplyPicker",(()=>{this.setState({isQuickReplyOpen:!1})})),n()(this,"_setTextInputRef",(e=>{this._textInput=e}));const{richTextInputContext:i,prefillText:s}=e,{initEditorState:a}=i||{};this.state={isQuickReplyOpen:!0,value:s,editorState:a&&a(s),isTypeaheadActive:!1,mediaButtonsCollapsed:!1,mediaButtonsCollapsible:!1}}componentDidMount(){Object(N.a)().then(this._detectKeyboardOrMouse),this._unlockReload=Q.a.acquire()}componentWillUnmount(){this._unlockReload()}componentDidUpdate(){this.props.quickReplyOptions&&this.state.isQuickReplyOpen&&this._textInput&&this._textInput.blur()}UNSAFE_componentWillReceiveProps(e){const t=this.props.quickReplyOptions,i=e.quickReplyOptions;t&&!i?this.setState({isQuickReplyOpen:!1}):(!t&&i||t&&i&&t.id!==i.id)&&this.setState({isQuickReplyOpen:!0}),this.props.conversationId!==e.conversationId&&this.clear()}render(){const{dtabBarInfo:e,placeholderText:t,mediaUploadProgress:i,isSending:s,isUploading:n,style:a}=this.props,o=t||me,c=Object(K.a)(),l=c&&e&&(e.dtabAll||e.ttsToken)&&!e.hide;return r.createElement(v,{accessibilityLabel:o,accessibilityRole:"complementary",onLayout:this._handleLayout,sideNavPresent:c,style:[Ce.root,l&&Ce.dtabOffset,a]},r.createElement(G,{isSending:s,isUploading:n,progress:s?Math.max(i,.02):0}),this._renderComposer(),this._renderQuickReplyPicker())}_renderMediaPicker(){return r.createElement(U.a,{onChange:this._handleAddMediaFiles,style:Ce.mediaPicker,type:"text"})}_renderGifButton(){const{conversationId:e,history:t}=this.props;return r.createElement(D.a,{dmConversationId:e,enabled:!0,gifSearchKeySource:P.a.DMComposition,history:t})}get canEditImage(){const{attachment:e}=this.props;return!!(e&&e.media&&e.media.mediaFile&&e.media.mediaFile.isImage)}clear(){const{richTextInputContext:e}=this.props;if(e){const{initEditorState:t}=e||{};this.setState({value:"",editorState:t&&t("")})}else this.setState({value:""})}focus(){this._textInput&&this._textInput.focus()}value(){return this.state.value}}n()(Se,"defaultProps",{prefillText:"",withEmojiPicker:!0,withGifPicker:!0,withMediaPicker:!0});const Ce=C.a.create((e=>({root:{backgroundColor:e.colors.navigationBackground,borderTopColor:e.colors.borderColor,borderTopWidth:e.borderWidths.small},attachmentContainer:{maxHeight:"10rem",margin:e.spaces.space12},aspectContainer:{flexShrink:1},cardPreviewContainer:{margin:e.spaces.space12},dtabOffset:{marginBottom:e.spaces.space40},gifAttribution:{flexDirection:"row",marginVertical:e.spaces.space4,marginHorizontal:0},mediaPicker:{margin:0},icon:{color:e.colors.primary,fontSize:"1.5em"},composeBoxContainer:{flexGrow:1,flexShrink:1,alignSelf:"center"},composeInput:{width:"100%"},composeTextInput:{paddingVertical:e.spaces.space4,alignSelf:"center"},mediaPreviewContainer:{flexDirection:"row",height:"100%"},mediaPreview:{borderRadius:e.borderRadii.xLarge,overflow:"hidden"},composer:{alignItems:"flex-end",flexDirection:"row",padding:e.spaces.space4,width:"100%"},composerWithAttachment:{paddingLeft:e.spaces.space12},actionButton:{marginLeft:e.spaces.space4},uploadButtons:{flexDirection:"row",marginRight:e.spaces.space4}})));t.a=h.forwardRef(Se)},vboP:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var s=i("ERkP"),n=i("t62R"),r=i("9Xij"),a=i("/yvb"),o=i("cm6r"),c=i("rHpw"),l=i("MWbm"),d=i("0weh"),h=i("iySH");const p="rgb(74, 93, 106, 0.75) 0%, rgba(74, 93, 106, 0.5) 25%, rgba(74, 93, 106, 0.22) 45%,rgba(74, 93, 106, 0.05) 60%, rgba(74, 93, 106, 0.015) 66%, rgba(74, 93, 106, 0) 70%";function u(e){const{buttonLabel:t,children:i,description:c,isInterstitialed:p,isMisinformation:u,onBackgroundClick:g,onButtonClick:b,pivot:_,pivotLink:v}=e,y=e=>{e.stopPropagation(),e.preventDefault(),g&&g()},E=e=>{e.stopPropagation(),e.preventDefault(),b()},S=e=>{e.stopPropagation()};return p?s.createElement(r.a,{ratio:9/16},s.createElement(l.a,{accessibilityRole:g?"button":void 0,onClick:g?y:void 0,style:m.root},s.createElement("div",{style:f.radialGradientOne}),s.createElement("div",{style:f.radialGradientTwo}),s.createElement(l.a,{style:m.contentWrapper},s.createElement(n.c,{align:"center",color:"white",style:m.description},c),s.createElement(a.a,{accessibilityLabel:t,onPress:E,type:"invertedSecondary"},t),_&&v?s.createElement(o.a,{accessibilityLabel:_,interactiveStyles:null,link:v,onClick:S,style:m.pivotWrapper},(({isFocusedWithin:e,isFocused:t,isHovered:i,isPressed:r})=>{const a=e||t||i||r;return s.createElement(s.Fragment,null,u?s.createElement(d.a,{style:m.icon}):null,s.createElement(n.c,{align:"center",color:u?"red500":"white",style:[a&&m.linkUnderline,u&&m.misinformationContent],weight:"bold"},_),u?s.createElement(h.a,{style:m.icon}):null)})):null))):i}const m=c.a.create((e=>({root:{backgroundColor:"#15202b",height:"100%",overflow:"hidden",position:"relative"},contentWrapper:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",paddingHorizontal:e.spacesPx.space32,position:"absolute",left:0,top:0,width:"100%"},description:{marginBottom:e.spacesPx.space20,width:"100%"},icon:{color:e.colors.red500,minWidth:e.spacesPx.space20},linkUnderline:{textDecorationColor:e.colors.white,textDecorationLine:"underline",textDecorationStyle:"solid",textDecorationThickness:e.spacesPx.space1},misinformationContent:{marginHorizontal:e.spacesPx.space12,textDecorationColor:e.colors.red500},pivotWrapper:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"center",marginTop:e.spacesPx.space20}}))),f={radialGradientOne:{backgroundImage:`radial-gradient(circle at top left, ${p})`,height:"100%",position:"absolute",left:0,top:0,width:"100%"},radialGradientTwo:{backgroundImage:`radial-gradient(circle at bottom right, ${p})`,bottom:"-30%",height:"100%",position:"absolute",right:"-30%",width:"150%"}}},zQEV:function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"a",(function(){return m}));var s=i("ERkP"),n=i("t62R"),r=i("aWyx"),a=i("3XMw"),o=i.n(a);const c=o.a.c1d4ac83,l=o.a.abc7b032,d=o.a.i263b293,h=({conversationId:e,children:t})=>s.createElement(n.c,{link:`/messages/${e}/participants`},t),p=(e,t)=>e>=2?s.createElement(o.a.I18NFormatMessage,{$i18n:"e3534476"},s.createElement(h,{conversationId:t},o.a.d1242bcc({count:e}))):s.createElement(o.a.I18NFormatMessage,{$i18n:"b6656850",count:e}),u=({entry:e,users:t})=>e.participants?s.createElement("span",null,e.participants.map((({user_id:e},i)=>{const r=t[e];return r?s.createElement("span",{key:i},i>0?", ":null,s.createElement(n.c,null,r.name)):null}))):null,m=(e,t,i,a)=>{const h=i===e.by_user_id;let p;switch(t){case r.b.CONVERSATION_AVATAR_UPDATE:return p=e.by_user_id&&a[e.by_user_id]&&a[e.by_user_id].name,p?h?c:(e=>s.createElement(o.a.I18NFormatMessage,{$i18n:"bff29c94"},s.createElement(n.c,null,e)))(p):l;case r.b.CONVERSATION_NAME_UPDATE:{const t=s.createElement(n.c,null,e.conversation_name);return p=e.by_user_id&&a[e.by_user_id]&&a[e.by_user_id].name,p?h?(e=>s.createElement(o.a.I18NFormatMessage,{$i18n:"b16e4d45"},e))(t):((e,t)=>s.createElement(o.a.I18NFormatMessage,{$i18n:"c5760698"},s.createElement(n.c,null,e),t))(p,t):(e=>s.createElement(o.a.I18NFormatMessage,{$i18n:"a72730a0"},e))(t)}case r.b.JOIN_CONVERSATION:return p=e.sender_id&&a[e.sender_id]&&a[e.sender_id].name,p?(e=>s.createElement(o.a.I18NFormatMessage,{$i18n:"fa95b019"},s.createElement(n.c,null,e)))(p):d;case r.b.PARTICIPANTS_LEAVE:return(e=>s.createElement(o.a.I18NFormatMessage,{$i18n:"fc10875e"},e))(s.createElement(u,{entry:e,users:a}));case r.b.PARTICIPANTS_JOIN:p=e.sender_id&&a[e.sender_id]&&a[e.sender_id].name;return((e,t)=>e?s.createElement(o.a.I18NFormatMessage,{$i18n:"a4bc88c2"},s.createElement(n.c,null,e),t):s.createElement(o.a.I18NFormatMessage,{$i18n:"bfdff0c3"},t))(p,s.createElement(u,{entry:e,users:a}));default:return""}}}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.DMDrawer~bundle.DMRichTextCompose~bundle.DirectMessages.15725c65.js.map