(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"AEu/":function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationHiddenRepliesScreen",(function(){return N}));var r=a("KEM+"),n=a.n(r),o=a("ERkP"),c=a("es0u"),i=a("oEGd"),s=a("0KEI"),l=a("hqKg"),d=a("8Lfv"),u=a("G6rE");const g=Object(l.createSelector)(((e,t)=>t.match.params.screenName),((e,t)=>t.match.params.statusId),((e,t)=>"PUSH"===t.history.action),u.e.selectLoggedInUser,((e,t,a,r)=>({loggedInScreenName:r?r.screen_name:void 0,screenName:e,statusId:t,isForwardNavigation:a}))),m={createLocalApiErrorHandler:Object(s.d)("HIDDEN_REPLIES_PAGE"),clearTimelineCache:e=>Object(d.a)(e)};var h=Object(i.g)(g,m),p=a("7JQg"),_=a("xZXe"),y=a("QIgh"),b=a("8UdT"),E=a("IcAo"),f=a("VrCx"),A=a("yy6l");const T=e=>Object(A.a)({component:_.a,createAdditionalProps:()=>({withUnhideReply:e}),displayBlocked:!0,divider:{top:!0,bottom:!0}});var O=({withUnhideReply:e})=>Object(E.a)({},y.b,{[b.b.Tweet]:{handlers:{[f.a.Tweet]:T(e)}}}),I=a("WU0f"),k=a("yoO3"),w=a("fTQJ"),S=a("VS6U"),P=a("t62R"),L=a("FIs5"),C=a("I7xG"),v=a("3XMw"),B=a.n(v);const x=B.a.d806aa19,D=B.a.d80c77dc,F=B.a.ef939f4b,R=B.a.f7f2db4f,q=o.createElement(B.a.I18NFormatMessage,{$i18n:"cf1aca58"},o.createElement(P.c,{link:"https://help.twitter.com/using-twitter/mentions-and-replies#hidden-reply"},B.a.a7511618)),j=()=>o.createElement(L.a,{header:R,message:q});class N extends o.Component{constructor(e){super(e),n()(this,"_getModule",Object(C.a)(this,(e=>e.statusId),(e=>Object(I.a)(e)))),this._clearTimelineCache()}render(){const{history:e,loggedInScreenName:t,screenName:a,statusId:r}=this.props;return a&&r?o.createElement(k.a,null,o.createElement(S.a,{backLocation:`/${a.toLowerCase()}/status/${r}`,history:e,primaryContent:this._renderPrimaryContent(),sidebarContent:o.createElement(c.a,null),subtitle:a===t?D:F({screenName:a}),title:x})):null}_renderPrimaryContent(){const{loggedInScreenName:e,screenName:t}=this.props;return o.createElement(w.a,{entryConfiguration:O({withUnhideReply:t===e}),module:this._getModule(),renderEmptyState:j,title:x})}_clearTimelineCache(e=this._getModule()){const{clearTimelineCache:t,createLocalApiErrorHandler:a,isForwardNavigation:r}=this.props;r&&t(e).catch(a({}))}}t.default=Object(p.c)({page:"tweet",section:"moderated_replies"})(h(N))},DL4F:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationAnalyticsScreen",(function(){return B}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("ERkP")),c=a("v6aA"),i=(a("VAZu"),a("zh9S")),s=a("oEGd"),l=a("0KEI"),d=a("hqKg"),u=a("XOJV");const g=(e,t)=>t.match.params.statusId,m=Object(d.createSelector)(((e,t)=>u.a.selectFetchStatus(e,g(0,t))),g,((e,t)=>u.a.selectHydrated(e,g(0,t))),((e,t,a)=>({fetchStatus:e,statusId:t,tweet:a}))),h={createLocalApiErrorHandler:Object(l.d)("CONVERSATION_ANALYTICS_SCREEN"),fetchTweetIfNeeded:u.a.fetchOneIfNeeded,scribeAction:i.c};var p=Object(s.g)(m,h),_=a("7JQg"),y=a("v//M"),b=a("W5XZ"),E=a("jHSc"),f=a("3XMw"),A=a.n(f),T=a("SrIh"),O=a("Rp9C"),I=a("E0cF"),k=a("q9Zt"),w=a("bPFD"),S=a("rHpw"),P=a("yE5w");const L=A.a.g9079b93,C=A.a.a57daeb1,v=A.a.deaf5b15;class B extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleFetchTweet",(()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;t(a).catch(e(b.a))})),n()(this,"_render",(()=>{const{tweet:e}=this.props,t=e&&I.a.getOriginalTweet(e)||void 0;if(!t||t&&t.user.id_str!==this.context.loggedInUserId)return o.createElement(k.a,{onRetry:null,title:L});{const e="";return o.createElement(w.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:T.a,src:`${e}/i/tfb/v1/quick_promote/lite/${t.id_str}`,style:x.iframe})}})),n()(this,"_setAppBarRef",(e=>{this._appBarRef=e})),n()(this,"_handleGoBack",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})})),n()(this,"_handleIFrameMessage",(e=>{if(e&&"quick_promote"===e.name)if("scribe"===e.type){const{scribeAction:t,scribeNamespace:a,tweet:r}=this.props,n=r&&I.a.getOriginalTweet(r)||void 0,o=e.scribeData||{};t({...a,component:"string"==typeof o.component?o.component:"quick_promote",action:"string"==typeof o.uiEvent?o.uiEvent:""},{...o,items:n?[O.a.getTweetItem(n)]:[]})}else if("navigation"===e.type){const{history:e,match:t,tweet:a}=this.props,r=a&&I.a.getOriginalTweet(a);r&&e.push(`/${t.params.screenName}/status/${r.id_str}/${P.a.Rweb}/${P.c.Intro}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()}))}componentDidMount(){this._handleFetchTweet()}render(){const{fetchStatus:e,history:t,tweet:a}=this.props,r=a&&I.a.getOriginalTweet(a)||void 0;return o.createElement(E.b,{appBarRef:this._setAppBarRef,backLocation:r?r.permalink:"/",history:t,onBackClick:this._handleGoBack,title:C},o.createElement(y.a,{fetchStatus:e,render:this._render,retryMessage:v}))}}n()(B,"contextType",c.a);const x=S.a.create((e=>({iframe:{flexGrow:1}})));t.default=Object(_.c)({page:"tweet",section:"analytics"})(p(B))},JiIh:function(e,t,a){"use strict";var r=a("ERkP"),n=a("0GBF");t.a=e=>r.createElement(n.a,e)},aH1V:function(e,t,a){"use strict";a.r(t),a.d(t,"QuickPromoteScreen",(function(){return cn}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("ERkP"));function c(e){throw new Error("Not reachable section reached!")}var i=a("E89d"),s=a("v6aA"),l=a("97Jx"),d=a.n(l),u=a("rxPX"),g=a("0KEI"),m=a("RqPI"),h=a("oEOe"),p=a("kGix"),_=a("3A2y"),y=a("Ssj5");const b=Object.freeze({Any:"AnyGender",Male:"Male",Female:"Female"}),E=Object.freeze({AGE_13_TO_24:"Age13To24",AGE_13_TO_34:"Age13To34",AGE_13_TO_49:"Age13To49",AGE_13_TO_54:"Age13To54",AGE_18_TO_24:"Age18To24",AGE_18_TO_34:"Age18To34",AGE_18_TO_49:"Age18To49",AGE_18_TO_54:"Age18To54",AGE_21_TO_34:"Age21To34",AGE_21_TO_49:"Age21To49",AGE_21_TO_54:"Age21To54",AGE_25_TO_49:"Age25To49",AGE_25_TO_54:"Age25To54",AGE_35_TO_49:"Age35To49",AGE_35_TO_54:"Age35To54",AGE_OVER_13:"AgeOver13",AGE_OVER_18:"AgeOver18",AGE_OVER_21:"AgeOver21",AGE_OVER_25:"AgeOver25",AGE_OVER_35:"AgeOver35",AGE_OVER_50:"AgeOver50"}),f=Object.freeze({[E.AGE_13_TO_24]:{minAge:"13",maxAge:"24"},[E.AGE_13_TO_34]:{minAge:"13",maxAge:"34"},[E.AGE_13_TO_49]:{minAge:"13",maxAge:"49"},[E.AGE_13_TO_54]:{minAge:"13",maxAge:"54"},[E.AGE_18_TO_24]:{minAge:"18",maxAge:"24"},[E.AGE_18_TO_34]:{minAge:"18",maxAge:"34"},[E.AGE_18_TO_49]:{minAge:"18",maxAge:"49"},[E.AGE_18_TO_54]:{minAge:"18",maxAge:"54"},[E.AGE_21_TO_34]:{minAge:"21",maxAge:"34"},[E.AGE_21_TO_49]:{minAge:"21",maxAge:"49"},[E.AGE_21_TO_54]:{minAge:"21",maxAge:"54"},[E.AGE_25_TO_49]:{minAge:"25",maxAge:"49"},[E.AGE_25_TO_54]:{minAge:"25",maxAge:"54"},[E.AGE_35_TO_49]:{minAge:"35",maxAge:"49"},[E.AGE_35_TO_54]:{minAge:"35",maxAge:"54"},[E.AGE_OVER_13]:{minAge:"13"},[E.AGE_OVER_18]:{minAge:"18"},[E.AGE_OVER_21]:{minAge:"21"},[E.AGE_OVER_25]:{minAge:"25"},[E.AGE_OVER_35]:{minAge:"35"},[E.AGE_OVER_50]:{minAge:"50"}}),A=Object.freeze({13:{24:E.AGE_13_TO_24,34:E.AGE_13_TO_34,49:E.AGE_13_TO_49,54:E.AGE_13_TO_54,over:E.AGE_OVER_13},18:{24:E.AGE_18_TO_24,34:E.AGE_18_TO_34,49:E.AGE_18_TO_49,54:E.AGE_18_TO_54,over:E.AGE_OVER_18},21:{34:E.AGE_21_TO_34,49:E.AGE_21_TO_49,54:E.AGE_21_TO_54,over:E.AGE_OVER_21},25:{49:E.AGE_25_TO_49,54:E.AGE_25_TO_54,over:E.AGE_OVER_25},35:{49:E.AGE_35_TO_49,54:E.AGE_35_TO_54,over:E.AGE_OVER_35},50:{over:E.AGE_OVER_50}});a("MvUL"),a("gYAx"),a("gFSH");var T=a("3XMw"),O=a.n(T),I=a("SrIh"),k=a("9OUN"),w=a("06wh");const S=Object.freeze({});function P(e,t){const a=Object(w.a)("rweb/ads/typeahead",e);return{typeaheadApiActionTypes:a,getTypeaheadResults:(r,n)=>(o,c,{api:i})=>{const s=c().ads.typeahead[e][r];if(null!=s&&s.result)return Promise.resolve(s.result);return Object(h.b)(o,{request:t(i),params:n})({actionTypes:a,context:`ADS_TYPEAHEAD_${e}`,meta:{query:r}})},reducer:(e=S,t)=>{switch(t.type){case a.REQUEST:{const{query:a}=t.meta;return{...e,[a]:{fetchStatus:p.a.LOADING}}}case a.FAILURE:{const{error:a,meta:{query:r}}=t;return{...e,[r]:{fetchStatus:p.a.FAILED,error:a}}}case a.SUCCESS:{const{meta:{query:a},payload:r}=t;return{...e,[a]:{fetchStatus:p.a.LOADED,result:r}}}default:return e}}}}const L=P("targetingLocation",(e=>e.Ads.getQueriedTargetableLocations)),C=P("forecastAudience",(e=>e.QuickPromote.getAudienceEstimate)),v={targetingLocation:L.reducer,forecastAudience:C.reducer},B={typeahead:Object(k.c)(v)},x=Object(k.c)(B);y.a.register({ads:x});var D=a("yE5w");const F=O.a.i976aff3,R=[p.a.LOADING,p.a.LOADED],q=(e,t)=>(a,r,{api:n})=>{var o,c;const{dailyBudget:i,currency:s}=r().quickPromote.budget,l=pe(r()),{user_id:d}=r().session,u=null==(o=r().quickPromote.account.adsAccount)?void 0:o.id,{ageBucket:g,gender:m,targetedLocations:[{targeting_value:h}]}=r().quickPromote.targeting;if(R.includes(null==(c=r().ads.typeahead.forecastAudience[l])?void 0:c.fetchStatus)||!d||!g)return Promise.resolve();const p=Math.round(1e6*i),_=p,y=j(r());return Object(D.m)(t)(D.k.audienceEstimateCall({dailyBudgetMicros:p,totalBudgetMicros:_,ageBucket:g,gender:m,location:h})),a(C.getTypeaheadResults(l,{userId:d,adAccountId:`${parseInt(u,36)}`,tweetId:e,dailyBudgetMicros:`${p}`,totalBudgetMicros:`${_}`,currency:null!=s?s:"USD",targeting:y})).then((()=>{var e,a;const n=null==(e=r().ads.typeahead.forecastAudience[l])||null==(a=e.result)?void 0:a.estimatedImpressions;n?Object(D.m)(t)(D.k.audienceEstimateSuccess({dailyBudgetMicros:p,totalBudgetMicros:_,ageBucket:g,gender:m,location:h,estimatedImpressions:n})):Object(D.m)(t)(D.k.audienceEstimateFail({dailyBudgetMicros:p,totalBudgetMicros:_,ageBucket:g,gender:m,location:h}))}))};function j(e){const{targetedLocations:t,ageBucket:a,gender:r}=e.quickPromote.targeting;return{geos:t.map((({targeting_value:e})=>({location_id:e}))),age_buckets:[{age_bucket:a}],gender:{gender:r}}}const N=e=>(t,a,{userPersistence:r})=>{const{quickPromote:n}=a(),{targeting:{targetedLocations:o,ageBucket:c,gender:i},budget:{dailyBudget:s,durationDays:l,currency:d}}=n;return r.set("rweb.quickPromoteRedirectBack",e?{platformType:e,ageBucket:c,gender:i,targetedLocations:o,dailyBudget:s,durationDays:l,lastPersisted:(new Date).getTime(),currency:d}:null)},G=(e,t)=>(a,r,{api:n})=>!t&&R.includes(r().quickPromote.account.accountDataFetchStatus)?Promise.resolve():(a(Ae(p.a.LOADING)),M(n)(e).then((e=>{if(e){const{account:t}=e;return a(be(t)),U(n)(t.id).then((e=>{a(Ee(e)),a(fe(e[0]||null))}))}})).then((()=>a(Ae(p.a.LOADED)))).catch((e=>{throw a(Ae(p.a.FAILED)),e}))),M=e=>t=>e.Ads.getAccounts().then((t=>Promise.all(t.map((t=>e.Ads.getPromoteableUsers(t.id).then((e=>({promoteableUsers:e,account:t}))).catch((()=>{}))))))).then((e=>e.filter(Boolean))).then((e=>e.find((({promoteableUsers:e})=>e.find((e=>e.user_id===t)))))),U=e=>t=>e.Ads.getFundingInstruments(t).then((e=>e.filter((({able_to_fund:e,description:t})=>e&&!/no payment method/.test(t))))),H=e=>(t,a)=>{t(Ie(e));const r=Object(m.f)(a());return t(L.getTypeaheadResults(e,{query:e,lang:r}))},V=()=>(e,t,{api:a,scribe:r})=>{if(R.includes(t().quickPromote.targeting.initialTargetedLocationsFetchStatus)||t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();const n=Object(m.l)(t())||"US",o=t().session.language;return e(Te(p.a.LOADING)),a.Ads.getTargetableLocations({countryCode:n,lang:o,locationType:"COUNTRIES"}).then((e=>e.length?e:(Object(I.a)(`Country not found: ${n}`),a.Ads.getTargetableLocations({countryCode:"US",lang:o,locationType:"COUNTRIES"})))).then((a=>{if(!a.length){const e=Error("Could not find targetable country for US!");throw Object(I.a)(e),e}if(t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();e(Oe(a)),e(Te(p.a.LOADED))})).catch((t=>{throw e(Te(p.a.FAILED)),t}))},z=()=>(e,t,{api:a})=>{if(R.includes(t().quickPromote.budget.availableBudgetsFetchStatus))return Promise.resolve();e(Se(p.a.LOADING));const r=he(t());return a.QuickPromote.getBudgets({countryCode:r}).then((({budgets:t,currencyCode:a})=>{e(Pe(t,a));const r=t[1];if(!r)throw new Error("No budget found");e(Le(r)),e(Se(p.a.LOADED))})).catch((t=>{throw e(Se(p.a.FAILED)),t}))},$={account:{adsAccount:null,accountDataFetchStatus:p.a.NONE,fundingInstruments:[],selectedFundingInstrument:null},targeting:{initialTargetedLocationsFetchStatus:p.a.NONE,targetedLocations:[],locationQuery:"",ageBucket:E.AGE_OVER_13,gender:b.Any},budget:{errorMessage:null,dailyBudget:100,durationDays:5,availableBudgets:null,availableBudgetsFetchStatus:p.a.NONE,currency:null},firstLoad:!1,promoteStatus:p.a.NONE,promoteErrorCode:null},Q="rweb/quickPromote/account/set",W="rweb/quickPromote/account/setAdsAccount",K="rweb/quickPromote/account/setFundingInstruments",J="rweb/quickPromote/account/setSelectedFundingInstrument",X="rweb/quickPromote/account/setAccountDataFetchStatus",Z="rweb/quickPromote/targeting/set",Y="rweb/quickPromote/targeting/setLocationQuery",ee="rweb/quickPromote/targeting/setInitialTargetedLocationsFetchStatus",te="rweb/quickPromote/targeting/setTargetedLocations",ae="rweb/quickPromote/targeting/setTargetedAgeBucket",re="rweb/quickPromote/targeting/setTargetedGender",ne="rweb/quickPromote/budget/set",oe="rweb/quickPromote/budget/setAvailableBudgetsFetchStatus",ce="rweb/quickPromote/budget/setAvailableBudgets",ie="rweb/quickPromote/budget/setDailyBudget",se="rweb/quickPromote/budget/setBudgetDuration",le="rweb/quickPromote/budget/setBudgetErrorMessage",de="rweb/quickPromote/setFirstLoad",ue="rweb/quickPromote/setPromoteFetchStatus",ge="rweb/quickPromote/setPromoteErrorCode",me=Object.freeze({REQUEST:"rweb/quickPromote/promoteRequest",SUCCESS:"rweb/quickPromote/promoteSuccess",FAILURE:"rweb/quickPromote/promoteFailure"}),he=e=>{var t,a;const r=(null==(t=e.quickPromote.account)||null==(a=t.adsAccount)?void 0:a.country_code)||Object(m.l)(e)||"US";return"XX"===r?"US":r.toUpperCase()},pe=e=>{const{targeting:{targetedLocations:[{targeting_value:t}],...a},budget:{dailyBudget:r,currency:n}}=e.quickPromote,o=Object(_.a)(a,["initialTargetedLocationsFetchStatus","locationQuery"]);return JSON.stringify({...o,location:t,dailyBudget:r,currency:n})},_e=e=>({type:Z,payload:{targeting:e}}),ye=e=>({type:ne,payload:{budget:e}}),be=e=>({type:W,payload:{adsAccount:e}}),Ee=e=>({type:K,payload:{fundingInstruments:e}}),fe=e=>({type:J,payload:{selectedFundingInstrument:e}}),Ae=e=>({type:X,payload:{fetchStatus:e}}),Te=e=>({type:ee,payload:{fetchStatus:e}}),Oe=e=>({type:te,payload:{targetedLocations:e}}),Ie=e=>({type:Y,payload:{locationQuery:e}}),ke=e=>({type:ae,payload:{ageBucket:e}}),we=e=>({type:re,payload:{gender:e}}),Se=e=>({type:oe,payload:{fetchStatus:e}}),Pe=(e,t)=>({type:ce,payload:{availableBudgets:e,currency:t}}),Le=e=>({type:ie,payload:{dailyBudget:e}}),Ce=e=>({type:se,payload:{durationDays:e}}),ve=e=>({type:le,payload:{errorMessage:e}}),Be=e=>({type:de,payload:{firstLoad:e}}),xe=e=>({type:ue,payload:{promoteFetchStatus:e}}),De=e=>({type:ge,payload:{promoteErrorCode:e}}),Fe=e=>(t,a,{api:r})=>Object(h.b)(t,{request:r.QuickPromote.createPromotion,params:e})({actionTypes:me,context:"FETCH_PROMOTE"});y.a.register({quickPromote:(e=$,t)=>{switch(t.type){case Q:{const{account:a}=t.payload;return{...e,account:{...e.account,...a}}}case Z:{const{targeting:a}=t.payload;return{...e,targeting:{...e.targeting,...a}}}case ne:{const{budget:a}=t.payload;return{...e,budget:{...e.budget,...a}}}case de:{const{firstLoad:a}=t.payload;return{...e,firstLoad:a}}case W:{const{adsAccount:a}=t.payload;return{...e,account:{...e.account,adsAccount:a}}}case K:{const{fundingInstruments:a}=t.payload;return{...e,account:{...e.account,fundingInstruments:a}}}case J:{const{selectedFundingInstrument:a}=t.payload;return{...e,account:{...e.account,selectedFundingInstrument:a}}}case X:{const{fetchStatus:a}=t.payload;return{...e,account:{...e.account,accountDataFetchStatus:a}}}case ee:{const{fetchStatus:a}=t.payload;return{...e,targeting:{...e.targeting,initialTargetedLocationsFetchStatus:a}}}case Y:{const{locationQuery:a}=t.payload;return{...e,targeting:{...e.targeting,locationQuery:a}}}case te:{const{targetedLocations:a}=t.payload;return{...e,targeting:{...e.targeting,targetedLocations:a}}}case ae:{const{ageBucket:a}=t.payload;return{...e,targeting:{...e.targeting,ageBucket:a}}}case re:{const{gender:a}=t.payload;return{...e,targeting:{...e.targeting,gender:a}}}case oe:{const{fetchStatus:a}=t.payload;return{...e,budget:{...e.budget,availableBudgetsFetchStatus:a}}}case ce:{const{availableBudgets:a,currency:r}=t.payload;return{...e,budget:{...e.budget,availableBudgets:a,currency:r}}}case ie:{const{dailyBudget:a}=t.payload;return{...e,budget:{...e.budget,dailyBudget:a}}}case se:{const{durationDays:a}=t.payload;return{...e,budget:{...e.budget,durationDays:a}}}case le:{const{errorMessage:a}=t.payload;return{...e,budget:{...e.budget,errorMessage:a}}}case ue:{const{promoteFetchStatus:a}=t.payload;return{...e,promoteStatus:a}}case ge:{const{promoteErrorCode:a}=t.payload;return{...e,promoteErrorCode:a}}case me.REQUEST:return{...e,promoteStatus:p.a.LOADING};case me.FAILURE:return{...e,promoteStatus:p.a.FAILED};case me.SUCCESS:return{...e,promoteStatus:p.a.LOADED};default:return t.type,e}}});const Re=e=>e.quickPromote.budget.dailyBudget,qe=e=>e.quickPromote.budget.durationDays,je=e=>e.quickPromote.budget.errorMessage,Ne=e=>e.quickPromote.budget.availableBudgets||(e=>{throw new Error(e)})("No budgets found"),Ge=e=>e.quickPromote.budget.currency||"USD",Me=(e,t)=>{var a,r;const n=pe(e);return null==(a=e.ads.typeahead.forecastAudience[n])||null==(r=a.result)?void 0:r.estimatedImpressions};var Ue=Object(u.a)().propsFromState((()=>({dailyBudget:Re,durationDays:qe,availableBudgets:Ne,lang:m.f,currency:Ge,audience:Me,errorMessage:je}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_BUDGET_SELECT_SCREEN"),setDailyBudget:Le,setBudgetDuration:Ce,fetchForecastedAudienceIfNeeded:q,setBudgetErrorMessage:ve}))).withAnalytics({page:"quick_promote"}),He=a("MWbm"),Ve=a("t62R"),ze=a("rHpw");const $e=({children:e,description:t,descriptionDir:a,descriptionTestID:r,label:n,withBottomBorder:c=!0})=>o.createElement(He.a,{style:[Qe.descriptionItem,c?Qe.bottomBorder:void 0]},!!n&&o.createElement(Ve.c,{weight:"bold"},n),!!t&&o.createElement(He.a,{style:Qe.descriptionContainer},o.createElement(Ve.c,{color:"gray600",dir:a,size:"small",style:Qe.descriptionContainer,testID:r},t)),e),Qe=ze.a.create((e=>({descriptionItem:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},descriptionContainer:{marginTop:e.spaces.space2},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}})));var We=a("iOFy"),Ke=a("Gpeq");const Je=({title:e,primaryLabel:t,subtitle:a})=>o.createElement(He.a,{style:[Xe.bottomBorder,Xe.titleContainer]},o.createElement(Ve.c,{align:"center",size:"large",weight:"heavy"},e),!!t&&o.createElement(He.a,{style:Xe.primaryLabelContainer},o.createElement(Ve.c,{align:"center",color:"primary",size:"xLarge"},t)),o.createElement(He.a,{style:Xe.subtitleContainer},o.createElement(We.a,{align:"center",color:"gray600"},a))),Xe=ze.a.create((e=>({titleContainer:{paddingVertical:e.spaces.space32},primaryLabelContainer:{marginTop:e.spaces.space12},subtitleContainer:{marginTop:e.spaces.space12},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}})));var Ze="introButton",Ye="nextButton",et="targetingScreen",tt="targetingLocationScreen",at="budgetSelectScreen",rt="reviewScreen",nt="reviewButton",ot="reviewTargetingDescription",ct="reviewBudgetAndDurationDescription",it="reviewPaymentPivot",st="targetingLocationPivot",lt="backButton",dt="targetingLocationSearch",ut="targetingLocationItem",gt=a("4zmP"),mt=a("9RkS"),ht=a("Xrkv");const pt=O.a.dc4a9413,_t=O.a.bad70c09,yt=O.a.c133a39b,bt=O.a.ee5da8f4,Et=O.a.g4bf9cb7,ft=O.a.gc3ce5d9,At=O.a.e542dfd6,Tt=O.a.cb51c854,Ot=O.a.bb7b39e1,It=O.a.eb9466d0,kt=O.a.c21037d0,wt=O.a.b07cc9f1,St=O.a.ce309bed,Pt=O.a.c6c16a51,Lt=O.a.cc49d03f;function Ct(e){switch(e){case"AnyGender":return Tt;case"Male":return Ot;case"Female":return It;default:return Object(I.a)(`Unknown gender: ${e}`),e}}function vt(e){switch(e){case"COUNTRIES":return kt;case"REGIONS":return wt;case"METROS":return St;case"CITIES":return Pt;case"POSTAL_CODES":return Lt;default:return Object(I.a)(`Unknown targeting locationType: ${e}`),e}}function Bt({totalBudgetNum:e,durationDays:t,lang:a,currency:r}){const n=e.toLocaleString(Object(Ke.a)(a),{currency:r,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0});return pt({totalBudget:n,durationLabel:Dt({durationDays:t})})}function xt({numLocations:e}){const t=O.a.ia24dc8c(e);return _t({numLocations:t})}function Dt({durationDays:e}){const t=O.a.ia24dc8c(e);return Et({durationDays:t})}const Ft=O.a.a3a09d48,Rt=O.a.e7eb3683,qt=O.a.d9f6e3cd,jt=O.a.d9d6e10e,Nt=O.a.b3954ec9,Gt=O.a.e1b48db4,Mt=Array(30).fill(null).map(((e,t)=>t+1));class Ut extends o.PureComponent{constructor(...e){super(...e),n()(this,"_fetchForecastedAudienceIfNeeded",(()=>{const{analytics:e,match:{params:{statusId:t}},fetchForecastedAudienceIfNeeded:a,createLocalApiErrorHandler:r}=this.props;a(t,e).catch(r())})),n()(this,"_getSliderProps",((e,t)=>({max:e.length-1,min:0,value:e.indexOf(t)}))),n()(this,"_handleDurationSlider",(e=>{const{setBudgetDuration:t,durationDays:a,analytics:r}=this.props,n=Mt[e];a!==n&&(Object(D.m)(r)(D.k.setBudgetDuration(`${n}`)),t(n),this._fetchForecastedAudienceIfNeeded())})),n()(this,"_handleBudgetSlider",(e=>{const{setDailyBudget:t,availableBudgets:a,dailyBudget:r,analytics:n}=this.props,o=a[e];r!==o&&(Object(D.m)(n)(D.k.setDailyBudget(`${o}`)),t(o),this._fetchForecastedAudienceIfNeeded())}))}componentDidMount(){const{analytics:e}=this.props;Object(D.m)(e)(D.k.budgetSelectPageLoad()),this._fetchForecastedAudienceIfNeeded()}componentWillUnmount(){const{setBudgetErrorMessage:e}=this.props;e(null)}render(){const{durationDays:e,lang:t,dailyBudget:a,availableBudgets:r,currency:n,audience:c,errorMessage:i}=this.props,s=a.toLocaleString(Object(Ke.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),l=r[0].toLocaleString(Object(Ke.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),u=r.slice(-1)[0].toLocaleString(Object(Ke.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),g=c?function({low:e,high:t}){const a=O.a.cf8abf58(e),r=O.a.cf8abf58(t);return ft({audienceLow:a,audienceHigh:r})}(c):"Â ",m=Dt({durationDays:e}),h=Dt({durationDays:Mt[0]}),p=Dt({durationDays:Mt.slice(-1)[0]}),_=this._getSliderProps(r,a),y=this._getSliderProps(Mt,e),b=Bt({totalBudgetNum:a*e,durationDays:e,lang:t,currency:n});return o.createElement(He.a,{style:Ht.qpContainer,testID:at},i&&o.createElement(He.a,{style:Ht.gutter},o.createElement(gt.a,{text:i,type:"danger"})),o.createElement(Je,{primaryLabel:b,subtitle:g,title:Ft}),o.createElement($e,{label:Rt},o.createElement(He.a,{style:Ht.childSpacing},o.createElement(mt.a,d()({accessibilityLabel:qt,accessibilityLabelValueText:`"${s}"`},_,{maxIcon:o.createElement(Ve.c,{style:Ht.iconText},u),minIcon:o.createElement(Ve.c,{style:Ht.iconText},l),onChange:this._handleBudgetSlider,thumbLabel:s})))),o.createElement($e,{label:jt},o.createElement(He.a,{style:Ht.childSpacing},o.createElement(mt.a,d()({accessibilityLabel:Nt,accessibilityLabelValueText:`"${m}"`},y,{maxIcon:o.createElement(Ve.c,{style:Ht.iconText},p),minIcon:o.createElement(Ve.c,{style:Ht.iconText},h),onChange:this._handleDurationSlider,thumbLabel:m})))),o.createElement(He.a,{style:Ht.disclaimer},o.createElement(We.a,{align:"center",color:"gray600",size:"small"},Gt)))}}n()(Ut,"contextType",s.a);const Ht=ze.a.create((e=>({qpContainer:{flex:1},disclaimer:{marginVertical:e.componentDimensions.gutterVertical,marginHorizontal:e.componentDimensions.gutterHorizontal},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},childSpacing:{marginTop:e.spaces.space4},iconText:{textAlignVertical:"text-bottom"}})));var Vt=Ue(Ut),zt=a("XOJV");const $t=(e,t)=>t.match.params.statusId,Qt=(e,t)=>zt.a.selectHydrated(e,$t(0,t)),Wt=(e,t)=>Object(p.c)(zt.a.selectFetchStatus(e,$t(0,t)),e.quickPromote.budget.availableBudgetsFetchStatus,e.quickPromote.targeting.initialTargetedLocationsFetchStatus,e.quickPromote.account.accountDataFetchStatus,e.quickPromote.firstLoad?p.a.LOADED:p.a.LOADING),Kt=(e,t)=>e.quickPromote.promoteStatus,Jt=(e,t)=>e.quickPromote.promoteErrorCode,Xt=e=>{const{match:t,history:a}=e,{screenName:r,statusId:n,quickPromotePlatform:o,quickPromoteScreenName:c}=t.params;return((e,t,a,r,n)=>(o,c,{userPersistence:i})=>i.get("rweb.quickPromoteRedirectBack").catch((()=>{})).then((i=>{if(i&&i.platformType&&i.lastPersisted&&(new Date).getTime()-i.lastPersisted<36e5){const{ageBucket:a,gender:r,targetedLocations:s,dailyBudget:l,durationDays:d,platformType:u,currency:g}=i,{currency:m}=c().quickPromote.budget;o(_e({ageBucket:a,gender:r,targetedLocations:s})),g===m?(o(ye({dailyBudget:l,durationDays:d})),n.replace(Object(D.g)(e,t,u,D.c.Review))):(o(ye({errorMessage:F})),n.replace(Object(D.g)(e,t,u,D.c.BudgetSelect)))}else r===D.c.Intro||c().quickPromote.firstLoad||n.replace(Object(D.g)(e,t,a,D.c.Intro));o(Be(!0))})))(r,n,o,c,a)};var Zt=Object(u.a)().propsFromState((()=>({statusId:$t,fetchStatus:Wt,tweet:Qt,promoteFetchStatus:Kt,promoteErrorCode:Jt}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_SCREEN"),fetchTweetIfNeeded:zt.a.fetchOneIfNeeded,fetchCurrentTargetingLocationIfNeeded:V,fetchAvailableBudgetsIfNeeded:z,fetchAdsAccountDataIfNeeded:G,handleFirstLoad:()=>Xt(e),setPromoteFetchStatus:xe}))).withAnalytics(D.l),Yt=Object(u.a)().propsFromState((()=>({}))).propsFromActions((()=>({}))).withAnalytics(D.l),ea=a("feu+");const ta=O.a.e1bca506,aa=O.a.e4a4c608,ra=O.a.a219e217;class na extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToAnalytics",(()=>{const{match:e,history:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=e.params;Object(D.i)(t)(a,r,n)})),n()(this,"_handleClose",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}))}componentDidMount(){const{analytics:e}=this.props;Object(D.m)(e)(D.k.donePageLoad())}render(){return o.createElement(ea.a,{actionLabel:ra,headline:ta,isFullHeightOnMobile:!0,onAction:this._handleGoToAnalytics,onClose:this._handleClose,subtext:aa,withCloseButton:!1})}}n()(na,"contextType",s.a);var oa=Yt(na),ca=a("v//M"),ia=a("W5XZ"),sa=a("jHSc");const la=e=>!!e.quickPromote.account.selectedFundingInstrument;var da=Object(u.a)().propsFromState((()=>({hasFundingInstrument:la}))).propsFromActions((()=>({}))).withAnalytics(D.l);const ua=O.a.dcfb0332,ga=O.a.db841200,ma=O.a.hc67be9d;class ha extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToNextPage",(()=>{const{history:e,match:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=t.params;e.push(Object(D.g)(a,r,n,D.c.Targeting))})),n()(this,"_handleClose",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}))}componentDidMount(){const{analytics:e,hasFundingInstrument:t}=this.props;Object(D.m)(e)(D.k.introPageLoad({hasFundingInstrument:t}))}render(){const{match:e}=this.props,{quickPromotePlatform:t}=e.params,a=t===D.a.Rweb;return o.createElement(ea.a,{actionLabel:ma,headline:ua,isFullHeightOnMobile:!0,onAction:this._handleGoToNextPage,onClose:this._handleClose,primaryButtonTestID:Ze,subtext:ga,withCloseButton:a})}}n()(ha,"contextType",s.a);var pa=da(ha),_a=a("tI3i"),ya=a.n(_a),ba=(a("VAZu"),a("zh9S"));const Ea=(e,t)=>t.match.params.statusId,fa=(e,t)=>zt.a.selectHydrated(e,Ea(0,t)),Aa=(e,t)=>zt.a.selectFetchStatus(e,Ea(0,t)),Ta=(e,t)=>e.quickPromote.account.adsAccount;var Oa=Object(u.a)().propsFromState((()=>({fetchStatus:Aa,tweet:fa,adsAccount:Ta}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_PAYMENT_SCREEN"),fetchTweetIfNeeded:zt.a.fetchOneIfNeeded,scribeAction:ba.c,savePlatformRedirectBackState:()=>N(e.match.params.quickPromotePlatform),fetchAdsAccountDataIfNeeded:G}))).withAnalytics(D.l),Ia=a("Rp9C"),ka=a("E0cF"),wa=a("bPFD");class Sa extends o.PureComponent{constructor(...e){super(...e),n()(this,"_setAppBarRef",(e=>{this._appBarRef=e})),n()(this,"_handleIFrameMessage",(e=>{const{analytics:t,tweet:a}=this.props;if(e&&"quick_promote"===e.name)if("scribe"===e.type){const r=a&&ka.a.getOriginalTweet(a)||void 0,n=r?[Ia.a.getTweetItem(r)]:[],o=e.scribeData||{},c="string"==typeof o.component?o.component:"quick_promote",i="string"==typeof o.uiEvent?o.uiEvent:"";t.scribe({component:c,action:i,data:{items:n}})}else if("navigation"===e.type){const{history:e,match:t,fetchAdsAccountDataIfNeeded:a,createLocalApiErrorHandler:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:c}=t.params;ya()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),a(this.context.loggedInUserId,!0).catch(r()),e.push(`/${n}/status/${o}/${c}/${D.c.Review}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()}))}componentDidMount(){const{savePlatformRedirectBackState:e,analytics:t,adsAccount:a,match:r}=this.props,{quickPromotePlatform:n,statusId:o}=r.params;e();const c=Object(D.f)(n,a,o);Object(D.m)(t)(D.k.paymentPageLoad(c.url)),c.isSameHost||(window.location.href=c.url)}render(){const{adsAccount:e,match:t}=this.props,{quickPromotePlatform:a,statusId:r}=t.params,n=Object(D.f)(a,e,r);return n.isSameHost?o.createElement(wa.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:I.a,src:n.url,style:Pa.iframe}):null}}n()(Sa,"contextType",s.a);const Pa=ze.a.create((e=>({iframe:{flexGrow:1}})));var La=Oa(Sa);const Ca=(e,t)=>e.quickPromote.targeting.targetedLocations,va=(e,t)=>e.quickPromote.targeting.ageBucket,Ba=(e,t)=>e.quickPromote.targeting.gender,xa=(e,t)=>e.quickPromote.budget.dailyBudget,Da=(e,t)=>e.quickPromote.budget.durationDays,Fa=e=>e.quickPromote.budget.currency||"USD",Ra=e=>e.quickPromote.account.selectedFundingInstrument,qa=e=>e.quickPromote.account.adsAccount,ja=e=>e.quickPromote.promoteStatus,Na=e=>e.quickPromote.promoteErrorCode,Ga=({history:e,match:t})=>a=>{const{screenName:r,statusId:n,quickPromotePlatform:o}=t.params;return((e,t,a,r,n)=>(o,c,{api:i})=>{var s;const l=j(c()),{session:{user_id:d},quickPromote:{targeting:{ageBucket:u,gender:g,targetedLocations:[{targeting_value:m}]},budget:{dailyBudget:h,durationDays:p},account:{selectedFundingInstrument:_}}}=c(),y=null==(s=c().quickPromote.account.adsAccount)?void 0:s.id;if(R.includes(c().quickPromote.promoteStatus))return Promise.resolve();if(!y||!d)return Object(D.m)(n)(D.k.promotionError("Unauthorized")),o(De("Unauthorized")),Promise.resolve();if(!_)return Object(D.m)(n)(D.k.promotionError("MissingFundingInstrument")),o(De("MissingFundingInstrument")),Promise.resolve();o(De(null));const b=_.id,E=Math.round(1e6*h),f=E*p;return Object(D.m)(n)(D.k.promotionCall({dailyBudgetMicros:E,totalBudgetMicros:f,ageBucket:u,gender:g,location:m})),o(Fe({userId:d,accountId:`${parseInt(y,36)}`,fundingInstrumentId:`${parseInt(b,36)}`,tweetId:a,budget:{daily_local_micros:`${E}`,total_local_micros:`${f}`},targeting:l})).catch((()=>(o(De("NetworkError")),Object(D.m)(n)(D.k.promotionError("NetworkError")),{type:"fail"}))).then((c=>{var i,s,l;if("fail"!==c.type){var u;if("QuickPromoteError"===(null==(i=c.quick_promote_campaign)?void 0:i.__typename))return o(De(c.quick_promote_campaign.error_code)),Object(D.m)(n)(D.k.promotionError((null==(u=c.quick_promote_campaign)?void 0:u.error_code)||"QuickPromoteError")),o(G(d,!0));if("PromotionIneligible"===(null==(s=c.quick_promote_campaign)?void 0:s.response_code))Object(D.m)(n)(D.k.promotionError("PromotionIneligible")),o(De("PromotionIneligible"));else if(null!=(l=c.quick_promote_campaign)&&l.response_code)return void e.push(Object(D.g)(t,a,r,D.c.Done))}}))})(e,r,n,o,a)};var Ma=Object(u.a)().propsFromState((()=>({targetedLocations:Ca,ageBucket:va,gender:Ba,dailyBudget:xa,durationDays:Da,lang:m.f,country:he,currency:Fa,fundingInstrument:Ra,adsAccount:qa,promoteStatus:ja,promoteErrorCode:Na}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_REVIEW_SCREEN"),clearPersistedRedirectBackState:()=>N(),createPromotion:Ga(e)}))).withAnalytics(D.l),Ua=a("csss"),Ha=a("/yvb"),Va=a("shC7");const za=O.a.c3c57e3e,$a=O.a.h06724b4,Qa=O.a.b069d89c,Wa=O.a.a3a09d48,Ka=O.a.e36bce63,Ja=O.a.i41612d9,Xa=O.a.ed8bb5af,Za=O.a.be2dc078,Ya=O.a.da2805d1,er=O.a.ef4602eb,tr=O.a.a4db098b,ar=O.a.ef7e3916;class rr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getPaymentDescription",(()=>{const{adsAccount:e}=this.props;return e&&e.timezone&&e.country_code?Xa:Za})),n()(this,"_handlePromote",(()=>{const{createPromotion:e,analytics:t}=this.props;Object(D.m)(t)(D.k.promotionClick()),e(t)})),n()(this,"_getErrorMessage",(()=>{const{promoteErrorCode:e,promoteStatus:t}=this.props;if(!e)return t===p.a.LOADED?Ya:null;switch(e){case"MissingFundingInstrument":case"InvalidPaymentMethod":return ar;case"CampaignCreationFailed":case"PromotionIneligible":return tr;default:return er}}))}componentDidMount(){const{analytics:e,clearPersistedRedirectBackState:t,fundingInstrument:a}=this.props;t();const r=!!a;Object(D.m)(e)(D.k.reviewPageLoad({hasFundingInstrument:r}))}render(){const{targetedLocations:e,ageBucket:t,gender:a,dailyBudget:r,durationDays:n,lang:c,country:i,currency:s,fundingInstrument:l,match:d,promoteStatus:u}=this.props,g=function({minAge:e,maxAge:t}){return t?yt({minAge:e,maxAge:t}):bt({minAge:e})}(f[t]),m=function({locations:e,formattedAge:t,gender:a}){const r=e.length;return At({locations:Object(ht.a)(e),locationsHeading:xt({numLocations:r}),formattedAge:t,gender:a})}({locations:e.map((({localized_name:e})=>e)),formattedAge:g,gender:Ct(a)}),h=Bt({totalBudgetNum:r*n,durationDays:n,lang:c,currency:s}),{screenName:p,statusId:_,quickPromotePlatform:y}=d.params,b=this._getErrorMessage();return o.createElement(o.Fragment,null,o.createElement(He.a,{style:nr.qpContainer,testID:rt},b&&o.createElement(He.a,{style:nr.gutter},o.createElement(gt.a,{text:b,type:"danger"})),o.createElement(Je,{subtitle:$a,title:za}),o.createElement($e,{description:m,descriptionTestID:ot,label:Qa}),o.createElement($e,{description:h,descriptionDir:Va.a.isRTL?"rtl":"ltr",descriptionTestID:ct,label:Wa}),o.createElement(Ua.a,{description:l?l.description:o.createElement(Ve.c,{color:"primary",size:"small"},this._getPaymentDescription()),label:o.createElement(Ve.c,{weight:"bold"},Ka),link:l?void 0:Object(D.g)(p,_,y,D.c.Payment),testID:it})),o.createElement(He.a,{style:nr.bottomElements},o.createElement(Ha.a,{disabled:!l||R.includes(u),onPress:this._handlePromote,size:"normalLarge",testID:nt,type:"primary"},Ja),o.createElement(We.a,{style:nr.terms},(E=i,o.createElement(O.a.I18NFormatMessage,{$i18n:"c99d7100"},o.createElement(Ve.c,{link:Object(D.h)(E)},O.a.d56b5ac3))))));var E}}n()(rr,"contextType",s.a);const nr=ze.a.create((e=>({qpContainer:{flex:1},bottomElements:{marginHorizontal:e.spaces.space12,marginVertical:e.spaces.space32},terms:{marginTop:e.spaces.space12,textAlign:"center",color:e.colors.gray600,fontSize:e.fontSizes.xSmall},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}})));var or=Ma(rr),cr=a("zCf4");const ir=(e,t)=>{const a=lr(e,t);return e.ads.typeahead.targetingLocation[a]},sr=(e,t)=>{var a;const r=lr(e,t);return null==(a=e.ads.typeahead.targetingLocation[r])?void 0:a.fetchStatus},lr=(e,t)=>e.quickPromote.targeting.locationQuery,dr=(e,t)=>e.quickPromote.targeting.targetedLocations;var ur=Object(u.a)().propsFromState((()=>({targetingLocationQuery:lr,targetingLocations:ir,targetedLocations:dr,fetchStatus:sr,userCountry:m.l}))).propsFromActions((()=>({setTargetedLocations:Oe,setAndFetchTargetingLocationQuery:H,setTargetingLocationQuery:Ie,createLocalApiErrorHandler:Object(g.d)("QUICK_PROMOTE_TARGETING_LOCATION_SCREEN")}))).withAnalytics(D.l),gr=a("VwDm"),mr=a("G1WX"),hr=a("cCdp"),pr=a("xKuM"),_r=a("6OUF"),yr=a("zrOZ"),br=a("kevv");const Er=O.a.cc642518,fr=O.a.i0e8c3c6,Ar=O.a.deaf5b15,Tr=O.a.f69ad048,Or=Object.freeze({COUNTRIES:0,REGIONS:1,METROS:2,CITIES:3,POSTAL_CODES:4}),Ir=Object.freeze({[D.d.CurrentCountryMatch]:0,[D.d.Match]:1,[D.d.NoMatch]:2});class kr extends o.PureComponent{constructor(...e){super(...e),n()(this,"state",{errorMessage:null}),n()(this,"_renderSearch",(()=>{const{fetchStatus:e,targetingLocationQuery:t}=this.props;return o.createElement(wr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement(He.a,null,o.createElement(Ve.c,{style:Sr.headingText,weight:"heavy"},fr)),o.createElement(mr.a,{fetchStatus:e,render:this._renderSearchList,retryMessage:Ar}))})),n()(this,"_handleClear",(()=>{const{setTargetingLocationQuery:e}=this.props;e("")})),n()(this,"_renderSearchList",(()=>{const{targetedLocations:e}=this.props,t=Object(yr.a)(e.map((({targeting_value:e})=>e))),a=this._getTargetingLocationOptions();return o.createElement(He.a,{style:Sr.overflow},a.map((({location_type:e,targeting_value:a,localized_name:r})=>o.createElement(hr.a,{checked:t.has(a),helpText:vt(e),key:a,label:r,name:a,onChange:this._handleSearchSelect,testID:ut}))))})),n()(this,"_getTargetingLocationOptions",(()=>{var e,t,a;const{targetingLocations:r,userCountry:n,targetingLocationQuery:o}=this.props,c=null!=(e=null==r||null==(t=r.result)||null==(a=t[0])?void 0:a.locations)?e:[],i=Object(D.e)(n||"US"),s=c.filter((({country_code:e,localized_name:t})=>i(t,e,o)!==D.d.NoMatch));return Object(br.a)(s,[({country_code:e,localized_name:t})=>{const a=i(t,e,o);return Ir[a]},({location_type:e,localized_name:t})=>{var a;return null!=(a=Or[e])?a:(e=>{Object(I.a)(`Quick Promote: Unknown location type: ${e}. Expected one of {${Object.keys(Or).join(", ")}}`)})(e)||Object.keys(Or).length},({localized_name:e})=>e],"asc")})),n()(this,"_handleSearchSelect",((e,t)=>{const{setTargetedLocations:a,analytics:r,setTargetingLocationQuery:n}=this.props;if(t){this.setState({errorMessage:null});const t=this._getTargetingLocationOptions().find((({targeting_value:t})=>t===e));t?(Object(D.m)(r)(D.k.setTargetingLocation({id:t.targeting_value,locationType:t.location_type,countryCode:t.country_code})),a([t]),this._handleGoBack()):Object(I.a)(`Quick Promote: could not find "${e}" in list of targeting options`)}else Object(D.m)(r)(D.k.targetingLocationError()),this.setState({errorMessage:Tr});n("")})),n()(this,"_renderSelected",(()=>{const{targetedLocations:e,targetingLocationQuery:t}=this.props,{errorMessage:a}=this.state;return o.createElement(wr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement(He.a,null,a&&o.createElement(He.a,{style:Sr.gutter},o.createElement(gt.a,{text:a,type:"danger"})),o.createElement(Ve.c,{style:Sr.headingText,weight:"heavy"},xt({numLocations:e.length}))),o.createElement(He.a,null,e.map((({localized_name:e,targeting_value:t,location_type:a})=>o.createElement(hr.a,{checked:!0,helpText:vt(a),key:t,label:e,name:t,onChange:this._handleSearchSelect,testID:ut})))))})),n()(this,"_handleGoBack",(()=>{const{history:e,location:t,match:a}=this.props,{quickPromotePlatform:r,quickPromoteScreenName:n,screenName:o,statusId:c}=a.params;Object(D.j)(e,t)(o,c,r,n)})),n()(this,"_handleTargetingLocationChange",(e=>{const t=e.target.value,{createLocalApiErrorHandler:a,setAndFetchTargetingLocationQuery:r,analytics:n}=this.props;Object(D.m)(n)(D.k.targetingLocationSearch(t)),r(t).catch(a())}))}componentDidMount(){const{analytics:e}=this.props;Object(D.m)(e)(D.k.targetingLocationPageLoad())}componentWillUnmount(){this._handleClear()}render(){const{targetingLocationQuery:e}=this.props;return e?this._renderSearch():this._renderSelected()}}n()(kr,"contextType",s.a);const wr=({onBack:e,onChange:t,onClear:a,targetingLocationQuery:r,children:n})=>o.createElement(He.a,{style:Sr.qpContainer,testID:tt},o.createElement(pr.a,{leftControl:o.createElement(i.a,{onClick:e}),middleControl:o.createElement(_r.a,{Icon:gr.a,autoFocus:!0,name:"locationTargetingInput",onChange:t,onClear:a,placeholder:Er,style:Sr.input,testID:dt,value:r,withClearButton:!0})}),n),Sr=ze.a.create((e=>({qpContainer:{flex:1},input:{marginVertical:e.spaces.space12},headingText:{fontSize:e.fontSizes.large,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor,borderTopWidth:1,borderTopStyle:"solid",borderTopColor:e.colors.borderColor},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},overflow:{flex:"1 1 200px",overflowY:"auto"}})));var Pr=ur(kr);const Lr=(e,t)=>e.quickPromote.targeting.targetedLocations,Cr=(e,t)=>e.quickPromote.targeting.gender,vr=(e,t)=>e.quickPromote.targeting.ageBucket;var Br=Object(u.a)().propsFromState((()=>({targetedLocations:Lr,selectedGender:Cr,selectedAgeBucket:vr}))).propsFromActions((()=>({setTargetedAgeBucket:ke,setTargetedGender:we}))).withAnalytics(D.l),xr=a("JiIh"),Dr=a("V2ml"),Fr=a("J4ZH"),Rr=a("mN6z");const qr=O.a.hba1d105,jr=O.a.cba0133d,Nr=O.a.e1efbead,Gr=O.a.c6ff7c1f,Mr=O.a.b555fb45,Ur=O.a.a8d0108d,Hr=[b.Any,b.Female,b.Male].map((e=>({label:Ct(e),value:e}))),Vr=O.a.j2c03e12,zr=["13","18","21","25","35","50"],$r=[void 0,void 0,void 0,"24","34","49","54"],Qr=Object(Fr.a)((Wr=f,Object.values(Wr)),(e=>e.maxAge||"over"));var Wr;const Kr=$r.length;function Jr(e,t){var a;if(e&&t)return null==(a=A[e])?void 0:a[t]}class Xr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGenderChange",((e,t)=>{const{setTargetedGender:a,analytics:r}=this.props;a(t),Object(D.m)(r)(D.k.setTargetingGender(t))})),n()(this,"_handleAgeBucketChange",(([e,t],a)=>{const{selectedAgeBucket:r,setTargetedAgeBucket:n,analytics:o}=this.props,c=this._sliderValueFromSelectedAgeBucket(r);if(!Object(Rr.a)(c,[e,t]))if(a){const a=zr[e];if(!a)return;const r=Jr(a,t===Kr?"over":$r[t]);if(r)Object(D.m)(o)(D.k.setTargetingAgeBucket(r)),n(r);else{const e=Object.keys(A[a])[0];this._setAgeBucket({minAge:a,maxAge:e})}}else{const a=t===Kr?"over":$r[t];if(!a)return;const r=Jr(zr[e],a);if(r)Object(D.m)(o)(D.k.setTargetingAgeBucket(r)),n(r);else{const{minAge:e}=Qr[a].slice(-1)[0];this._setAgeBucket({minAge:e,maxAge:a})}}})),n()(this,"_setAgeBucket",(({minAge:e,maxAge:t})=>{const{setTargetedAgeBucket:a,analytics:r}=this.props,n=A[e][t||"over"];if(!n)throw new Error(`Age bucket not found for minAge: "${e}", maxAge: "${t||"<empty>"}"`);Object(D.m)(r)(D.k.setTargetingAgeBucket(n)),a(n)}))}componentDidMount(){const{analytics:e}=this.props;Object(D.m)(e)(D.k.targetingPageLoad())}_sliderValueFromSelectedAgeBucket(e){const{minAge:t,maxAge:a}=f[e];return[zr.indexOf(t),a?$r.indexOf(a):Kr]}render(){const{match:e,targetedLocations:t,selectedGender:a,selectedAgeBucket:r}=this.props,{screenName:n,statusId:c,quickPromotePlatform:i}=e.params,s=xt({numLocations:t.length}),{minAge:l,maxAge:d}=f[r],{minAge:u}=f[E.AGE_OVER_13],g=this._sliderValueFromSelectedAgeBucket(r),m=d||Vr;return o.createElement(He.a,{style:Zr.qpContainer,testID:et},o.createElement(Je,{subtitle:jr,title:qr}),o.createElement(Ua.a,{description:Object(ht.a)(t.map((({localized_name:e})=>e))),label:o.createElement(Ve.c,{weight:"bold"},s),link:Object(D.g)(n,c,i,D.c.TargetingLocation),testID:st}),o.createElement($e,{label:Nr},o.createElement(He.a,{style:Zr.childSpacing},o.createElement(xr.a,{endThumbAccessibilityLabel:Mr,endThumbAccessibilityLabelValueText:`"${m}"`,endThumbLabel:m,max:Kr,maxIcon:o.createElement(Ve.c,{style:Zr.iconText},Vr),min:0,minIcon:o.createElement(Ve.c,{style:Zr.iconText},u),onChange:this._handleAgeBucketChange,startThumbAccessibilityLabel:Gr,startThumbAccessibilityLabelValueText:`"${l}"`,startThumbLabel:l,value:g}))),o.createElement($e,{label:Ur,withBottomBorder:!1},o.createElement(He.a,{style:Zr.childSpacing},o.createElement(Dr.a,{name:"gender",onChange:this._handleGenderChange,options:Hr,value:a}))))}}n()(Xr,"contextType",s.a);const Zr=ze.a.create((e=>({qpContainer:{flex:1},childSpacing:{marginTop:e.spaces.space4},iconText:{textAlignVertical:"text-bottom"}})));var Yr=Br(Xr),en=a("q9Zt"),tn=a("JYMr");const an=O.a.a065172e,rn=O.a.cfcdb4a1,nn=O.a.dcfb0332,on=O.a.c1df579e;class cn extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getRetweetOrTweet",(()=>{const{tweet:e}=this.props;return e?ka.a.getOriginalTweet(e):e})),n()(this,"_handleFetchTweet",(()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;return t(a).catch(e(ia.a))})),n()(this,"_handleFetchCurrentTargetingLocation",(()=>{const{createLocalApiErrorHandler:e,fetchCurrentTargetingLocationIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_handleFetchBudgetOptions",(()=>{const{createLocalApiErrorHandler:e,fetchAvailableBudgetsIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_handleFetchAdsAccountData",(()=>{const{createLocalApiErrorHandler:e,fetchAdsAccountDataIfNeeded:t}=this.props;return ya()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),t(this.context.loggedInUserId).catch(e())})),n()(this,"_render",(()=>{const{history:e}=this.props,t=this._getRetweetOrTweet();return!t||t&&t.user.id_str!==this.context.loggedInUserId?o.createElement(sa.b,{history:e,onBackClick:this._handleGoBack,title:nn},o.createElement(en.a,{onRetry:null,title:an})):this._renderPage()})),n()(this,"_renderHeader",(()=>null)),n()(this,"_renderPage",(()=>{const{match:e,promoteFetchStatus:t,promoteErrorCode:a}=this.props,{quickPromoteScreenName:r,screenName:n,statusId:o,quickPromotePlatform:i}=e.params,s=e=>Object(D.g)(n,o,i,e);switch(r){case"intro":return this._renderSplashPage();case"targeting":{const e=s(D.c.BudgetSelect);return this._renderProgressPage(D.b.Targeting,e)}case"budget_select":{const e=s(D.c.Review);return this._renderProgressPage(D.b.BudgetSelect,e)}case"review":{const e=[p.a.LOADING,p.a.LOADED].includes(t)&&!a;return this._renderProgressPage(e?D.b.Finish:D.b.Review)}case"payment":return this._renderProgressPage(D.b.Review);case"targeting_location":return this._renderPopupPage();case"done":return this._renderSplashPage();default:throw c()}})),n()(this,"_renderProgressPage",((e,t)=>{const{history:a}=this.props;return o.createElement(sa.b,{documentTitle:nn,history:a,renderHeader:this._renderHeader},o.createElement(pr.a,{leftControl:o.createElement(i.a,{onClick:this._handleGoBack,testID:lt}),rightControl:t&&o.createElement(Ha.a,{link:t,pullRight:!0,testID:Ye,type:"text"},on)}),o.createElement(tn.a,{progress:e,style:sn.progressBar}),o.createElement(He.a,{style:sn.noScrollView},this._renderRoutes()))})),n()(this,"_renderPopupPage",(()=>{const{history:e}=this.props;return o.createElement(sa.b,{documentTitle:nn,history:e,renderHeader:this._renderHeader},this._renderRoutes())})),n()(this,"_renderSplashPage",(()=>this._renderRoutes())),n()(this,"_renderRoutes",(()=>{const{match:e}=this.props,{quickPromoteScreenName:t}=e.params;switch(t){case"intro":return o.createElement(cr.b,{component:pa});case"targeting":return o.createElement(cr.b,{component:Yr});case"targeting_location":return o.createElement(cr.b,{component:Pr});case"budget_select":return o.createElement(cr.b,{component:Vt});case"review":return o.createElement(cr.b,{component:or});case"payment":return o.createElement(cr.b,{component:La});case"done":return o.createElement(cr.b,{component:oa});default:throw c()}})),n()(this,"_handleGoBack",(()=>{const{history:e,match:t,location:a,analytics:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:c,quickPromoteScreenName:i}=t.params;Object(D.m)(r)(D.k.back(i)),Object(D.j)(e,a)(n,o,c,i)})),n()(this,"_handleRequestRetry",(()=>{const{analytics:e,match:t}=this.props,{quickPromoteScreenName:a}=t.params;Object(D.m)(e)(D.k.reload(a)),window.location.reload()}))}componentDidMount(){const{analytics:e,promoteFetchStatus:t,setPromoteFetchStatus:a,match:r}=this.props,{quickPromoteScreenName:n}=r.params;return p.a.LOADED===t&&n!==D.c.Done&&a(p.a.NONE),Promise.all([this._handleFetchTweet(),this._handleFetchCurrentTargetingLocation(),this._handleFetchAdsAccountData()]).then((()=>this._handleFetchBudgetOptions())).then((()=>{const{handleFirstLoad:e}=this.props;return e()})).catch((t=>{throw Object(D.m)(e)(D.k.pageLoadFail(t.message)),t}))}render(){const{fetchStatus:e,history:t}=this.props;return e!==p.a.LOADED?o.createElement(sa.b,{documentTitle:nn,history:t,renderHeader:this._renderHeader},o.createElement(ca.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:rn})):o.createElement(ca.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:rn})}}n()(cn,"contextType",s.a);const sn=ze.a.create((e=>({progressBar:{backgroundColor:e.colors.gray50},noScrollView:{overflowX:"hidden",flex:1}}))),ln=Zt(cn);t.default=ln},kevv:function(e,t,a){"use strict";var r=a("BcsE"),n=a("aTAq");const o=(e,t)=>{if(Object(r.a)(e)&&Object(r.a)(t)){if(e>t)return 1;if(e<t)return-1}else if(Object(n.a)(e)&&Object(n.a)(t)){if(e>t)return 1;if(e<t)return-1}return 0};t.a=(e,t,a)=>{const c=Object(n.a)(a)?Array(t.length).fill(a):a,i=t.map((e=>Object(n.a)(e)?t=>{const a="object"==typeof t?null==t?void 0:t[e]:void 0;return Object(n.a)(a)||Object(r.a)(a)?a:void 0}:e));return e.concat().sort(((e,t)=>(a,r)=>{for(let n=0;n<e.length;n++){const c=e[n],i=t[n]||"asc",s=o(c(a),c(r));if(0!==s)return"desc"===i?-1*s:s}return 0})(i,c))}},z4TA:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationScreen",(function(){return ke}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("MvUL"),a("aeN7")),c=a("ERkP"),i=a("s4rk"),s=a("pxuL"),l=a("zI2C"),d=a("6ZtA"),u=a("es0u"),g=a("zh9S"),m=a("6/RC"),h=a("oEGd"),p=a("0KEI"),_=a("hqKg"),y=a("8Lfv"),b=a("QK5w"),E=a("RqPI"),f=a("pNZL"),A=a("XOJV"),T=a("Mx3A");const O=(e,t)=>e.location&&e.location.state&&e.location.state[t],I=(e,t)=>{const a=O(t,"focal");return a||k(e,t)},k=(e,t)=>{const{location:a,match:r}=t;return r.params&&r.params.statusId?r.params.statusId:a.query&&a.query.tweet_id&&"string"==typeof a.query.tweet_id?a.query.tweet_id:""},w=Object(_.createSelector)(b.a,((e,t)=>O(t,"contextTweetId")),((e,t)=>A.a.selectFetchStatus(e,I(e,t))),((e,t)=>"PUSH"===t.history.action),((e,t)=>{if(!m.canUseDOM)return!1;const{location:a}=t,r=a.query,n=Object(b.a)(e,t);return Object(T.c)({query:r,httpReferer:n?"":document.referrer||"",requestUrl:window.location.href,emptyIfServerRendered:!1}).referral_type===T.a.Web}),((e,t)=>{const a=O(t,"referrer"),r=I(e,t);return!!a&&a.includes(`/i/topics/tweet/${r}`)}),((e,t)=>O(t,"promotedContent")),((e,t)=>t.location.query&&"string"==typeof t.location.query.cxt?t.location.query.cxt:void 0),((e,t)=>{const a=I(e,t),r=A.a.selectHydrated(e,a);return r&&r.conversation_id_str?A.a.selectHydrated(e,r.conversation_id_str):null}),((e,t)=>A.a.selectHydrated(e,I(e,t))),((e,t)=>t.match.params.screenName),((e,t)=>O(t,"socialContext")),I,k,((e,t)=>O(t,"contextualClientEventInfo")),f.a,((e,t)=>O(t,"overflow")),E.f,((e,t,a,r,n,o,c,i,s,l,d,u,g,m,h,p,_,y)=>({contextTweetId:t,initialFetchStatus:a,isForwardNavigation:r,isInitialScreen:!e,isReferralSource:n,isReferredFromExploreTopics:o,promotedContent:c,richLandingContextId:i,rootTweet:s,focalTweet:l,screenName:d,selectedTweetId:m,socialContext:u,statusId:g,contextualClientEventInfo:h,tweetDetailNav:p,overflowCount:_,userLanguage:y}))),S={createLocalApiErrorHandler:Object(p.d)("CONVERSATION_SCREEN"),googleAnalyticsPageView:g.a,scribePageImpression:g.d,clearTimelineCache:(e,t)=>Object(y.a)(e,t)};var P=Object(h.g)(w,S),L=a("ymux"),C=a("rkhm"),v=a("SrtL"),B=a("8UdT"),x=a("dwig"),D=a("kGix"),F=a("JyI6"),R=a("3XMw"),q=a.n(R),j=a("dFWS");const N=q.a.d2c7a41c,G=q.a.e20404df,M=q.a.d17df547;var U=({getLocationState:e,history:t})=>c.createElement(F.a,{accessibilityLabel:N,getLocationState:e,history:t,icon:c.createElement(j.a,null),label:M,scribeComponent:"floating_reply_button",shortLabel:G}),H=a("muX9"),V=a("zb92");var z=Object(V.a)({loader:()=>Promise.all([a.e(0),a.e(154)]).then(a.bind(null,"uo3S")),renderPlaceholder:(e,t)=>null}),$=a("rJoH"),Q=a("yoO3"),W=a("5FtR"),K=a("AUxQ"),J=a("QIgh"),X=a("I7xG"),Z=a("BV3T"),Y=a("VTxf"),ee=a("SrIh"),te=a("fTQJ"),ae=a("ZNT5");var re=e=>{const{richLandingContextId:t,statusId:a}=e;return((e,t)=>Object(ae.a)({timelineId:`rich-tweet-landing-${e}`,getEndpoint:e=>e.URT.fetchRichTweetLandingTimeline,getEndpointParams:e=>({...e,...t}),context:"FETCH_RICH_TWEET_LANDING",perfKey:"rich-tweet-landing"}))(t?`${a}-${t}`:a,{refsrc_tweet:a,rux_cxt:t})},ne=a("wgnn");const oe=e=>{switch(e){case ne.a.NOT_FOUND:return c.createElement(Y.a,null);case ne.a.NOT_ALLOWED:return c.createElement(Z.a,null);default:return Object(ee.a)(`Unhandled timeline unavailable reason: ${e}`),null}},ce=()=>c.createElement(Y.a,null);class ie extends c.Component{constructor(...e){super(...e),n()(this,"_getModule",Object(X.a)(this,(e=>e.statusId),(e=>e.richLandingContextId),((e,t)=>re({statusId:e,richLandingContextId:t}))))}render(){const{title:e}=this.props;return c.createElement(te.a,{entryConfiguration:J.b,module:this._getModule(),renderEmptyState:ce,renderUnavailable:oe,title:e})}}var se=a("Rp9C"),le=a("7JQg");const de=Object.freeze({Email:"email"});var ue=a("VS6U");a("E4zi");var ge=a("G8HL"),me=a("oQhu"),he=a("mN6z");const pe=q.a.bea869b3,_e=q.a.c299a6cf,ye=q.a.ad666301,be=q.a.f0c37ddb,Ee={page:"tweet"},fe={page:"tweet",section:"landing"},Ae=Object(me.a)(((e,t)=>({items:[se.a.forTweet(e,t)],tweet_id:e}))),Te=Object(me.a)((e=>Object(C.a)(e))),Oe=Object(me.a)(((e,t,a)=>{var r,n;return{referrer:e,controller_data:e&&(null==t||null==(r=t.details)||null==(n=r.timelinesDetails)?void 0:n.controllerData),overflowCount:a}})),Ie=Object(me.a)(((e,t)=>Object(L.a)({focalTweetId:e,fetchOptions:t})));class ke extends c.Component{constructor(e,t){super(e,t),n()(this,"_getFabState",(()=>{const{promotedContent:e,statusId:t}=this.props;return{inReplyToStatusId:t,promotedContent:e}})),n()(this,"_shouldRedirectToOcfLiteLogin",(()=>{const{location:e}=this.props,{loggedInUserId:t}=this.context;return(({isUserLoggedIn:e,location:t})=>(e=>{const{query:t}=e;return"refsrc"in t&&"string"==typeof t.refsrc?t.refsrc:""})(t)===de.Email&&!e)({isUserLoggedIn:!!t,location:e})&&this._isOcfLiteLoginEnabled})),n()(this,"_isBucketedInRichTweetLandingExperiment",(()=>{const{isReferralSource:e,isReferredFromExploreTopics:t,richLandingContextId:a}=this.props;return!(a||!e||t)&&this.context.featureSwitches.isTrue("responsive_web_rich_tweet_landing_enabled")})),n()(this,"_getNavigationParams",(()=>{const{tweetDetailNav:e,contextualClientEventInfo:t,overflowCount:a}=this.props;return Oe(e,t,a)})),n()(this,"_getModule",(()=>{const{statusId:e}=this.props,t=this._getNavigationParams();return Ie(e,t)})),n()(this,"_handleEntriesUpdate",(({entries:e,fetchStatus:t})=>{const{recordTTFL:a}=this.props;if(t===D.a.FAILED&&(this._shouldRecordTTFL=!1),this._shouldRecordTTFL&&e.length){const t=e.some((({type:e})=>e===B.b.Tweet));this._shouldRecordTTFL=!1,t&&a&&a("permalink")}})),n()(this,"_shouldRedirectToCanonical",(()=>{const{focalTweet:e,screenName:t,selectedTweetId:a,statusId:r}=this.props;return a===r&&(t&&e&&t.toLowerCase()!==e.user.screen_name.toLowerCase())})),n()(this,"_redirectToCanonical",(()=>{const{history:e,location:t}=this.props;e.replace({pathname:this._getCanonicalPath(),query:t.query,state:t.state})})),n()(this,"_getCanonicalPath",(()=>{const{focalTweet:e}=this.props;return e?`/${e.user.screen_name}/status/${e.id_str}`:"/"})),n()(this,"_getPathForTweetId",((e,t)=>`/${t||"i"}/status/${e}`)),n()(this,"_getScribeNamespace",(()=>this._shouldRenderRichTweetLandingTimeline()?fe:Ee)),this._shouldRecordTTFL=e.isInitialScreen,this._isInlineReplyEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_enabled"),this._isInlineReplyWithFabEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_with_fab_enabled"),this._isOcfLiteLoginEnabled=this.context.featureSwitches.isTrue("responsive_web_ocf_lite_login_flow_enabled")}shouldComponentUpdate(e){return!Object(he.a)(e,this.props)}componentDidMount(){const{history:e,location:t,isForwardNavigation:a}=this.props;if(this._shouldRenderRichTweetLandingTimeline()&&(!t.state||!t.state.isRichTweetLanding)){const a={...t,state:{...t.state,isRichTweetLanding:!0}};e.replace(a)}a&&this._clearTimelineCache()}componentWillUnmount(){this.context.setBackgroundClickHandler(null)}componentDidUpdate(e){this._shouldRedirectToCanonical()?this._redirectToCanonical():this.props.statusId!==e.statusId&&this.props.isForwardNavigation&&this._clearTimelineCache()}render(){const{loggedInUserId:e}=this.context,{focalTweet:t,history:a,promotedContent:r,statusId:n,userLanguage:o}=this.props,s=t?be({tweetText:t.text,fullName:t.user.name}):void 0,u=t&&`twitter://status?id=${t.id_str}`,g=t&&`https://twitter.com${this._getCanonicalPath()||""}`,m=t&&ye({fullName:t.user.name});return this._shouldRedirectToOcfLiteLogin()?c.createElement(W.a,{to:"/i/flow/lite_login"}):c.createElement(le.b,{data:Ae(n,r),namespace:this._getScribeNamespace()},c.createElement(Q.a,null,g?c.createElement(H.a,null,c.createElement("link",{href:g,rel:"canonical"}),c.createElement("link",{href:`https://publish.twitter.com/oembed?url=${g}`,rel:"alternate",title:s,type:"application/json+oembed"})):null,null,c.createElement($.a,{canonical:g,description:null==t?void 0:t.full_text,image:null==t?void 0:t.user.profile_image_url_https,title:m,type:"article"}),c.createElement(d.a,{featureSwitches:this.context.featureSwitches,loggedInUserId:e,userLanguage:o}),c.createElement(l.a,{deepLink:u}),g?c.createElement(i.a,{canonical:g}):null,c.createElement(ue.a,{backLocation:"/",documentTitle:s,history:a,primaryContent:this._renderTimeline(),sidebarContent:this._renderSidebarContent(),title:t&&t.self_thread?_e:pe}),c.createElement(v.a,{title:s,withMeta:!1})))}_renderSidebarContent(){const{focalTweet:e}=this.props;return e&&e.user.id_str?c.createElement(u.a,{withTopicsToFollow:!1,withWhoToFollow:!1},c.createElement(z,{focalTweetId:e.id_str})):null}_renderTimeline(){const{focalTweet:e,history:t,location:a,richLandingContextId:r,rootTweet:n,screenName:o,selectedTweetId:i,statusId:s,socialContext:l,promotedContent:d,contextTweetId:u}=this.props,g={selectedTweetId:i},m=this._isInlineReplyEnabled&&!this._isInlineReplyWithFabEnabled?null:c.createElement(U,{getLocationState:this._getFabState,history:t});return c.createElement(x.a,{fab:m},this._shouldRenderRichTweetLandingTimeline()?c.createElement(ie,{richLandingContextId:r,statusId:s,title:pe}):c.createElement(K.a,{apiErrorHandlerMap:Te(o),contextTweetId:u,fetchOptions:this._getNavigationParams(),focalTweet:e,focalTweetId:s,location:a,module:this._getModule(),onEntriesUpdate:this._handleEntriesUpdate,promotedContent:d,rootTweet:n||void 0,selectedTweet:g,socialContext:l}))}_shouldRenderRichTweetLandingTimeline(){const{isReferredFromExploreTopics:e,richLandingContextId:t}=this.props;return!!t||e||this._isBucketedInRichTweetLandingExperiment()}_clearTimelineCache(e=this._getModule(),t=this._getNavigationParams()){const{clearTimelineCache:a,createLocalApiErrorHandler:r,screenName:n}=this.props;a(e,t).catch(r(Te(n)))}}n()(ke,"contextType",s.a),n()(ke,"defaultProps",{recordTTFL:o.c});t.default=P(Object(ge.a)(ke))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.Conversation.fcc5ec35.js.map