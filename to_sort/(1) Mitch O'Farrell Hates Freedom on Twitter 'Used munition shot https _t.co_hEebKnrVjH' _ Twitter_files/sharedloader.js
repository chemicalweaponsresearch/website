(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+/sI":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("ERkP"),r=n("TGcR"),s=n("t62R"),i=n("a6qo"),o=n("rHpw");const c="animated_gif",d="video";class u extends a.PureComponent{render(){const{durationInMilliseconds:e,type:t}=this.props;let n;if(t===c||"vine"===t)n=t===c?a.createElement(s.c,{weight:"bold"},"GIF"):a.createElement(r.a,{style:l.icon});else if(t===d&&e){const t=Math.trunc(e/6e4),r=`0${Math.trunc(e%6e4/1e3)}`.slice(-2);n=a.createElement(s.c,{color:"white"},`${t}:${r}`)}return n?a.createElement(i.a,{align:"left"},n):null}}const l=o.a.create((e=>({icon:{color:e.colors.white}})));t.c=u},"/Imo":function(e,t,n){"use strict";var a=n("97Jx"),r=n.n(a),s=n("KEM+"),i=n.n(s),o=(n("kYxP"),n("ERkP")),c=n("/yvb"),d=n("k/Ka"),u=n("3XMw"),l=n.n(u),p=n("rHpw");const _=l.a.i5450beb,m=l.a.f7432494;class E extends o.Component{constructor(...e){super(...e),i()(this,"_handlePress",(e=>{const{onPress:t}=this.props;t&&t(e),this._fileInput&&this._fileInput.click()})),i()(this,"_handleChange",(e=>{const{onChange:t}=this.props,n=e.target,a=n.files;a.length&&t&&t(a),n.value=""})),i()(this,"_handleFileInputButtonRef",(e=>{this._fileInput=e}))}render(){const{accept:e,disabled:t,multiple:n,onChange:a,testID:s,...i}=this.props,u=!(null!=e&&e.includes("video")||null!=e&&e.includes("gif"));return o.createElement(o.Fragment,null,o.createElement(c.a,r()({},i,{disabled:t,hoverLabel:e?{label:u?m:_}:void 0,onPress:this._handlePress})),Object(d.a)("input",{accept:e,disabled:t,multiple:n,onChange:this._handleChange,ref:this._handleFileInputButtonRef,style:f.input,tabIndex:-1,testID:s,type:"file"}))}}i()(E,"defaultProps",{disabled:!1,multiple:!1});const f=p.a.create((e=>({input:{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1}})));t.a=E},"07FG":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("cnVF");const r=e=>e===a.v},"4q8G":function(e,t,n){"use strict";var a=n("t0aI");t.a=({sort_event_id:e},{sort_event_id:t})=>e?t?Object(a.a)(t,e):1:-1},"7myi":function(e,t,n){"use strict";var a=n("KEM+"),r=n.n(a),s=(n("kYxP"),n("ERkP")),i=n("oEoC"),o=n("2dXj"),c=n("GZwR");class d extends s.Component{constructor(...e){super(...e),r()(this,"_genericWrapperRef",s.createRef()),r()(this,"state",{queryContext:void 0,canShowTypeahead:!1}),r()(this,"render",(()=>{const{contextText:e,children:t,isInline:n,onTypeaheadStateChange:a,source:r}=this.props,{queryContext:i,canShowTypeahead:d}=this.state,u=d&&i?{word:i.word,resultType:i.resultType}:void 0;return s.createElement(o.a,{contextText:e,isInline:n,onDismiss:this._handleDismiss,onSelectItem:this._handleSelectItem,onTypeaheadStateChange:a,query:u,ref:this._genericWrapperRef,source:r||c.d.Compose},t(this._handleInputChange))})),r()(this,"_handleSelectItem",(e=>{const{onTextUpdated:t}=this.props,{queryContext:n}=this.state;if(n){const a="users"===n.resultType&&"user"===e.type?`@${e.data.screen_name} `:`${e.data.topic||e.data.text||""} `,{newCursor:r,newTweetText:s}=this._replaceToken(a,n);t({target:{value:s}}),this._updateDOMTextArea(r,s)}this._setQueryContext(void 0)})),r()(this,"_updateDOMTextArea",((e,t)=>{this._textAreaRef&&(this._textAreaRef.value=t,this._textAreaRef.selectionStart=e,this._textAreaRef.selectionEnd=e,this._textAreaRef.focus())})),r()(this,"_handleInputChange",(e=>{const t=e&&(e.currentTarget||e.target),{queryContext:n}=this.state;this._textAreaRef=t;const a=n&&n.word,r=t.value,{word:s,start:o,end:c}=i.c(t.selectionStart,r),d=i.d(s||"","compose");if((null==d?void 0:d.q)!==a)if(this._genericWrapperRef.current&&this._genericWrapperRef.current.resetSelectedItem(),-1===o)this._setQueryContext(void 0);else if(d){const{q:e,result_type:n}=d;this._setQueryContext({word:e,resultType:n,fullText:t.value,startIndex:o,endIndex:c})}else this._setQueryContext(void 0)})),r()(this,"_setQueryContext",(e=>this.setState({queryContext:e,canShowTypeahead:!!e}))),r()(this,"_handleDismiss",(()=>this.setState({canShowTypeahead:!1})))}_replaceToken(e,t){const{fullText:n,startIndex:a,endIndex:r}=t,s=n.slice(0,a);return{newTweetText:s+e+n.slice(r),newCursor:s.length+e.length}}}t.a=d},BqYg:function(e,t){function n(e,t,n){var a,r,s,i,o;function c(){var d=Date.now()-i;d<t&&d>=0?a=setTimeout(c,t-d):(a=null,n||(o=e.apply(s,r),s=r=null))}null==t&&(t=100);var d=function(){s=this,r=arguments,i=Date.now();var d=n&&!a;return a||(a=setTimeout(c,t)),d&&(o=e.apply(s,r),s=r=null),o};return d.clear=function(){a&&(clearTimeout(a),a=null)},d.flush=function(){a&&(o=e.apply(s,r),s=r=null,clearTimeout(a),a=null)},d}n.debounce=n,e.exports=n},KqB4:function(e,t,n){"use strict";var a=n("IGGJ");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=[],a=(0,r.default)(e,t),s=0;s<a.length;s++)n.push(a[s].url);return n};var r=a(n("vwfs"));e.exports=t.default},LCtV:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n("KEM+"),r=n.n(a),s=(n("kYxP"),n("ERkP")),i=n("3XMw"),o=n.n(i),c=n("mN6z"),d=n("Qwev"),u=n("rHpw"),l=n("1auM"),p=n("ude7"),_=n("U+bB"),m=n("MWbm");const E=o.a.gff1f69e,f=Object.freeze({INFINITE:"infinite",MEDIUM:"medium",NONE:"none"});class I extends s.Component{constructor(...e){super(...e),r()(this,"state",{imagePreviewUrl:null}),r()(this,"_getImageSrc",(()=>{const{mediaItem:e,enableGif:t}=this.props,{imagePreviewUrl:n}=this.state;if(e&&e.mediaFile)return e.mediaFile.isGif&&!t?n:e.mediaFile.url}))}componentDidUpdate(){const{enableGif:e,mediaItem:{mediaFile:t}}=this.props,{imagePreviewUrl:n}=this.state;e||n||t instanceof l.a&&t.isGif&&Object(p.a)(t).then((e=>{this.setState({imagePreviewUrl:e})}))}shouldComponentUpdate(e,t){return!Object(c.a)(e,this.props)||!Object(c.a)(t,this.state)}render(){const{borderRadius:e,enableGif:t,mediaItem:n,onClick:a}=this.props,{imagePreviewUrl:r}=this.state||{},i=n.mediaFile&&n.mediaFile.isGif&&!t&&!r,o=n.needsProcessing||i,c=[b.root,h[e],o&&b.loadingBorder],u=this._getImageSrc();return s.createElement(m.a,{onClick:a,style:c},o||!u?s.createElement(d.a,{accessibilityLabel:E,style:b.activityIndicator}):s.createElement(_.a,{resizeMode:"cover",source:u,style:b.image}))}}r()(I,"defaultProps",{borderRadius:f.NONE,enableGif:!0});const h=u.a.create((e=>({[f.INFINITE]:{borderRadius:e.borderRadii.infinite},[f.MEDIUM]:{borderRadius:e.borderRadii.small},[f.NONE]:{borderRadius:e.borderRadii.none}}))),b=u.a.create((e=>({root:{borderRadius:e.borderRadii.xLarge,borderStyle:"solid",borderWidth:e.borderWidths.none,borderColor:"transparent",maxWidth:"100%",height:"100%",overflow:"hidden"},image:{display:"block",height:"100%",width:"100%"},loadingBorder:{borderColor:e.colors.gray300},activityIndicator:{height:"100%"}})));t.b=I},MLl7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));const a=Object.freeze({Composition:"composition",DMComposition:"dm_composition"}),r=e=>Object.values(a).indexOf(e)>=0,s=(e,t)=>"boolean"==typeof e?e:t},VPdC:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var a=n("97Jx"),r=n.n(a),s=n("KEM+"),i=n.n(s),o=n("ERkP"),c=n("3XMw"),d=n.n(c),u=n("cjZk"),l="fileInput",p=n("sjK1"),_=n("/Imo"),m=n("rHpw"),E=n("9HgX");const f=d.a.b9960f31,I=o.createElement(u.a,null),h=({acceptGifs:e,acceptImages:t=!0,acceptVideo:n})=>(t?E.b:[]).concat(e?[E.a]:[]).concat(n?p.a:[]);class b extends o.PureComponent{render(){const{acceptGifs:e,acceptImages:t,acceptVideo:n,customMimeTypes:a,icon:s,style:i,withIcon:c,...d}=this.props,u=h({acceptGifs:e,acceptImages:t,acceptVideo:n}).concat(a).join(",");return o.createElement(_.a,r()({},d,{accept:u,icon:c?s:void 0,style:[v.root,i],testID:l}))}}i()(b,"defaultProps",{acceptGifs:!0,acceptImages:!0,acceptVideo:!0,customMimeTypes:[],accessibilityLabel:f,icon:I,size:"normal",withIcon:!0});const v=m.a.create((e=>({root:{margin:`-${e.spaces.space12}`}})));t.a=b},VY6S:function(e,t,n){"use strict";var a=n("BqYg"),r=n.n(a);t.a=(e,t,n)=>r()(e,t,n)},VnFT:function(e,t,n){"use strict";n.d(t,"n",(function(){return O})),n.d(t,"m",(function(){return A})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return R})),n.d(t,"g",(function(){return M})),n.d(t,"e",(function(){return D})),n.d(t,"i",(function(){return x})),n.d(t,"j",(function(){return P})),n.d(t,"l",(function(){return j})),n.d(t,"h",(function(){return U})),n.d(t,"k",(function(){return L})),n.d(t,"a",(function(){return k})),n.d(t,"o",(function(){return F})),n.d(t,"b",(function(){return q})),n.d(t,"c",(function(){return W}));n("kYxP");var a=n("AspN"),r=n("xPna"),s=n("oEOe"),i=n("xCUF"),o=n("ude7"),c=n("07FG"),d=n("Ssj5"),u=n("fEA7"),l=n.n(u),p=n("uKEd"),_=n("lnti"),m=n("/NU0");const E="multiDraftDMs",f=e=>`rweb/multiDraftDMs/${e}`,I={};const h=e=>{const{conversation_id:t,id:n,localMediaId:a,recipient_ids:r,sender_id:s,text:i,attachment:o={},error:c}=e,d=Date.now().toString();return{conversation_id:t,recipient_ids:r,error:c,id:n,is_draft:!0,message_data:{attachment:o,localMediaId:a,sender_id:s,text:i,time:d},type:"message",time:d}},b=f("SEND_MESSAGE_REQUEST"),v=f("SEND_MESSAGE_SUCCESS"),y=f("SEND_MESSAGE_FAILURE"),O=e=>(t,n,{api:d})=>{const{senderId:u,cardUrl:E,conversationId:f,localMediaId:I,recipients:O=[],requestId:g=l.a.v1(),tweetAttachment:A,quickReply:T,...S}=e||{};t(Q(f));const C=n(),M=I||w(n(),f),[N]=a.h(C,M),{mediaFile:D}=N||{},x=O.length>0&&O.join(","),P={};D&&D.isGif?P.extraInitParams="&media_category=dm_gif":D&&D.isVideo&&(P.extraInitParams="&media_category=dm_video");const j=a.l(M,P),V=[t(j)],k=U(C,f),{found_media_origin:B}=k||{},F=L(C,f);return D&&D.isGif&&V.push(Object(o.a)(D)),Promise.all(V).then((([[n],o])=>{const l=F&&Object.keys(F).length&&F[n.id]&&(F[n.id].altText||F[n.id].defaultAltText),I=!!l;return(n&&(B||I)?t(a.j({media_id:n.uploadId,found_media_origin:B,...!!I&&{alt_text:{text:l}}})):Promise.resolve()).then((()=>{const{id_str:a}=A||{},l={};if(n){const{mediaFile:e={}}=n,t={original_info:{width:e.width,height:e.height},sizes:[{h:e.height,w:e.width,resize:"fit"}]};e.isImage?l.photo={...t,media_url_https:e.url}:e.isGif?l.animated_gif={...t,media_url_https:o,type:"animated_gif"}:e.isVideo&&(l.video={...t,media_url_https:e.url,type:"video"})}else A&&(l.tweet={status:a});const{uploadId:I}=n||{},O=h({attachment:l,conversation_id:f,id:g,recipient_ids:x,sender_id:u,text:e.text}),C={...S,...Object(c.a)(E)&&{card_uri:E},conversation_id:f,...!a&&{media_id:I},recipient_ids:x,request_id:g,tweet_id:a};T&&(C["quick_reply_response[options][id]"]=T.id,C["quick_reply_response[options][selected_id]"]=T.selected_id);const N=Object(_.a)([Y(f),{type:i.c.REQUEST},{type:b},f&&Object(p.b)(f,g,O)]);return t(N),d.DirectMessages.sendMessage(C).then((n=>{const{entries:a,users:s,tweets:o,cards:c,fleets:d}=n.entities,{conversations:u}=n.result;Object(m.a)(M)&&t(W(f,M));const l=Object(_.a)([{type:i.c.SUCCESS},...Object(r.c)({conversations:u,entries:a,users:s,tweets:o,cards:c,fleets:d}),{type:v},f&&Object(p.j)(f,g,e),R(f)]);return t(l),Promise.resolve(Object.values(n.entities.entries)[0].conversation_id)}),(n=>{const a=h({attachment:l,conversation_id:f,error:!0,id:g,localMediaId:M,recipient_ids:x,sender_id:u,text:e.text}),r=Object(_.a)([{type:i.c.SUCCESS},{type:y},f&&Object(p.b)(f,g,a)]);return t(r),Object(s.e)(t,n,"ACTION_SEND_DM")}))}),(e=>(t($(f)),e.type="metadata",Promise.reject(e))))}),(e=>(t(Object(_.a)([Object(m.a)(M)&&W(f,M),$(f)])),Promise.reject(e))))},g=(e,t)=>e.multiDraftDMs[t],A=(e,t)=>{const n=g(e,t);return n?n.text:null},T=f("SAVE_TEXT"),S=(e,t)=>({type:T,conversationId:e,text:t}),C=f("REMOVE_TEXT"),R=e=>({type:C,conversationId:e}),M=(e,t)=>{const n=g(e,t);return n?n.cardUrl:null},N=f("SAVE_CARD_URL"),D=(e,t)=>({type:N,conversationId:e,cardUrl:t}),w=(e,t)=>{const n=g(e,t);return n?n.mediaId:null},x=(e,t)=>{const n=a.h(e,w(e,t));return n.length>0?n[0]:null},P=(e,t)=>{const n=g(e,t);return!!n&&n.isUploading},j=(e,t)=>a.i(e,w(e,t)),U=(e,t)=>{const n=g(e,t);return n?n.gifMetadata:null},L=(e,t)=>{const n=g(e,t);return n?n.mediaMetadata:void 0},V=f("ADD_MEDIA"),k=(e,[t],n,a)=>({payload:{isUploading:!1,mediaId:t,gifMetadata:n,mediaMetadata:a},type:V,conversationId:e}),B=f("UPDATE_MEDIA_METADATA"),F=(e,t)=>({payload:t,type:B,conversationId:e}),G=f("CANCEL_UPLOAD"),q=e=>({type:G,conversationId:e}),H=f("REMOVE_MEDIA"),K=e=>({type:H,conversationId:e}),W=(e,t)=>n=>{n(a.f(t)),n([q(e),K(e)])},z=f("UPLOAD_REQUEST"),Q=e=>({type:z,conversationId:e}),X=f("UPLOAD_SUCCESS"),Y=e=>({type:X,conversationId:e}),J=f("UPLOAD_FAILURE"),$=e=>({type:J,conversationId:e});d.a.register({[E]:function(e=I,t){const n=t.conversationId||"new_group";switch(t.type){case B:case V:{const a=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...a,...t.payload}}}case z:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...t,isUploading:!0}}}case G:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...t,isUploading:!1}}}case J:case X:case H:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...t,isUploading:!1,mediaId:null,mediaMetadata:void 0,gifMetadata:void 0}}}case T:{const a=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...a,text:t.text}}}case N:{const a=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...a,cardUrl:t.cardUrl}}}case C:{const t=e[n]||{cardUrl:null,gifMetadata:null,isUploading:!1,mediaMetadata:void 0,mediaId:null,text:null};return{...e,[n]:{...t,text:null}}}default:return e}}})},WVrH:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n("AQ79");const r=Object(a.c)("RESET"),s=()=>({type:r})},aWyx:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return i}));const a=Object.freeze({ONE_TO_ONE:"ONE_TO_ONE",GROUP:"GROUP_DM"}),r=Object.freeze({AT_END:"AT_END",HAS_MORE:"HAS_MORE"}),s=Object.freeze({CONVERSATION_AVATAR_UPDATE:"conversation_avatar_update",CONVERSATION_NAME_UPDATE:"conversation_name_update",CONVERSATION_PROFILE_INFO_HEADER:"conversation_profile_info_header",CONVERSATION_READ:"conversation_read",CONVO_METADATA_UPDATE:"convo_metadata_update",DISABLE_NOTIFICATIONS:"disable_notifications",ENABLE_NOTIFICATIONS:"enable_notifications",JOIN_CONVERSATION:"join_conversation",MARK_ALL_AS_READ:"mark_all_as_read",MENTION_NOTIFICATIONS_UPDATE:"mention_notifications_setting_update",MESSAGE:"message",MESSAGE_DELETE:"message_delete",MESSAGE_MARK_AS_NOT_SPAM:"message_unmark_as_spam",MESSAGE_MARK_AS_SPAM:"message_mark_as_spam",PARTICIPANTS_JOIN:"participants_join",PARTICIPANTS_LEAVE:"participants_leave",REACTION_CREATE:"reaction_create",REACTION_DELETE:"reaction_delete",READ_ONLY_INDICATOR:"read_only_indicator",REMOVE_CONVERSATION:"remove_conversation",TRUST_CONVERSATION:"trust_conversation",TYPING_INDICATOR:"typing_indicator",WELCOME_MESSAGE:"welcome_message_create"}),i=Object.freeze({MUTUAL_FRIENDS:"mutual_friends"})},b5s6:function(e,t,n){"use strict";var a=n("97Jx"),r=n.n(a),s=n("ERkP"),i=n("v6aA"),o=n("rxPX"),c=n("XOJV");const d=(e,t)=>t.tweetId;var u=Object(o.a)().propsFromState((()=>({hydratedTweet:c.a.createHydratedTweetSelector(d)}))),l=n("uCxL");const p=u((({hydratedTweet:e,tweetId:t,...n})=>{const{featureSwitches:a,loggedInUserId:o}=s.useContext(i.a),c=a.isTrue("responsive_web_alt_text_badge_enabled");return s.createElement(l.a,r()({},n,{loggedInUserId:o,shouldShowAltLabelAlways:c,tweet:e}))}));t.a=p},cIoY:function(e,t,n){"use strict";var a=n("ERkP"),r=n("1YZw"),s=n("rxPX"),i=Object(s.a)().propsFromActions((()=>({addToast:r.b}))),o=n("KEM+"),c=n.n(o),d=(n("kYxP"),n("k/Ka")),u=n("3XMw"),l=n.n(u),p=n("sgih"),_=n("t62R"),m=n("/yvb"),E=n("rHpw");const f=l.a.cfd2f35d;class I extends a.Component{constructor(...e){super(...e),c()(this,"_handleOnFocus",(e=>{e.currentTarget.select()}))}render(){const{cancelButtonLabel:e,description:t,headerText:n,link:r,onCancel:s}=this.props,i=Object(d.a)("input",{autoFocus:!0,onFocus:this._handleOnFocus,readOnly:!0,style:h.linkInput,value:r});return a.createElement(p.a,{onMaskClick:s,style:h.container,type:"center",withMask:!0},n&&a.createElement(_.c,{align:"center",color:"normal",style:h.headerText,weight:"bold"},n),t&&a.createElement(_.c,{align:"center",color:"gray600",style:h.labelText},t),i,a.createElement(m.a,{onPress:s,size:"normalLarge",style:h.cancelButton,type:"text"},e))}}c()(I,"defaultProps",{cancelButtonLabel:f});const h=E.a.create((e=>({container:{alignItems:"center",paddingVertical:e.spaces.space32,paddingHorizontal:e.spaces.space12,position:"relative"},headerText:{marginBottom:e.spaces.space16},labelText:{marginBottom:e.spaces.space16,width:"100%"},linkInput:{backgroundColor:e.colors.gray0,borderColor:"transparent",color:e.colors.gray600,fontSize:e.fontSizes.normal,marginBottom:e.spaces.space12,paddingVertical:e.spaces.space12,paddingHorizontal:e.spaces.space20},cancelButton:{width:"100%"}})));var b=I,v=n("I/9y"),y=n("mjJ+"),O=n("cm6r"),g=n("CaKu"),A=n("U+bB");const T=l.a.e05c00b4,S=l.a.eabf2209,C=l.a.a613e72f,R=l.a.f88553c8,M={riffsy:"https://abs.twimg.com/a/1501527574/img/t1/icon_riffsy.png",giphy:"https://abs.twimg.com/a/1501527574/img/t1/icon_giphy.png"};class N extends a.PureComponent{constructor(e){super(e),c()(this,"_renderMenu",(e=>a.createElement(y.a,{items:[{text:C,Icon:v.a,onClick:this._handleCopyGifLinkButtonClick}],onCloseRequested:e}))),c()(this,"_handleCopyGifLinkButtonClick",(e=>{const{addToast:t,gifUrl:n}=this.props;g.a.isAvailable()?(g.a.setString(n),t({text:R})):this.setState({showCopyLinkSheet:!0}),e&&e()})),c()(this,"_handleCopyLinkSheetCancel",(()=>{this.setState({showCopyLinkSheet:!1})})),this.state={showCopyLinkSheet:!1}}render(){const{showCopyLinkSheet:e}=this.state,{provider:t,gifUrl:n}=this.props,{display_name:r,name:s}=t,i=M[s];return i?a.createElement(a.Fragment,null,e?a.createElement(b,{description:S({providerName:r}),headerText:T,link:n,onCancel:this._handleCopyLinkSheetCancel}):null,a.createElement(_.c,{align:"center",color:"gray600",style:D.root},a.createElement(l.a.I18NFormatMessage,{$i18n:"e2e6ea0d"},this._renderAttribution(r,i)))):null}_renderAttribution(e,t){return a.createElement(O.a,{interactiveStyles:null,renderMenu:this._renderMenu},a.createElement(_.c,{weight:"bold",withInteractiveStyling:!0},a.createElement(A.a,{source:{uri:t},style:D.image}),a.createElement(_.c,{color:"normal"},e.toUpperCase())))}}const D=E.a.create((e=>({button:{marginLeft:e.spaces.space12},image:{display:"inline-block",height:e.spaces.space16,marginHorizontal:e.spaces.space4,width:e.spaces.space16},root:{marginHorizontal:e.spaces.space12}})));var w=N;const x=i((({addToast:e,provider:t,gifUrl:n})=>a.createElement(w,{addToast:e,gifUrl:n,provider:t})));t.a=x},gpVt:function(e,t,n){"use strict";n.d(t,"b",(function(){return R}));var a=n("KEM+"),r=n.n(a),s=n("ERkP"),i=n("v6aA"),o=(n("kYxP"),n("ge3j")),c=n("VnFT"),d=n("vjRr"),u=n("rxPX"),l=n("0KEI");const p=(e,t)=>{const{urls:n}=t,a=[...n];let r;for(const t of a.reverse())if(r=d.a.select(e,t),r)break;return r};var _=Object(u.a)().propsFromState((()=>({card:p}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(l.d)("COMPOSER_CARD_PREVIEW"),fetchCardPreviewIfNeeded:d.a.fetchCardPreviewIfNeeded,updateDMComposer:c.e,updateTweetComposer:o.y}))),m=n("KqB4"),E=n.n(m),f=n("aX4+"),I=n("3XMw"),h=n.n(I),b=n("hOZg"),v=n("cnVF"),y=n("MWbm"),O=n("/yvb"),g=n("rHpw"),A=n("VY6S"),T=n("mN6z");const S=h.a.f6fec9f6,C=/^https?:\/\//i,R=e=>{const t=E()(e);if(t.length)return t.map((e=>!C.test(e)&&`http://${e}`||e))};class M extends s.Component{constructor(e,t){super(e,t),r()(this,"_fetchCardPreviewIfNeeded",(()=>{const{fetchCardPreviewIfNeeded:e,urls:t,createLocalApiErrorHandler:n}=this.props;t.forEach((t=>{e(t).catch(n())}))})),r()(this,"_handleCardPreviewDismissal",(e=>this._updateSingleComposer({cardUrl:v.v}))),r()(this,"_updateSingleComposer",(e=>{const{conversationId:t,index:n,updateDMComposer:a,updateTweetComposer:r}=this.props,{cardUrl:s}=e||{};this._isDMComposer?t&&a(t,s):r({updates:{cardUrl:s},index:n})})),this._debouncedFetchCardPreview=Object(A.a)(this._fetchCardPreviewIfNeeded,1e3),this._isDMComposer=!!e.conversationId}componentDidMount(){this._debouncedFetchCardPreview()}componentDidUpdate(e){const{urls:t}=this.props;Object(T.a)(e.urls,t)||this._debouncedFetchCardPreview()}componentWillUnmount(){this._updateSingleComposer()}render(){const{card:e,isCardPreviewTombstoned:t,style:n}=this.props,{loggedInUserId:a}=this.context;return e&&!t&&a?s.createElement(y.a,{style:n},s.createElement(f.a,{card:{name:e.name,url:e.url,binding_values:e.binding_values},cardContext:{tweetUserId:a},isInteractive:!1,preventVideoPlayback:!0}),s.createElement(O.a,{accessibilityLabel:S,icon:s.createElement(b.a,null),onPress:this._handleCardPreviewDismissal,size:"small",style:N.closeButton,type:"onMedia"})):null}}r()(M,"contextType",i.a);const N=g.a.create((e=>({closeButton:{position:"absolute",top:e.spaces.space4,left:e.spaces.space4}}))),D=_(M);t.a=D},jtO7:function(e,t,n){"use strict";var a=n("97Jx"),r=n.n(a),s=n("ERkP"),i=n("t62R"),o=n("I4+6"),c=n("cm6r"),d=n("rHpw"),u=n("MWbm");const l=d.a.create((e=>({container:{backgroundColor:e.colors.cellBackground},root:{justifyContent:"center",minHeight:e.spaces.space48,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},bottomBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:1}})));t.a=({align:e="center",color:t,label:n,withBottomBorder:a=!0,...p})=>{const _=o.a.generate({backgroundColor:d.a.theme.colors.transparent,color:d.a.theme.colors[t],insetFocusRing:!0}),m=[l.root,a&&l.bottomBorder];return s.createElement(u.a,{style:l.container},s.createElement(c.a,r()({},p,{interactiveStyles:_,style:m}),s.createElement(i.c,{align:e,color:t},n)))}},kIAd:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n("0vv5");const r=500,s={scoper:[{type:"dmUserSearch",regexp:/^[@＠]?(.*)|^$/,srcInputs:["compose_message"],scope:{result_type:"users",count:20}},{type:"username",regexp:/^[@＠](\w{1,20})/,srcInputs:["compose"],scope:{result_type:"users",count:20}},{type:"hashtag",regexp:n.n(a).a,srcInputs:["compose"],scope:{result_type:"topics",count:20}},{type:"topic",regexp:/(.+)/,srcInputs:["search_box"],scope:{result_type:"all"}},{type:"ttt",regexp:/(.+)/,srcInputs:["welcome_flow"],scope:{count:10,result_type:"topics,ttt"}}],WordBoundary:/[!'%&'()*+,\\\-./:;<=>?[\]^{|}~\s]|$/,WordEnd:/[^!'%&'()*+,\\\-./:;<=>?[\]^{|}~\s]+$/}},krmn:function(e,t,n){"use strict";n("kYxP");var a=n("ERkP"),r=n("zb92"),s=n("RuTB"),i=n("3XMw"),o=n.n(i),c=Object(r.a)({loader:()=>o.a.emoji.then((()=>Promise.all([n.e(16),n.e(11),n.e(170)]).then(n.bind(null,"5RdJ")))),renderPlaceholder:(e,t)=>a.createElement(s.a,{hasError:e,onRetry:t})}),d=n.p+"twemoji_sprite.4b2aa715.png",u=n.p+"twemoji_sprite_high_res.c9967b15.png",l=n("rHpw"),p=n("U+bB"),_=n("kLqS"),m=n("MWbm");const E=l.a.create((e=>({content:{backgroundColor:e.colors.cellBackground},dimensions:{height:"400px",borderRadius:e.borderRadii.xLarge,minWidth:`calc(${e.spaces.space32} * 9 + 2 * ${e.spaces.space12})`},hidden:{display:"none"}})));var f=e=>{const{partialRender:t,onSelect:n}=e,r=_.a.get()>1?u:d;return a.createElement(a.Fragment,null,a.createElement(m.a,{style:[E.content,E.dimensions]},a.createElement(c,{onSelect:n,partialRender:t,rowSize:9,spriteUrl:r})),a.createElement(p.a,{source:r,style:E.hidden}))},I=n("pNJr"),h=n("2ZFc"),b=n("OiMc"),v=n("/yvb");const y=o.a.d4a4842d,O=a.createElement(I.a,null),g=o.a.fec16c1c,A=e=>{const{disabled:t,onEmojiSelect:n,onPress:r,size:s,style:i,textInputRef:o}=e,[d,u]=a.useState(!0);a.useEffect((()=>{setTimeout((()=>{c.preload(),h.a.get("emojiPicker2")}),5e3)}),[]);return a.createElement(b.a,{enableEnterKeyToggle:!0,onAnimateComplete:()=>u(!1),onDismiss:()=>u(!0),onHoverCardUnmount:()=>{window.requestAnimationFrame((()=>o&&o.focus()))},renderContent:()=>a.createElement(f,{onSelect:n,partialRender:d}),withArrow:!0},a.createElement(v.a,{accessibilityLabel:y,"aria-haspopup":"true",disabled:t,hoverLabel:{label:g},icon:O,onPress:e=>r&&r(e),size:s,style:i,type:"text"}))};A.defaultProps={disabled:!1,size:"small"};t.a=A},lRnM:function(e,t,n){"use strict";n.d(t,"f",(function(){return L})),n.d(t,"u",(function(){return k})),n.d(t,"y",(function(){return B})),n.d(t,"z",(function(){return F})),n.d(t,"C",(function(){return q})),n.d(t,"D",(function(){return H})),n.d(t,"B",(function(){return K})),n.d(t,"A",(function(){return W})),n.d(t,"v",(function(){return z})),n.d(t,"w",(function(){return Q})),n.d(t,"x",(function(){return X})),n.d(t,"d",(function(){return Y})),n.d(t,"k",(function(){return J})),n.d(t,"l",(function(){return $})),n.d(t,"n",(function(){return Z})),n.d(t,"m",(function(){return ee})),n.d(t,"a",(function(){return te})),n.d(t,"r",(function(){return ne})),n.d(t,"G",(function(){return ae})),n.d(t,"o",(function(){return se})),n.d(t,"c",(function(){return oe})),n.d(t,"p",(function(){return de})),n.d(t,"q",(function(){return ue})),n.d(t,"L",(function(){return le})),n.d(t,"t",(function(){return _e})),n.d(t,"F",(function(){return Ee})),n.d(t,"h",(function(){return fe})),n.d(t,"j",(function(){return Ie})),n.d(t,"g",(function(){return he})),n.d(t,"i",(function(){return be})),n.d(t,"M",(function(){return ve})),n.d(t,"J",(function(){return ye})),n.d(t,"K",(function(){return Oe})),n.d(t,"I",(function(){return Ae})),n.d(t,"b",(function(){return Se})),n.d(t,"s",(function(){return Re})),n.d(t,"H",(function(){return Ne})),n.d(t,"E",(function(){return we})),n.d(t,"e",(function(){return xe}));n("kYxP");var a=n("oEOe"),r=n("AspN"),s=n("RqPI"),i=n("AQ79"),o=n("/kEJ"),c=n("xPna"),d=n("pXBW"),u=n("hqKg"),l=n("k49u"),p=n("/NU0"),_=n("aWyx"),m=n("WVrH"),E=n("G6rE"),f=n("uKEd"),I=n("k6jb"),h=n("kGix"),b=n("t0aI");const v="ACTION_DM_ADD_PARTICIPANTS",y=a.a(i.b,"ACCEPT_CONVERSATION"),O=a.a(i.b,"MUTE_DM_USER"),g=a.a(i.b,"ADD_PARTICIPANTS"),A=a.a(i.b,"FETCH_CONVERSATION"),T=a.a(i.b,"FETCH_CONVERSATION_FROM_PARTICIPANTS"),S=a.a(i.b,"LEAVE_CONVERSATION"),C=a.a(i.b,"MARK_CONVERSATION_READ"),R=a.a(i.b,"DISABLE_MENTION_CONVERSATION_NOTIFICATIONS"),M=a.a(i.b,"DISABLE_CONVERSATION_NOTIFICATIONS"),N=a.a(i.b,"ENABLE_MENTION_CONVERSATION_NOTIFICATIONS"),D=a.a(i.b,"ENABLE_CONVERSATION_NOTIFICATIONS"),w=a.a(i.b,"UPDATE_CONVERSATION_NAME"),x=a.a(i.b,"UPLOAD_MEDIA"),P=a.a(i.b,"UPDATE_GROUP_AVATAR"),j=(e,t)=>t+36e5*e,U={};function L(e=U,t){switch(t.type){case y.SUCCESS:{const{conversationId:n}=t.meta,a=e[n];return{...e,[n]:{...a,data:{...a.data,trusted:!0}}}}case ie:{const n=Object.entries(t.payload||{}).reduce(((t,[n,a])=>(t[n]={...V(e[n],a),fetchStatus:{[I.a]:h.a.LOADED,[I.b]:h.a.LOADED}},t)),{});return{...e,...n}}case g.REQUEST:{const n=t.meta.conversationId,a=e[n];return{...e,[n]:{...a,fetchStatus:{...a.fetchStatus,[I.b]:h.a.LOADING}}}}case g.FAILURE:{const n=t.meta.conversationId,a=e[n];return{...e,[n]:{...a,fetchStatus:{...a.fetchStatus,[I.b]:h.a.FAILED}}}}case g.SUCCESS:{const n=t.meta.conversationId,a=e[n],r=a.data.participants,s=t.payload.entities.entries?Object.values(t.payload.entities.entries)[0].participants:[];return{...e,[n]:{...a,fetchStatus:{...a.fetchStatus,[I.b]:h.a.LOADED},data:{...a.data,participants:[...r,...s]}}}}case A.REQUEST:{const{conversationId:n,direction:a=I.a}=t.meta,r=e[n];return{...e,[n]:{...r,fetchStatus:{...r&&r.fetchStatus||{},[a]:h.a.LOADING}}}}case A.FAILURE:{const{conversationId:n,direction:a=I.a}=t.meta,r=e[n];return{...e,[n]:{...r,fetchStatus:{...r&&r.fetchStatus||{},[a]:h.a.FAILED},error:t.payload}}}case A.SUCCESS:{const{conversationId:n,direction:a=I.a}=t.meta;return{...e,[n]:{...e[n],fetchStatus:{...e[n]&&e[n].fetchStatus||{},[a]:h.a.LOADED}}}}case ce:return Object.entries(e).reduce(((n,[a,r])=>(n[a]=V(e[a],{last_read_event_id:t.payload}),n)),{});case C.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{last_read_event_id:t.meta.lastReadEventId})};case O.SUCCESS:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{muted:t.meta.mute})};case pe:{const{[t.payload]:n,...a}=e;return a}case S.REQUEST:return{...e,[t.meta.conversationId]:{...e[t.meta.conversationId],isDeleted:!0}};case me:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{notifications_disabled:!t.payload})};case M.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{notifications_disabled:!0,mute_expiration_time:(n=(new Date).getTime(),[void 0,j(1,n),j(8,n),j(168,n)])[t.meta.duration]})};case R.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{mention_notifications_disabled:!0})};case D.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{notifications_disabled:!1})};case N.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{mention_notifications_disabled:!1})};case Me:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{avatar_image_https:t.payload})};case w.REQUEST:case w.SUCCESS:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{name:t.meta.name})};case ge:{const n=e[t.meta.conversationId],a=n&&n.data&&n.data.max_entry_id||"0";return Object(b.b)(t.payload,a)?{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{max_entry_id:t.payload})}:e}case x.REQUEST:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{isUploading:!0})};case x.FAILURE:case x.SUCCESS:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{isUploading:!1})};case Te:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{avatarMediaId:t.payload})};case Ce:return{...e,[t.meta.conversationId]:V(e[t.meta.conversationId],{avatarMediaId:null})};case m.a:return U;default:return e}var n}const V=(e={},t={},n=[])=>{const{error:a,...r}=e,{avatarMediaId:s=null}=Object(p.a)(t.avatarMediaId)?t:r,{isUploading:i=!1}=t,{avatarMediaId:o,isUploading:c,max_entry_id:d,...u}=t,l={...r&&r.data,...u};var _,m;return!!u.conversation_id&&!u.convo_label&&delete l.convo_label,d&&(l.max_entry_id=(_=d,m=r&&r.data&&r.data.max_entry_id,Object(b.c)(_,m)?_:m)),{...r,avatarMediaId:s,data:l,isUploading:i}},k=(e,t)=>e[i.a].conversations[t],B=(e,t)=>{const n=k(e,t);return n&&n.fetchStatus?Object(h.b)(n.fetchStatus,n.data):h.a.LOADED},F=(e,t)=>{const n=k(e,t);return!(!n||!n.fetchStatus)&&Object(h.b)(n.fetchStatus,n.data)===h.a.LOADED},G=(e,t)=>{const n=k(e,t);return!(!n||!n.fetchStatus)&&n.fetchStatus[I.a]===h.a.LOADING},q=Object(u.createSelector)((e=>e[i.a].conversations),(e=>Object.entries(e).reduce(((e,[t,n])=>(n.data&&!n.isDeleted&&(e[t]=n),e)),{}))),H=e=>Object.keys(q(e)).length>0,K=(e,t)=>{const{data:n}=k(e,t)||{},{sort_event_id:a}=n||{};if(a){const t=s.h(e),{message_data:n,by_user_id:r,id:i,sender_id:o}=Object(f.n)(e,a)||{};if(o&&o!==t||n&&n.sender_id!==t||r&&r!==t)return i}return null},W=(e,t)=>{const n=K(e,t),{data:a}=k(e,t)||{};return!n||!!(a&&a.last_read_event_id&&Object(b.c)(a.last_read_event_id,n))},z=(e,t)=>{const{avatarMediaId:n}=k(e,t)||{};return n},Q=(e,t)=>{const{isUploading:n}=k(e,t)||{};return n},X=(e,t)=>r.i(e,z(e,t)),Y=(e,t)=>(n,r,{api:s})=>{const i=t.join(",");return a.b(n,{params:{conversationId:e,joinedParticipantIds:i},request:s.DirectMessages.addParticipants})({actionTypes:g,context:v,meta:{conversationId:e,participantIds:t}},(e=>{if(e){const{entities:t}=e;return[t.entries&&Object(f.a)(t.entries),Object(o.c)(t)]}})).then((e=>{const t=e.result.failed_participants;if(!t)return Promise.resolve(e);const n=Object.keys(t),a=1===n.length?t[n[0]]:l.a.DefaultApiError,r=new d.a("addParticpants URL",500,e.headers,[{code:a}]);return r.context.action=v,Promise.reject(r)}))},J=(e={})=>(t,n,{api:r})=>{const{conversationId:s,context:i}=e;return a.b(t,{params:e,request:r.DirectMessages.fetchConversation})({actionTypes:A,context:i,meta:{conversationId:s,direction:Object(I.c)(e)}},(e=>{if(e){const{cards:t,entries:n,tweets:a,users:r,fleets:s}=e.entities,{conversations:i,max_entry_id:o,min_entry_id:d,status:u}=e.result.conversation_timeline,l=((e={},t)=>Object.entries(e).reduce(((e,[n,a])=>({...e,[n]:{...a,...t}})),{}))(i,{max_entry_id:o,min_entry_id:d,status:u});return Object(c.c)({conversations:l,entries:n,users:r,tweets:a,cards:t,fleets:s})}}))},$=e=>(t,n,{api:r})=>a.b(t,{params:{participantIds:e},request:r.DirectMessages.fetchConversationFromParticipants})({actionTypes:T,meta:{participantIds:e}}),Z=(e={})=>(t,n)=>{const a=n(),{conversationId:r}=e,{data:s={}}=k(a,r)||{},i=G(a,r);return(!s.status||s.status===_.c.HAS_MORE)&&!i?t(J({conversationId:r,context:"FETCH_DM_CONVERSATION"})):Promise.resolve()},ee=(e={})=>(t,n)=>{const a=n(),{conversationId:r}=e,{data:s}=k(a,r)||{},{status:i,min_entry_id:o}=s||{},c=G(a,r);return i!==_.c.HAS_MORE||c?Promise.resolve():t(J({...e,max_id:o,context:"FETCH_DM_CONVERSATION_HISTORY"}))},te=e=>(t,n,{api:r})=>a.b(t,{params:{conversationId:e},request:r.DirectMessages.acceptConversation})({actionTypes:y,meta:{conversationId:e}}),ne=(e,t)=>re(e,t,!0),ae=(e,t)=>re(e,t,!1),re=(e,t,n)=>(r,s,{api:i})=>a.b(r,{params:{userId:e,relationshipAction:n?"mute":"unmute",conversationId:t},request:i.DirectMessages.muteDMUser})({actionTypes:O,meta:{userId:e,conversationId:t,mute:n}}).then(r(E.e.patchUser(e,{dm_muting:n}))),se=(e={})=>(t,n,{api:r})=>{const{conversationId:s}=e;return a.c(t,{params:e,request:r.DirectMessages.leaveConversation})({actionTypes:S,context:"ACTION_LEAVE_CONVERSATION",meta:{conversationId:s}})},ie=i.c("ADD_CONVERSATIONS"),oe=e=>({payload:e,type:ie}),ce=i.c("MARK_ALL_AS_READ"),de=e=>({payload:e,type:ce}),ue=(e,t)=>({type:C.REQUEST,meta:{conversationId:e,lastReadEventId:t}}),le=e=>(t,n,{api:r})=>{const s=n(),{data:i={}}=k(s,e)||{},{sort_event_id:o}=i,c=!W(s,e);if(e&&o&&c){return a.c(t,{params:{conversationId:e,last_read_event_id:o},request:r.DirectMessages.markRead})({actionTypes:C,bypassFailureOnErrors:()=>!0,context:"APP_DM_UPDATE_CONVERSATION_READ_STATE",meta:{conversationId:e,lastReadEventId:o}})}return Promise.resolve()},pe=i.c("REMOVE_CONVERSATION"),_e=e=>[{payload:e,type:pe},Object(f.i)(e)],me=i.c("TOGGLE_CONVERSATION_NOTIFICATIONS"),Ee=(e,t)=>({meta:{conversationId:e},payload:t,type:me}),fe=(e={})=>(t,n,{api:r})=>{const{conversationId:s,duration:i}=e;return a.c(t,{params:e,request:r.DirectMessages.disableNotifications})({actionTypes:M,context:"ACTION_DISABLE_NOTIFICATIONS",meta:{conversationId:s,duration:i}})},Ie=(e={})=>(t,n,{api:r})=>{const{conversationId:s}=e;return a.c(t,{params:e,request:r.DirectMessages.enableNotifications})({actionTypes:D,context:"ACTION_ENABLE_NOTIFICATIONS",meta:{conversationId:s}})},he=(e={})=>(t,n,{api:r})=>{const{conversationId:s}=e,i={mention_notifications_disabled:!0,...e};return a.c(t,{params:i,request:r.DirectMessages.updateMentionNotificationsSetting})({actionTypes:R,context:"ACTION_DISABLE_DM_MENTION_NOTIFICATIONS",meta:{conversationId:s}})},be=(e={})=>(t,n,{api:r})=>{const{conversationId:s}=e,i={mention_notifications_disabled:!1,...e};return a.c(t,{params:i,request:r.DirectMessages.updateMentionNotificationsSetting})({actionTypes:N,context:"ACTION_ENABLE_DM_MENTION_NOTIFICATIONS",meta:{conversationId:s}})},ve=(e={})=>(t,n,{api:a})=>a.DirectMessages.updateTyping(e),ye=(e={})=>(t,n,{api:r})=>{const{conversationId:s,name:i}=e;return a.c(t,{params:e,request:r.DirectMessages.updateConversationName})({actionTypes:w,context:"ACTION_UPDATE_CONVERSATION_NAME",meta:{conversationId:s,name:i}})},Oe=e=>({type:w.SUCCESS,meta:{conversationId:e.conversation_id,name:e.conversation_name}}),ge=i.c("UPDATE_CONVERSATION_MAX_ENTRY_ID"),Ae=(e,t)=>({meta:{conversationId:e},payload:t,type:ge}),Te=i.c("ADD_AVATAR_MEDIA"),Se=(e,t)=>({meta:{conversationId:e},payload:t,type:Te}),Ce=i.c("REMOVE_AVATAR_MEDIA"),Re=(e,t)=>({meta:{conversationId:e},payload:t,type:Ce}),Me=i.c("UPDATE_CONVERSATION_AVATAR"),Ne=(e,t)=>({meta:{conversationId:e},payload:t,type:Me}),De="APP_DM_UPDATE_CONVERSATION_AVATAR",we=e=>(t,n,{api:s})=>{t({meta:{conversationId:e},type:x.REQUEST});const i=z(n(),e),o=r.l(i);return t(o).then((([n])=>{t({meta:{conversationId:e},type:x.SUCCESS});return a.b(t,{params:{conversationId:e,avatar_id:n.uploadId},request:s.DirectMessages.updateConversationAvatar})({actionTypes:P,context:De})}),(n=>{const a={errors:n,context:De};return t({meta:{conversationId:e},type:x.FAILURE}),Promise.reject(a)}))},xe=(e,t)=>(n,r,{api:s})=>a.d(n,{params:{conversation_id:e,welcome_message_id:t},request:s.DirectMessages.addWelcomeMessageToConversation})("ADD_WELCOME_MESSAGE_TO_CONVERSATION")},oEoC:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return c}));n("kYxP");var a=n("kIAd");function r(e,t){let n;const r=a.b.scoper.find((a=>{if(-1!==a.srcInputs.indexOf(t))return n=e.match(a.regexp),n}));let s="";return n&&(s=n&&(1===n.length?n[0]:n[1])),r?{...r.scope,src:t,q:s}:null}function s(e,t){const n=t.slice(0,e),r=t.slice(e,t.length),s=n.search(a.b.WordEnd),i=s>=0?n.slice(s):"",o=r.search(a.b.WordBoundary),c=i+r.slice(0,o);return c.trim()?{start:s,end:e+o,word:c}:{start:-1,end:-1,word:""}}function i(){return`typeaheadFocus-${Math.random()}`}function o(e){const{altKey:t,ctrlKey:n,metaKey:a}=e;return!(t||n||a)}function c(e,t){const n=[];e.forEach((e=>{const a=t.find((t=>t.id===e.id));a&&a.data&&a.data.result_context?n.push(a):n.push(e)}));const a=n.map((e=>e.id)),r=t.filter((e=>a.indexOf(e.id)<0));return[...n,...r]}},pKoL:function(e,t,n){"use strict";var a=n("KEM+"),r=n.n(a),s=(n("kYxP"),n("ERkP")),i=n("HPNB"),o=n("9HgX"),c=n("3XMw"),d=n.n(c),u=n("LCtV"),l=n("k/Ka"),p=n("eXeu"),_=n("iOGT");class m extends s.Component{constructor(...e){super(...e),r()(this,"_setVideoRef",(e=>{const{getVideoRef:t}=this.props;t&&t(e)}))}render(){const{children:e,dataSaverMode:t,getVideoRef:n,style:a,variants:r,...i}=this.props,o=Object(_.b)(r,t?_.a.MEDIUM:_.a.HIGH)||[],c=Object(p.e)(o.map((e=>({src:e.url,type:e.content_type}))));return Object(l.a)("video",{...i,children:[c.map((e=>s.createElement("source",{key:e.src,src:e.src,type:e.type}))),e],ref:this._setVideoRef,style:a})}}r()(m,"defaultProps",{dataSaverMode:!1,variants:[]});var E=n("sjK1"),f=n("cHvH"),I=n("mXq/"),h=n("/yvb"),b=n("a6qo"),v=n("rHpw"),y=n("hOZg"),O=n("tuke"),g=n("U+bB"),A=n("MWbm"),T=n("+/sI");const S=d.a.gd80afba,C=d.a.abd845fd,R=d.a.df1b0707,M=d.a.cd959e5b,N=d.a.e68b09b4,D=d.a.add55c97;class w extends s.Component{constructor(...e){super(...e),r()(this,"state",{isVideoPaused:!0,playGif:!1}),r()(this,"_handleGifClick",(()=>{this.setState({playGif:!this.state.playGif})})),r()(this,"_handleMediaPreviewLayout",(e=>{const{mediaItem:t,resizeIfNeeded:n}=this.props,a=t.mediaFile||t.externalMediaDetails;if(!a)return;const{nativeEvent:{layout:{height:r,width:s}}}=e,{height:i,width:o}=a,c=o/i;Math.abs(c-s/r)>.05&&this._mediaContainer&&("width"===n?this._mediaContainer.setNativeProps({style:{width:r*c}}):"height"===n&&this._mediaContainer.setNativeProps({style:{height:s/c}}))})),r()(this,"_handleVideoOnPlay",(e=>{this.setState({isVideoPaused:!1})})),r()(this,"_handleVideoOnPause",(e=>{this.setState({isVideoPaused:!0})})),r()(this,"_setMediaContainerRef",(e=>{this._mediaContainer=e})),r()(this,"_setVideoRef",(e=>{this._video=e})),r()(this,"_playVideo",(()=>{if(this._video){const e=this._video.play();void 0!==e&&e.then((e=>{this._handleVideoOnPlay()})).catch()}})),r()(this,"_pauseVideo",(()=>{this._video&&(this._video.pause(),this._handleVideoOnPause())}))}render(){const{accessibilityLabel:e,accessibilityRole:t,enableGif:n,mediaItem:a,onEdit:r,onRemove:c,style:d,withAltTextLabel:u,withCloseButton:l,withEditButton:p}=this.props,{playGif:_}=this.state,m=a.externalMediaDetails&&a.externalMediaDetails.mediaType===o.a,E=m||n&&a.mediaFile&&a.mediaFile.isGif;return s.createElement(f.a,null,(({windowWidth:n})=>{const a=i.a.isTwoColumnLayout(n);return s.createElement(A.a,{accessibilityLabel:e||D,accessibilityRole:t,onLayout:this._handleMediaPreviewLayout,ref:this._setMediaContainerRef,style:[d,x.cursor,m&&x.gifPlayButton]},this._renderPreview(),m&&!_&&s.createElement(I.a,{accessibilityLabel:R,onPress:this._handleGifClick,size:"small"}),l?s.createElement(h.a,{accessibilityLabel:M,hoverLabel:{label:N},icon:s.createElement(y.a,null),onPress:c,size:"small",style:x.close,type:"onMedia"}):null,E?s.createElement(T.c,{type:T.a}):null,u?s.createElement(b.a,{align:"left",bold:!0},"ALT"):null,p?s.createElement(h.a,{accessibilityLabel:S,icon:a?void 0:s.createElement(O.a,null),onPress:r,size:a?"normalCompact":"small",style:x.edit,type:"onMedia"},a&&C):null)}))}_renderPreview(){const{mediaItem:e}=this.props;if(e.externalMediaDetails){const t=e.externalMediaDetails.previewUrl,n=e.externalMediaDetails.stillMediaUrl;return this._renderGifPreview(t,n)}if(e.mediaFile&&e.mediaFile.isVideo){const t=[{content_type:e.mediaFile.type,url:e.mediaFile.url}];return this._renderVideoPreview(t)}return s.createElement(A.a,{style:v.a.absoluteFill},this._renderImagePreview())}_renderGifPreview(e,t){const{playGif:n}=this.state,a={uri:n?e:t};return s.createElement(A.a,{onClick:this._handleGifClick,style:v.a.absoluteFill},s.createElement(g.a,{resizeMode:"cover",source:a,style:x.video}))}_renderImagePreview(){const{borderRadius:e,enableGif:t,mediaItem:n,onClick:a}=this.props;return s.createElement(u.b,{borderRadius:e,enableGif:t,mediaItem:n,onClick:a})}_renderVideoPreview(e){const{mediaItem:{mediaFile:t}}=this.props;return s.createElement(m,{autoPlay:!1,controls:!0,getVideoRef:this._setVideoRef,loop:!0,muted:!0,onPause:this._handleVideoOnPause,onPlay:this._handleVideoOnPlay,playsInline:!0,poster:t instanceof E.c?t.thumbnail:"",style:x.video,variants:e})}}r()(w,"defaultProps",{enableGif:!0,withCloseButton:!0,withAltTextLabel:!1,withEditButton:!1});const x=v.a.create((e=>({close:{position:"absolute",left:e.spaces.space4,top:e.spaces.space4},cursor:{cursor:"pointer"},edit:{position:"absolute",right:e.spaces.space4,top:e.spaces.space4},gifPlayButton:{alignItems:"center",justifyContent:"center"},video:{height:"100%",width:"100%"}})));t.a=w},rFBM:function(e,t,n){"use strict";var a=n("KEM+"),r=n.n(a),s=(n("kYxP"),n("ERkP")),i=n("rHpw"),o=n("k/Ka"),c=n("MWbm");const d=e=>Object(o.a)("div",e);class u extends s.Component{constructor(...e){super(...e),r()(this,"_dragEnterCount",0),r()(this,"state",{active:!1}),r()(this,"_handleDragDrop",(e=>{const{onFilesAdded:t}=this.props;e.preventDefault();t(Array.from(e&&e.dataTransfer.files)),this._updateDragCount(0)})),r()(this,"_handleDragEnter",(e=>{const{onDragEnter:t}=this.props;e.preventDefault(),t&&t(),this._updateDragCount(this._dragEnterCount+1)})),r()(this,"_handleDragLeave",(e=>{e.preventDefault(),this._updateDragCount(this._dragEnterCount-1)})),r()(this,"_handleDragOver",(e=>{e.preventDefault()}))}render(){const{allowDragDrop:e,children:t,style:n}=this.props,{active:a}=this.state,r=e?l.dragBorderValid:l.dragBorderInvalid;return s.createElement(d,{onDragEnter:this._handleDragEnter,onDragLeave:this._handleDragLeave,onDragOver:this._handleDragOver,onDrop:this._handleDragDrop,style:[l.root,n,a&&r]},s.createElement(c.a,{style:l.inner},"function"==typeof t?t(a):t))}_updateDragCount(e){this._dragEnterCount=e,0===this._dragEnterCount?this.setState({active:!1}):this._dragEnterCount>0&&this.setState({active:!0})}}r()(u,"defaultProps",{allowDragDrop:!0});const l=i.a.create((e=>({root:{display:"flex",flexDirection:"column"},dragBorderValid:{borderStyle:"dashed",borderWidth:e.spaces.space2,borderColor:e.colors.primary},dragBorderInvalid:{borderStyle:"dashed",borderWidth:e.spaces.space2,borderColor:e.colors.red500},inner:{flexGrow:1}})));t.a=u},tuke:function(e,t,n){"use strict";var a=n("ERkP"),r=n("Lsrn"),s=n("k/Ka");const i=(e={})=>Object(s.a)("svg",{...e,style:[r.a.root,e.style],viewBox:"0 0 24 24"},a.createElement("g",null,a.createElement("path",{d:"M21.592 5.576c.877-.967.882-2.298.006-3.174-.877-.877-2.208-.87-3.174.006 0 0-.003 0-.004.002l-.006.006-.005.004s-.002 0-.002.002L8.398 11.27c-1.716-.214-3.424.31-4.534 1.42-3.872 3.874-1.523 9.616-1.422 9.858.1.24.32.41.577.45.037.007.075.01.113.01.218 0 .428-.095.57-.265 1.83-2.15 3.043-2.023 4.328-1.89 1.164.122 2.477.258 3.834-1.282.975-1.106 1.302-2.585.922-4.03l8.792-9.948h.002l.004-.006.006-.006.002-.004zm-1.055-2.113c.305.305.28.74-.06 1.11-.003.003-.004.007-.006.01 0 0-.003 0-.004.003l-5.662 6.406-1.796-1.796 6.406-5.662c.002 0 .002-.003.004-.005.002-.003.006-.004.008-.006.37-.34.807-.365 1.11-.06zm-8.62 10.797L9.74 12.084l2.142-1.894 1.927 1.927-1.894 2.143zm-1.178 4.32c-.848.96-1.488.895-2.552.78-1.27-.13-2.808-.293-4.722 1.463-.415-1.673-.784-4.83 1.457-7.072.807-.805 2.086-1.168 3.377-.983l2.977 2.976c.333 1.03.15 2.057-.538 2.836z"})));i.metadata={width:24,height:24},t.a=i},uKEd:function(e,t,n){"use strict";n.d(t,"e",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"f",(function(){return C})),n.d(t,"d",(function(){return R})),n.d(t,"k",(function(){return M})),n.d(t,"i",(function(){return D})),n.d(t,"r",(function(){return w})),n.d(t,"h",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"j",(function(){return L})),n.d(t,"c",(function(){return k})),n.d(t,"g",(function(){return F})),n.d(t,"l",(function(){return G})),n.d(t,"n",(function(){return q})),n.d(t,"o",(function(){return H})),n.d(t,"m",(function(){return K})),n.d(t,"p",(function(){return W})),n.d(t,"q",(function(){return z}));n("kYxP");var a=n("t0aI"),r=n("aWyx"),s=n("SrIh"),i=n("WVrH"),o=n("fEA7"),c=n.n(o),d=n("AQ79"),u=n("3A2y"),l=n("J4ZH"),p=n("4FGy"),_=n("s1N3"),m=n("lnti"),E=n("oEOe");const f=Object(E.a)(d.b,"DELETE_MESSAGE"),I=Object(E.a)(d.b,"REACTION_CREATE"),h=Object(E.a)(d.b,"REACTION_DELETE"),b=Object(E.a)(d.b,"MARK_ENTRIES_AS_SPAM"),v=Object(E.a)(d.b,"MARK_ENTRIES_AS_NOT_SPAM"),y={entries:{},entryIdsByConversationId:{},reactionsByMessageId:{}};function O(e=y,t){const{conversationId:n,requestId:a}=t.meta||{};switch(t.type){case P:{const{id:a}=t.payload,r={...e.entries,[a]:g(e.entries[a],{data:t.payload})};return{...e,entries:r,entryIdsByConversationId:{...e.entryIdsByConversationId,[n]:A([...e.entryIdsByConversationId[n]||[],a],r)}}}case T:{const n=Object.values(t.payload).filter((e=>e.type!==r.b.CONVERSATION_READ)).reduce(((t,n)=>{const{id:a}=n,s=Object(u.a)(n,"message_reactions");return t.allEntries[a]=g(e.entries[a],{data:s,isLoading:!1,isLoaded:!0}),n.message_reactions&&(n.message_reactions.forEach((a=>{const s={...a,affects_sort:!0,message_id:n.id,type:r.b.REACTION_CREATE};t.allEntries[s.id]=g(e.entries[s.id],{data:s,isLoading:!1,isLoaded:!0})})),t.embeddedReactionsByMessageId[a]=A([...e.reactionsByMessageId[a]||[],...n.message_reactions.map((e=>e.id))],{...e.entries,...t.allEntries})),t}),{allEntries:{},embeddedReactionsByMessageId:{}}),a={...e.entries,...n.allEntries},s=Object(l.a)(Object.values(n.allEntries),(e=>e.data.conversation_id)),i=Object.keys(s).reduce(((t,n)=>{const r=s[n].map((e=>e.data.id));return t[n]=A([...e.entryIdsByConversationId[n]||[],...r],a),t}),{});return{...e,entries:a,entryIdsByConversationId:{...e.entryIdsByConversationId,...i},reactionsByMessageId:{...e.reactionsByMessageId,...n.embeddedReactionsByMessageId}}}case b.REQUEST:case v.REQUEST:{const n=t.type===b.REQUEST,a=t.payload.reduce(((t,a)=>{const r=e.entries[a]&&e.entries[a].data;return{...t,[a]:{...e.entries[a],data:{...r,marked_as_spam:n}}}}),{});return{...e,entries:{...e.entries,...a}}}case f.REQUEST:case N:{const a=t.type===N&&!Array.isArray(t.payload),r=e.entryIdsByConversationId[n]||[],s=t.type===N?a?r:t.payload:[t.payload,...e.reactionsByMessageId[t.payload]||[]];return{...e,entries:Object(u.a)(e.entries,s),entryIdsByConversationId:{...Object(u.a)(e.entryIdsByConversationId,n),...a?{}:{[n]:Object(p.a)(r,s)}},reactionsByMessageId:Object(u.a)(e.reactionsByMessageId,s)}}case U:{const r=t.payload.id||a,s={...Object(u.a)(e.entries,r)},i=A((e.entryIdsByConversationId[n]||[]).filter((e=>e!==r)),s),o=i?{[n]:i}:{};return{...e,entries:s,entryIdsByConversationId:{...Object(u.a)(e.entryIdsByConversationId,n),...o},reactionsByMessageId:Object(u.a)(e.reactionsByMessageId,r)}}case V:{const n=t.payload,a=[...e.reactionsByMessageId[n.message_id]||[],n.id],r=a.filter((t=>e.entries[t]));a.length!==r.length&&Object(s.a)("DM add reaction is missing a backing entry",{extra:{filteredMessageReactionIds:r,messageReactionIds:a,currentId:n.id}});const i=A(r,e.entries);return{...e,reactionsByMessageId:{...e.reactionsByMessageId,[n.message_id]:i}}}case h.REQUEST:case B:{const n=t.payload,a=(e.reactionsByMessageId[n.message_id]||[]).find((t=>e.entries[t].data.sender_id===n.sender_id));if(!a)return e;const r=Object(p.a)(e.entryIdsByConversationId[n.conversation_id],a),s=Object(p.a)(e.reactionsByMessageId[n.message_id],a);return{...e,entries:Object(u.a)(e.entries,a),entryIdsByConversationId:{...e.entryIdsByConversationId,[n.conversation_id]:r},reactionsByMessageId:{...e.reactionsByMessageId,[n.message_id]:s}}}case i.a:return y;default:return e}}const g=(e,t)=>{const{error:n,isLoaded:a,isLoading:r,...s}=e||{},{data:i,...o}=t||{};return{...s,data:{...s&&s.data,...i},...o}},A=(e=[],t)=>{const n=Object(_.a)(e).sort(((e,n)=>{const r=Object(a.a)(t[e].data.time,t[n].data.time);return 0===r?Object(a.a)(t[e].id,t[n].id):r}));return n.length?n:void 0},T=Object(d.c)("ADD_ENTRIES"),S=e=>({payload:e,type:T}),C=e=>(t,n,{api:a})=>{const{id:r,conversationId:s,requestId:i=c.a.v1(),...o}=e||{},d={...o,id:r,request_id:i};return Object(E.c)(t,{params:d,request:a.DirectMessages.deleteMessage})({actionTypes:f,context:"ACTION_DELETE_DM",payload:r,meta:{conversationId:s}})},R=e=>(t,n,{api:a})=>{const s=(({reaction_key:e,conversation_id:t,dm_id:n,perspective:a})=>({id:c.a.v1(),time:(new Date).getTime().toString(),reaction_key:e,conversation_id:t,message_id:n,sender_id:a,type:r.b.REACTION_CREATE}))(e);t([j(s.conversation_id,s.id,s),F(s),k(s)]);return Object(E.b)(t,{params:Object(u.a)(e,"perspective"),request:a.DirectMessages.addReaction})({actionTypes:I,context:"ACTION_REACTION_CREATE"},((e,t)=>{if(t)return[F(s)]}))},M=e=>(t,n,{api:a})=>{const{perspective:r,...s}=e;return Object(E.c)(t,{params:s,request:a.DirectMessages.deleteReaction})({actionTypes:h,context:"ACTION_REACTION_DELETE",payload:{conversation_id:e.conversation_id,message_id:e.dm_id,sender_id:r}})},N="rweb/dm/REMOVE_CONVERSATION_ENTRIES",D=(e,t)=>({meta:{conversationId:e},payload:t,type:N}),w=(e,t)=>({payload:e,type:t?b.REQUEST:v.REQUEST}),x=({conversationId:e,dmId:t,markSpam:n})=>(a,r,{api:s})=>Object(E.c)(a,{params:{dm_id:t,report_as:n?"spam":"not_spam"},request:s.DirectMessages.reportSpam})({actionTypes:n?f:v,payload:n?t:[t],meta:{conversationId:e}}),P=Object(d.c)("ADD_ENTRY"),j=(e,t,n)=>({meta:{conversationId:e,requestId:t},payload:n,type:P}),U=Object(d.c)("REMOVE_ENTRY"),L=(e,t,n)=>({meta:{conversationId:e,requestId:t},payload:n,type:U}),V=Object(d.c)("ADD_REACTION"),k=e=>({payload:e,type:V}),B=Object(d.c)("DELETE_REACTION"),F=e=>({payload:e,type:B}),G=e=>e[d.a].entries,q=(e,t)=>{const n=G(e).entries[t];return n&&n.data},H=(e,t)=>e[d.a].entries.entryIdsByConversationId[t],K=(e,t)=>{const n=H(e,t);return n?Object(m.a)(n.map((t=>q(e,t)))):[]},W=(e,t)=>G(e).reactionsByMessageId[t],z=(e,t)=>(W(e,t)||[]).map((t=>q(e,t).sender_id))},ude7:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("A0bJ"),r=n("hJBK"),s=n("1auM");const i=1,o=2,c=3,d=e=>{if(Object(s.b)(e)){if(e.isGif){const{img:t,width:n,height:s,orientation:i}=e;return Object(r.b)(t,n,s,i).then((e=>Object(r.a)(e)),(e=>{throw new a.a("Gif preview could not be generated",c)}))}{const e=new a.a("The provided image must be a gif",o);return Promise.reject(e)}}{const e=new a.a("The provided file is not a valid image",i);return Promise.reject(e)}}},w3n3:function(e,t,n){"use strict";var a=n("ERkP"),r=n("/yvb"),s=(n("MLl7"),n("3XMw")),i=n.n(s),o=n("3rWK"),c=n("Irs7");const d=i.a.a4993fa1,u=a.createElement(o.a,null),l=i.a.i0db46e6;t.a=({dmConversationId:e,enabled:t=!0,gifSearchKeySource:n,history:s,style:i,onPress:o})=>{const p=Object(c.b)(),_=a.useCallback((()=>{o&&o(),p.scribe({element:"found_media_button",action:"click"}),s.push({pathname:"/i/foundmedia/search",state:{gifSearchKeySource:n,dmConversationId:e}})}),[e,p,n,s,o]);return a.createElement(r.a,{accessibilityLabel:d,disabled:!t,hoverLabel:{label:l},icon:u,onPress:_,size:"normal",style:[i],type:"text"})}},wpu3:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return _})),n.d(t,"d",(function(){return m}));n("kYxP");var a=n("oEoC"),r=n("1auM"),s=(n("S1qy"),n("kIAd")),i=n("VAyw"),o=n("/Ikv"),c=n("s1N3"),d=n("lnti");const u=({inReplyToStatus:e,loggedInUserId:t,excludeReplyUser:n})=>{const{retweeted_status:a}=e,{entities:r}=a||e,{user:s}=e.retweeted_status||e,o=a?a.user:{},u=a?e.user:{},p=(null==r?void 0:r.user_mentions)||[],_=i.a.mergeTaggedUsers((null==r?void 0:r.media)||[]),m=l(a||e)||{},E={[o.id_str]:o,[u.id_str]:u,[s.id_str]:s,[m.id_str]:m};p.forEach((e=>{E[e.id_str]=e})),_.forEach((({user_id:e,name:t,screen_name:n})=>{E[e]={id_str:e,name:t,screen_name:n}}));const f=Object(c.a)(Object(d.a)([o.id_str,u.id_str,s.id_str,...p.map((e=>e.id_str)),..._.map((e=>e.user_id))])).filter((e=>e!==t));let I=t&&s.id_str===t?[t,...f]:f;return n&&(I=I.filter((e=>e!==s.id_str))),I.map((e=>E[e]))},l=({card:e})=>{let t=null;if(e){const n=o.a.getBindingValue(e.binding_values,"site");n&&e.users&&(t=e.users[n.id_str])}return t},p=({maxNumberOfPhotos:e})=>t=>{if(0===t.length)return!0;const n=t.some((e=>!!e.externalMediaDetails)),a=!n&&t.some((e=>e.mediaFile&&e.mediaFile.isGif)),s=t.some((e=>e.mediaFile&&!(e.mediaFile instanceof r.a)&&e.mediaFile.isVideo));if(a||n||s)return 1===t.length;{const n=t.length<=e,a=t.every((e=>e.mediaFile&&e.mediaFile.isImage));return n&&a}},_=p({maxNumberOfPhotos:4}),m=(e,t=!1)=>{const n=e.split(s.b.WordBoundary);return t&&n.pop(),!!n.find((e=>{const t=Object(a.d)(e,"compose");return t&&"users"===t.result_type}))}},xCUF:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return E})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return O}));n("kYxP");var a=n("oEOe"),r=n("aWyx"),s=n("k6jb"),i=n("AQ79"),o=n("uKEd"),c=n("xPna"),d=n("lRnM"),u=n("WVrH"),l=n("P1r1");const p=a.a(i.b,"FETCH_UPDATES"),_={isLoaded:!1,isLoading:!1};function m(e=_,t){switch(t.type){case p.REQUEST:return{...e,isLoading:!0};case p.FAILURE:return{...e,error:t.payload,isLoaded:!1,isLoading:!1};case p.SUCCESS:{const{error:t,...n}=e;return{...n,isLoaded:!0,isLoading:!1}}case I:return{...e,cursor:t.payload};case b:return{...e,tertiaryInboxStatus:t.payload};case u.a:return _;default:return e}}const E=e=>(t,n,{api:r})=>{const i=n(),{directMessages:o={}}=i;let{cursor:d}=o.updates||{};const{polling:_,...m}=e||{},{tertiaryInboxStatus:E}=o.updates||{};let f=!1;const I=_?{"x-twitter-polling":"true"}:{},h=Object(l.p)(i),b=[Object(l.r)(n())?"on":"off",h?"on":"off"].join();E?E!==b&&(d=null,f=!0):f=!0;const O=Object(c.j)({...m,muting_enabled:!0,nsfw_filtering_enabled:h,cursor:d},n());return a.b(t,{params:O,headers:I,request:r.DirectMessages.fetchUserUpdates})({actionTypes:p,context:"FETCH_DM_USER_UPDATES",meta:{direction:Object(s.c)(e)}},(e=>{if(e){const{entries:t,tweets:n,users:a,cards:r,fleets:s}=e.entities,{user_events:i,inbox_initial_state:o}=e.result;return[o&&Object(u.b)(),...Object(c.c)({...i||o,entries:t,users:a,tweets:n,cards:r,fleets:s}),...i?y(Object.values(t||[])):[],f&&v(b)]}}))},f=e=>(t,n)=>g(n())?Promise.resolve():t(E(e)),I=Object(i.c)("UPDATE_CURSOR"),h=e=>({payload:e,type:I}),b=Object(i.c)("UPDATE_TERTIARY_INBOX_STATUS"),v=e=>({payload:e,type:b}),y=(e=[])=>e.sort(((e,t)=>e.id-t.id)).reduce(((e,t)=>{switch(t.type){case r.b.CONVERSATION_AVATAR_UPDATE:return[...e,Object(d.H)(t.conversation_id,t.conversation_avatar_image_https),Object(d.I)(t.conversation_id,t.id)].filter((e=>e));case r.b.CONVERSATION_NAME_UPDATE:return[...e,Object(d.K)(t),Object(d.I)(t.conversation_id,t.id)].filter((e=>e));case r.b.CONVERSATION_READ:return[...e,Object(d.q)(t.conversation_id,t.last_read_event_id)];case r.b.DISABLE_NOTIFICATIONS:case r.b.ENABLE_NOTIFICATIONS:{const n=t.type===r.b.ENABLE_NOTIFICATIONS;return[...e,Object(d.F)(t.conversation_id,n)]}case r.b.MARK_ALL_AS_READ:return[...e,Object(d.p)(t.last_read_event_id)];case r.b.MESSAGE_DELETE:return[...e,Object(o.i)(t.conversation_id,t.messages.reduce(((e,t)=>[...e,...Object.values(t)]),[]))];case r.b.MESSAGE_MARK_AS_NOT_SPAM:case r.b.MESSAGE_MARK_AS_SPAM:{const n=t.type===r.b.MESSAGE_MARK_AS_SPAM;return[...e,Object(o.r)(t.messages.reduce(((e,t)=>[...e,...Object.values(t)]),[]),n)]}case r.b.REMOVE_CONVERSATION:return[...e,...Object(d.t)(t.conversation_id)];case r.b.JOIN_CONVERSATION:case r.b.PARTICIPANTS_JOIN:case r.b.PARTICIPANTS_LEAVE:return[...e,Object(d.I)(t.conversation_id,t.id)];case r.b.REACTION_CREATE:return[...e,Object(o.g)(t),Object(o.c)(t),Object(d.I)(t.conversation_id,t.id)];case r.b.REACTION_DELETE:return[...e,Object(o.g)(t)];case r.b.MESSAGE:return[...e,Object(d.I)(t.conversation_id,t.id)].filter((e=>e));default:return e}}),[]),O=e=>e[i.a].updates,g=e=>O(e).isLoading},xPna:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return S})),n.d(t,"d",(function(){return R})),n.d(t,"j",(function(){return D})),n.d(t,"t",(function(){return j})),n.d(t,"p",(function(){return U})),n.d(t,"o",(function(){return L})),n.d(t,"w",(function(){return V})),n.d(t,"y",(function(){return k})),n.d(t,"q",(function(){return B})),n.d(t,"s",(function(){return F})),n.d(t,"r",(function(){return G})),n.d(t,"n",(function(){return K})),n.d(t,"u",(function(){return W})),n.d(t,"z",(function(){return z})),n.d(t,"v",(function(){return Q})),n.d(t,"x",(function(){return X})),n.d(t,"e",(function(){return J})),n.d(t,"f",(function(){return $})),n.d(t,"h",(function(){return ee})),n.d(t,"i",(function(){return te})),n.d(t,"g",(function(){return ne})),n.d(t,"c",(function(){return se})),n.d(t,"D",(function(){return ie})),n.d(t,"E",(function(){return oe})),n.d(t,"C",(function(){return ce})),n.d(t,"m",(function(){return ue})),n.d(t,"B",(function(){return _e})),n.d(t,"l",(function(){return me})),n.d(t,"A",(function(){return Ie})),n.d(t,"k",(function(){return he}));n("kYxP");var a=n("oEOe");var r=n("/kEJ"),s=n("uKEd"),i=n("4q8G"),o=n("kGix"),c=n("aWyx"),d=n("WVrH"),u=n("xCUF"),l=n("AQ79"),p=n("lRnM"),_=n("tn7R"),m=n("YeIG"),E=n("t0aI"),f=n("P1r1");const I="rweb.dmDrawerVisibility",h="rweb.dmQuickAccessEnabled",b=a.a(l.b,"FETCH_INBOX"),v=a.a(l.b,"UPDATE_LAST_SEEN_EVENT_ID"),y="inbox",O="trusted",g="untrusted",A="untrusted_low_quality",T=Object.freeze({CLOSED:"closed",COLLAPSED:"collapsed",EXPANDED:"expanded"}),S={primary:"primary",secondary:"secondary",tertiary:"tertiary"},C={cursors:{[y]:{fetchStatus:o.a.NONE},[O]:{fetchStatus:o.a.NONE},[g]:{fetchStatus:o.a.NONE},[A]:{fetchStatus:o.a.NONE}},lastSeenEventIds:{},poppedOutConversationId:null,drawerVisibility:T.COLLAPSED,drawerExperimentEnabled:!1};function R(e=C,t){switch(t.type){case b.REQUEST:{const{timelineType:n}=t.meta;return{...e,cursors:{...e.cursors,[n]:{...e.cursors[n],fetchStatus:o.a.LOADING}}}}case b.FAILURE:{const{timelineType:n}=t.meta;return{...e,cursors:{...e.cursors,[n]:{...e.cursors[n],error:t.payload,fetchStatus:o.a.FAILED}}}}case b.SUCCESS:{const{timelineType:n}=t.meta;return{...e,cursors:{...e.cursors,[n]:{...e.cursors[n],error:void 0,fetchStatus:o.a.LOADED}}}}case ae:return{...e,cursors:{...e.cursors,...t.payload.cursors},lastSeenEventIds:M(e.lastSeenEventIds,t.payload.lastSeenEventIds)};case v.REQUEST:return{...e,lastSeenEventIds:{...e.lastSeenEventIds,...t.meta.lastSeenEventIds}};case d.a:return{...C,cursors:{...C.cursors,inbox:e.cursors.inbox}};case de:return{...e,poppedOutConversationId:t.conversationId,drawerVisibility:T.EXPANDED};case le:return{...e,drawerVisibility:t.visibility};case Ee:return{...e,drawerExperimentEnabled:t.enabled};default:return e}}const M=(e,t)=>({last_seen_event_id:N(e.last_seen_event_id,t.last_seen_event_id),trusted_last_seen_event_id:N(e.trusted_last_seen_event_id,t.trusted_last_seen_event_id),untrusted_last_seen_event_id:N(e.untrusted_last_seen_event_id,t.untrusted_last_seen_event_id)}),N=(e,t)=>Object(E.c)(e,t)?e:t,D=(e,t,n="all")=>{const a=Object(f.r)(t),r=Object(f.q)(t);return a?{...e,filter_low_quality:r,include_quality:n}:e},w=e=>e[l.a].inbox,x=e=>w(e).cursors,P=e=>w(e).lastSeenEventIds,j=e=>w(e).poppedOutConversationId,U=e=>w(e).drawerVisibility,L=e=>w(e).drawerExperimentEnabled,V=e=>x(e)[g],k=e=>x(e)[A],B=e=>(e=>x(e)[y])(e).fetchStatus,F=e=>B(e)===o.a.LOADING,G=e=>B(e)===o.a.LOADED,q={[S.primary]:e=>e.trusted,[S.secondary]:(e,t,n)=>t?!(e.trusted||e.muted||n&&e.nsfw||e.low_quality):!(e.trusted||e.muted||n&&e.nsfw),[S.tertiary]:(e,t,n)=>t?!e.trusted&&(e.muted||e.low_quality||n&&e.nsfw):!e.trusted&&(e.muted||n&&e.nsfw)},H=(e,t)=>{const n=Object(f.q)(e),a=Object(f.p)(e);return Object(_.a)(Object(p.C)(e)).filter((e=>q[t](e.data,n,a)))},K=(e,t)=>H(e,t).map((e=>e.data)).sort(i.a).map((e=>e.conversation_id)),W=e=>{const t=H(e,S.primary),n=H(e,S.secondary),a=t.concat(n),{last_seen_event_id:r}=P(e);return Y(e,a,r)},z=e=>{const t=H(e,S.secondary),{untrusted_last_seen_event_id:n}=P(e);return Y(e,t,n)},Q=e=>{const t=H(e,S.secondary),n=H(e,S.tertiary);return t.length+n.length},X=e=>H(e,S.tertiary).length,Y=(e,t,n)=>n?t.reduce(((t,{data:{conversation_id:a}})=>{const r=Object(p.B)(e,a),s=Object(p.A)(e,a);return r&&Object(E.b)(r,n)&&!s?t+1:t}),0):0,J=(e={})=>(t,n,{api:r})=>{const s=n(),i=Object(f.p)(s),o=D({muting_enabled:!0,nsfw_filtering_enabled:i,...e},n());return a.b(t,{params:o,request:r.DirectMessages.fetchUserInbox})({actionTypes:b,context:"FETCH_DM_INBOX",meta:{timelineType:y}},(e=>{if(e){const{entries:t,users:n,tweets:a,cards:r,fleets:s}=e.entities;return se({...e.result.inbox_initial_state,entries:t,users:n,tweets:a,cards:r,fleets:s})}}))},$=(e={})=>(t,n)=>{const a=n(),r=B(a);return r!==o.a.LOADED&&r!==o.a.LOADING?t(J(e)):Promise.resolve()},Z=(e,t,n=0)=>(r,s,{api:i})=>{const o=s(),d=Object(f.p)(o),{status:u,min_entry_id:l}=x(o)[e],p=e===A?g:e,_={...t,max_id:l,timelineType:p,muting_enabled:e!==O,nsfw_filtering_enabled:d};if(u!==c.c.HAS_MORE)return Promise.resolve();return a.b(r,{params:_,request:i.DirectMessages.fetchInboxHistory})({actionTypes:b,context:"FETCH_DM_INBOX_HISTORY",meta:{timelineType:e}},(t=>{if(t){const{entries:n,users:a,tweets:r,cards:s,fleets:i}=t.entities,{inbox_timeline:o}=t.result;return se({conversations:o.conversations,inbox_timelines:{[e]:o},entries:n,users:a,tweets:r,cards:s,fleets:i})}})).then((a=>{const s=a.result.inbox_timeline;if(n<3&&!s.conversations&&s.status===c.c.HAS_MORE)return r(Z(e,t,n+1))}))},ee=e=>(t,n)=>{const a=D(e,n(),"high");return t(Z(g,a))},te=e=>(t,n)=>{const a=D(e,n(),"low");return t(Z(A,a))},ne=e=>(t,n)=>{const a=D(e,n());return t(Z(O,a))},ae=Object(l.c)("UPDATE_INBOX"),re=e=>{const{inbox_timelines:t,...n}=e;return{payload:{cursors:t,lastSeenEventIds:n},type:ae}},se=(e={})=>{const{conversations:t,entries:n,users:a,tweets:i,cards:o,fleets:c,cursor:d,...l}=e;var _;return[Object(r.c)({cards:o,tweets:i,users:a}),!Object(m.a)(t)&&Object(p.c)(t),!Object(m.a)(n)&&Object(s.a)(n),!Object(m.a)(d)&&Object(u.f)(d),!Object(m.a)(l)&&re(l),!Object(m.a)(c)&&(_=c,e=>{e({payload:{fleets:_},type:"rweb/fleets/ADD_DM_FLEETS"})})].filter((e=>e))},ie=()=>e=>e(ce({withTrusted:!0})),oe=()=>e=>e(ce({withUntrusted:!0})),ce=({withTrusted:e,withUntrusted:t}={})=>(n,r,{api:s})=>{const i=r(),o=Object(p.C)(i),c=P(i),{last_seen_event_id:d,trusted_last_seen_event_id:u,untrusted_last_seen_event_id:l}=c,_=Object.values(o).reduce(((e,{data:{sort_event_id:t,trusted:n}})=>(e.last_seen_event_id=N(e.last_seen_event_id,t),e.trusted_last_seen_event_id=n?N(e.trusted_last_seen_event_id,t):e.trusted_last_seen_event_id,e.untrusted_last_seen_event_id=n?e.untrusted_last_seen_event_id:N(e.untrusted_last_seen_event_id,t),e)),{...c});if(Object(E.b)(_.last_seen_event_id,d)||e&&Object(E.b)(_.trusted_last_seen_event_id,u)||t&&Object(E.b)(_.untrusted_last_seen_event_id,l)){e||delete _.trusted_last_seen_event_id,t||delete _.untrusted_last_seen_event_id;return a.c(n,{params:_,request:s.DirectMessages.updateLastSeenEventId})({actionTypes:v,context:"APP_DM_UPDATE_LAST_SEEN",meta:{lastSeenEventIds:_}})}return Promise.resolve()},de=Object(l.c)("POP_OUT_CONVERSATION"),ue=e=>(t,n,{userPersistence:a})=>(a.set(I,{visibility:T.EXPANDED}),t({conversationId:e,type:de})),le=Object(l.c)("SET_DRAWER_VISIBILITY"),pe=e=>({visibility:e,type:le}),_e=e=>(t,n,{userPersistence:a})=>(a.set(I,{visibility:e}),e===T.CLOSED&&t({type:de}),t(pe(e))),me=()=>(e,t,{userPersistence:n})=>n.get(I).then((t=>{t&&e(pe(t.visibility))})),Ee=Object(l.c)("SET_DRAWER_EXPERIMENT_ENABLED"),fe=e=>({enabled:e,type:Ee}),Ie=e=>(t,n,{userPersistence:a})=>(a.set(h,{enabled:e}),t(fe(e))),he=()=>(e,t,{userPersistence:n})=>n.get(h).then((t=>{t&&e(fe(t.enabled))}))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.DMDrawer~bundle.Compose~bundle.RichTextCompose~bundle.DirectMessages~bundle.DMRichTextCompose~b.7b3db215.js.map